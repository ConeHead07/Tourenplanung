(function(a){var g={icon:"",display:"inline-block",css:null,clss:"ui-state-default ui-corner-all",hoverClass:"ui-state-hover",pos:"prepend",click:null,bind:null};a.fn.fbIcon=function(e){var c={};if("object"==typeof e)c=a.extend({},g,e),c.click&&(c.bind=a.extend({},c.bind,{click:c.click}));else{var b=arguments.length,c=a.extend({},g);"string"==typeof e&&(c.icon=e);2==b&&"object"==typeof arguments[1]&&(c=a.extend({},c,arguments[1]));3==b&&"object"==typeof arguments[2]&&(c=a.extend({},c,arguments[2]));
1<b&&"function"==typeof arguments[1]&&(c.bind=a.extend({},c.bind,{click:arguments[1]}))}c.display&&(c.css=a.extend({},c.css,{display:c.display}));return this.each(function(){var b=a(this),f=a("<span/>").css(c.css).addClass(c.clss).append(a("<span/>").addClass("ui-icon ui-icon-"+c.icon)).hover(function(){a(this).addClass(c.hoverClass)},function(){a(this).removeClass(c.hoverClass)}),h;for(h in c.bind)b.bind(h,c.bind[h]);"prepend"==c.pos?b.prepend(f):b.append(f)})}})(jQuery);
if("undefined"==typeof Fb)var Fb={};Fb.Dnd={overDroppable:null,overDropRulers:[],droppableBefore:null,draggable:null,draggable_data:null,draggable_width:null,droppable_route:null};Fb.DndHelpers={};
(function(a){Fb.DndHelpers.draggable={start:function(e,c){a(this).data("draggable")||a(this).data("draggable",{});var b=a(this).data("draggable");Fb.Dnd.draggable=a(this);Fb.Dnd.draggable_data=b;if(c.helper&&("string"!==typeof c.helper.attr("class")||!c.helper.attr("class").match(/\bIs-Template\b/))){var d=a(this)[0].style.left?parseInt(a(this).css("left")):a(this).position().left,f=a(this).position().top,h=a("<"+c.helper.get(0).tagName+"/>").css({position:c.helper.css("position"),display:"inline",
zIndex:c.helper.css("zIndex"),left:c.helper.css("left"),top:c.helper.css("top"),padding:0,margin:0,border:"1px dotted #d2d2d2"}).append(a("<div/>").css({paddin:0,margin:0,position:"relative",display:"inline-block",width:c.helper.width()-2,height:c.helper.height()-2}));b._src={changedParent:!0,revert:!1,placeholder:h,nextElm:this.nextSibling,position:a(this).css("position"),zIndex:a(this).css("zIndex"),parent:a(this).parent().first(),left:d,top:f,styleWidth:a(this)[0].style.width,styleLeft:a(this)[0].style.left,
styleTop:a(this)[0].style.top,pctWidth:a(this)[0].style.width.match(/%/)?a(this)[0].style.width:null,pctLeft:a(this)[0].style.left.match(/%/)?a(this)[0].style.left:null,pctTop:a(this)[0].style.top.match(/%/)?a(this)[0].style.top:null};b._dst={};(b._src.pctWidth||!b._src.styleWidth)&&a(this).css("width",a(this).width()+"px");d=c.helper.offset();b.offset.parent.top=0;b.offset.parent.left=0;b.offset.relative.top=0;b.offset.relative.left=0;b.positionAbs.top=d.top;b.positionAbs.left=d.left;h.insertBefore(c.helper);
c.helper.appendTo("body").css({position:"absolute",left:d.left,top:d.top,zIndex:2E3})}else b._src={zIndex:a(this).css("zIndex")};return!0},revert:function(e){e||a(this).fadeTo(200,1);if(e=e?!1:!0){var c=a(this).data("draggable")||{},b=c._src||{};b&&b.changedParent&&(b.revert=!0,c.originalPosition.left=b.parent.offset().left+b.left,c.originalPosition.top=b.parent.offset().top+b.top)}return e},stop:function(e,c){Fb.Dnd.draggable=null;Fb.Dnd.draggable_data=null;var b=(a(this).data("draggable")||{})._src||
{};b.revert&&(a(b.placeholder).length?a(b.placeholder).replaceWith(c.helper):a(b.nextElm).length?a(c.helper).insertBefore(b.nextElm):c.helper.appendTo(b.parent),c.helper.css({position:b.position,left:b.left,top:b.top}),b.pctLeft&&b.pctLeft.match(/%/)&&c.helper.css("left",b.pctLeft),b.pctTop&&b.pctTop.match(/%/)&&c.helper.css("top",b.pctTop),b.pctWidth&&b.pctWidth.match(/%/)?c.helper.css("width",b.pctWidth):c.helper.css("width",b.styleWidth),c.helper.css("left",b.styleLeft),c.helper.css("top",b.styleTop));
b.zIndex&&c.helper.css({zIndex:b.zIndex})}};Fb.DndHelpers.droppable={drop:function(e,c){var b=(c.helper.data("draggable")||c.draggable.data("draggable")||{})._src||{};b.zIndex&&c.helper.css({zIndex:b});b.placeholder&&a(b.placeholder).remove();c.helper!==c.draggable&&c.helper.removeClass("Is-Template").attr("id",c.draggable.attr("id")+Fb.DndHelpers._getNextID());return!1}};var g=0;Fb.DndHelpers._getNextID=function(){return++g};Fb.DropTrashBoxSettings={hoverClass:"ui-state-active",activeClass:"ShowDroppableZone",
accept:".Drag-Route,.Drag-Rsrc,.portlet",tolerance:"pointer",over:function(){},out:function(){},drop:function(e,c){var b=c.helper==c.draggable?c.helper:c.helper.clone().appendTo("body"),d=b.data("draggable");d&&(d._src&&d._src.placeholder&&d._src.placeholder)&&d._src.placeholder.remove();b.draggable("disable").hide(350,function(){a(this).remove()});return!0}};Fb.DragRsrcTemplateSettings={helper:"clone",welcome:"Juhuu!",appendTo:"body",zIndex:2500};Fb.DragRsrcInstanceSettings=a.extend({},Fb.DragRsrcTemplateSettings,
{helper:"none",appendTo:null},Fb.DndHelpers.draggable);Fb.RouteDataDefaults={start:0,duration:120,end:0};Fb.DragRouteTemplateSettings={create:function(){a(this).data("route")||a(this).data("route",a.extend({},Fb.RouteDataDefaults));var e=a(this).data("route"),c;for(c in Fb.RouteDataDefaults)"undefined"==typeof e[c]&&(e[c]=Fb.RouteDataDefaults[c])},helper:"clone",appendTo:"body",zIndex:2500,drag:function(e,c){"undefined"===typeof e.pageX&&("undefined"!==typeof window.event&&"undefined"!==typeof window.event.pageX)&&
(e.pageX=window.event.pageX);if(null==Fb.Dnd.draggable||!Fb.Dnd.draggable_data)Fb.Dnd.draggable=a(this),Fb.Dnd.draggable_data=a(this).data("draggable");Fb.Dnd.draggable_data._dst||(Fb.Dnd.draggable_data._dst={});try{if(Fb.Dnd.draggable_data.overDroppable&&Fb.Dnd.draggable_data.overDroppable.data("fbDispoTimelineGrid")){var b=Fb.Dnd.draggable_data.overDroppable;if(Fb.Dnd.droppableBefore!==b){var d=b.offset().left;Fb.Dnd.draggable_width=Fb.Dnd.draggable.width();Fb.Dnd.droppableRulers=b.data("fbDispoTimelineGrid").gridRulers.map(function(){return{left:d+
a(this).position().left,originLeft:a(this)[0].style.left,top:a(this).offset().top,gridRuler:a(this)}});Fb.Dnd.droppableBefore=b}for(var f=e.pageX-Fb.Dnd.draggable_data.offset.click.left,h=Fb.Dnd.droppableRulers,b=0;b+1<h.length&&h[b+1].left<f;)++b;b+1<h.length&&0.8*(f-h[b].left)>h[b+1].left-f&&++b;c.position.top=Fb.Dnd.droppableRulers[b].top;c.position.left=Fb.Dnd.droppableRulers[b].left;Fb.Dnd.draggable_data._dst.left=Fb.Dnd.droppableRulers[b].originLeft;Fb.Dnd.draggable_data._dst.gridRuler=Fb.Dnd.droppableRulers[b].gridRuler}}catch(k){}}};
a.extend(Fb.DragRouteTemplateSettings,Fb.DndHelpers.draggable);Fb.DragRouteInstanceSettings=a.extend({},Fb.DragRouteTemplateSettings,{helper:"none",appendTo:"body"});Fb.MoveTimelineSettings=a.extend({},Fb.DndHelpers.draggable,{start:function(e,c){Fb.DndHelpers.draggable.start.apply(this,arguments);a(this).fbDispoTimelineDropzone.apply(a(this),["_trigger",this,"startmove",e,c])},stop:function(e,c){Fb.DndHelpers.draggable.stop.apply(this,arguments);a(this).fbDispoTimelineDropzone.apply(a(this),["_trigger",
this,"move",e,c])}});Fb.DropRouteSettings={create:function(){a(this).fbDispoTimelineGrid({timeline:"div.Timeline",show:!1,top:a("div.Timeline:first",a(this)).height()});a(this).droppable("option","accept",".Drag-Route")},hoverClass:"ui-state-active",activeClass:"ShowDroppableZone",accept:".noDrag-Route",tolerance:"pointer",over:function(e,c){a(this).fbDispoTimelineGrid("show");c.draggable.data("draggable").overDroppable=a(this)},out:function(e,c){a(this).fbDispoTimelineGrid("hide");c.draggable.data("draggable").overDroppable=
null},drop:function(e,c){var b=a(this),d=a("div.Timeline:first",a(this)).height(),f=c.helper.data("draggable")||c.draggable.data("draggable")||{},h=c.helper.data("route")||c.draggable.data("route")||{};a(this).data("fbDispoTimelineGrid");var k=a("div.Timeline",a(this)).fbDispoTimelineLineal("data"),j=f&&f._dst&&f._dst.left?f._dst.left:null;a(this).fbDispoTimelineGrid({timeline:"div.Timeline",show:!0,refreshIfExists:!0,top:a("div.Timeline:first",a(this)).height()});Fb.DndHelpers.droppable.drop.apply(this,
arguments);f=c.helper===c.draggable?c.helper:c.helper.clone();c.helper.data("dragdata")&&f.data("dragdata",c.helper.data("dragdata"));var g=c.helper.offset().left-b.offset().left,l=c.helper.offset().top-b.offset().top;f.appendTo(b);f.css({position:"absolute",left:g,top:l}).animate({left:Math.max(5,g),top:d},function(){null!==j&&a(this).css("left",j)});h.start=Fb.Dnd.draggable_data._dst.gridRuler.data("gridStep").time;h.end=h.start+h.duration;b=f.fbDispoRoute("options");d={_parent:a(this),_parentJqFunction:"fbDispoTimelineDropzone",
_parentFrom:b&&"_parent"in b?b._parent:null,timeStart:h.start,timeDuration:h.duration,timeEnd:h.end};if(b){if(f.fbDispoRoute("options",d),!1===f.fbDispoRoute("_moved",e,c))return!1}else if(f.fbDispoRoute(d),!1===f.fbDispoRoute("_dropped",e,c))return!1;f.trigger("click");f[0].style.width=100*h.duration/k.settings._totalM+"%";c.draggable.data("draggable").overDroppable=null}};Fb.DropRsrcOnRouteSettings=a.extend({},Fb.DropRouteSettings,{create:null,drop:function(e,c){var b=a(this);Fb.DndHelpers.droppable.drop.apply(this,
arguments);var d=c.helper===c.draggable?c.helper:c.helper.clone();c.helper.offset();b.offset();c.helper.offset();b.offset();d.appendTo(a("ul.resources:first",b));"li"===d.get(0).tagName.toLowerCase()?d.appendTo(a("ul.resources:first",b)):a("ul.resources:first",b).append(a("<li/>").append(d));d.css({position:"relative",left:8,top:0});a(this).is(".fbDispoRouteDefaults");d.fbDispoResource("options");a(this);c.helper.data("dragdata");d!==c.draggable?a(this).trigger("resource-dropped",[d,c]):a(this).trigger("resource-moved",
[d,c])}});Fb.RouteResizableSettings={handles:"w,e",create:function(){},start:function(){var e=a(this),c=e.data("resizable"),b=c.options,d=e.parent("div.DropZone-Route:first"),f=d.data("fbDispoTimelineGrid").gridRulers;b.grid=[f.eq(1).position().left-f.eq(0).position().left,1];e.resizable("option","minWidth",b.grid);Fb.Dnd.droppableRulers=f.map(function(){return{left:a(this).position().left,originLeft:Math.floor(a(this)[0].style.left),top:a(this).offset().top,ruler:a(this),time:a(this).data("gridStep").time}});
c._src={parent:d,rulers:Fb.Dnd.droppableRulers,timelineData:a("div.Timeline",d).fbDispoTimelineLineal("data")}},resize:function(){},stop:function(){var e=a(this),c=e.data("resizable"),b=a("div.Timeline",c._src.parent).fbDispoTimelineLineal("data"),d=Fb.Dnd.droppableRulers;if(d&&d.length){for(var f=0,h=c.position.left,k=h+e.width(),j=Math.round(0.5*(d[1].left-d[0].left));f+1<d.length&&Math.floor(d[f+1].left)<=h;)++f;for(c=f+1<d.length&&d[f+1].left-h<h-d[f].left?++f:f;f+1<d.length&&Math.floor(d[f+1].left)<=
k+j;)++f;f=f+1<d.length&&d[f+1].left-h<h-d[f].left?++f:f;b=b.settings;h=e.data("route");h.start=d[c].time;h.end=d[f].time;h.duration=h.end-h.start;h.duration<b._stepWidthM&&(h.duration=b._stepWidthM);e[0].style.left=d[c].originLeft;e[0].style.width=100*h.duration/b._totalM+"%";e.fbDispoRoute("_resized")}}}})(jQuery);Fb||(Fb={});Fb.DispoCalendarSettings||(Fb.DispoCalendarSettings={});$.extend(Fb.DispoCalendarSettings,{calendar:{},portlet:{},timelineDropzone:{},timelineDropzoneHandles:{},timelineLineal:{start:"06:00",end:"20:00",stepWidth:"00:30"},timelineGrid:{},route:{},routeDefaults:{askForApplyDefaults:!1,applyDefaults:!0},resource:{}});"undefined"==typeof Fb&&(Fb={});
(function(a){var g={pages:{Resources:"Ressourcen",Gruppierungen:"Gruppierungen",Details:"Daten",Timetable:"Zeitplan",Touren:"Touren",Bemerkungen:"Bemerkungen",Historie:"Historie",Abschluss:"Abschluss"},close:'<span class="ui-state-error" style="background:none;border:0;">Schliessen <span class="ui-icon ui-icon-closethick" style="height:13px;"></span></span>'};Fb.hideRouteDetails=function(e){var c=a(e);c.slideUp("normal",function(){c.length&&c.remove()})};Fb.showRouteDetails=function(e,c){var b=a(e),
d=b.closest("div.DropZone.DropZone-Route");if("undefined"==typeof c||null==c)c={};var f=a.extend({},g,c),h=!1;a("div.TourTabbedSheet").each(function(){a(this).data("BelongToTour")==b.get(0)&&(h=!0);Fb.hideRouteDetails(this)});if(h)a(e).fbDispoRoute("_trigger",e,"hideDetails");else{f.pages.close||(f.pages.close=f.close);var k=a("<div class='TourTabbedHead' style='padding-left:10px'>Tour-Basis-Daten</div>"),j=a("<ul>"),m=a("<div class='TourTabbedSheet tabs-flat' style='display:none;min-height:400px;'/>");
m.append(j);m.append(k);m.data("BelongToTour",b.get(0));var k="",l;for(l in f.pages)k="tabs-"+l,j.append(a("<li><a href='#"+k+"' id='Anchor-"+k+"'>"+f.pages[l]+"</a></li>")),m.append(a("<div id='"+k+"'><p></p></div>"));d.after(m.tabs({create:function(){a(this).tabs("select",0);a("li a:contains('Schliessen')",a(this)).bind("click",function(){Fb.showRouteDetails(e)})},show:function(){var b=a(this).tabs("option","selected");a.trim(a("li:eq("+b+")",this).text())}}));m.slideDown("normal");a(e).trigger("showDetails",
[m])}}})(jQuery);$(function(){"Fb"in window&&"DispoLoading"in window.Fb&&$(document).ajaxStart(window.Fb.DispoLoading.bind(window.Fb,1)).ajaxStop(window.Fb.DispoLoading.bind(window.Fb,0));$(document).ajaxComplete(function(){});$(document).ajaxSuccess(function(a,g,e,c){"object"===typeof e&&("async"in e&&!e.async)&&console.log("#11 Not Async!! jquery.fbDispoCalendar for url: ",{async:e.async,url:e.url});if("object"!==typeof c||!("type"in c)&&!("success"in c)&&!("msg"in c)&&!("error"in c))console.log("#13 abort. Nothing to show for Toast",
"typeof d:",typeof c,c,"jqXHR",g);else{if(!("type"in c)||"string"!==typeof c.type)"boolean"===typeof c.type?c.type=c.type?"success":"error":"success"in c&&(c.type=c.success?"success":"error");c.success=c.success||"success"===c.type;c.msg=c.msg||"";c.error=c.error||"";c.data=c.data||"";a=c.error||c.msg||"";505<a.length&&(a=a.substr(0,500)+"...");c={heading:c.success?"OK":"Fehler",text:"<div class='nachricht'>"+a.split("\n").join("<br>")+"</div>",hideAfter:1E3*Math.min(2.5,Math.max(10,Math.ceil(a.length/
30))),position:{top:10,left:10},icon:c.success?"info":"error"};$.toast(c)}})});
function flatObjToString(a,g){if("object"!==typeof a)return a;g||(g="");var e="",c;for(c in a)if("undefined"==typeof a.hasOwnProperty||a.hasOwnProperty(c)){e+=g+c+"("+typeof a[c]+") : ";try{typeof a[c].toString().match(/string|number|boolean/)?e+=a[c]+"\n":"object"==typeof a[c]&&(e+=g+a[c].constructor+("function"==typeof a[c].toString?"toString: "+a[c].toString():"")+"\n",e+=flatObjToString(a[c],g+"...")+"\n")}catch(b){e+=b+"\n"}}return e}function btos(a){return a?"true":"false"}
"undefined"==typeof Fb&&(Fb={});Fb.DispoCalendarSettings||(Fb.DispoCalendarSettings={});
Fb.DispoLoading=function(a){var g=$("#fbDispo_loading");$("#fbDispo_loading").length||(g=$("<div/>").attr({id:"fbDispo_loading","class":"fbDispoLoading ui-state-default ui-state-active"}).html("l&auml;dt ...").data("tasknr",0).click(function(){5!==$(this).css("top")&&"5px"!==$(this).css("top")?$(this).css({top:"5px",right:"25px"}):(console.log("#68 Hide Loading",$("#fbDispo_loading").length),$(this).hide())}).appendTo("body"));if(arguments.length&&!a){var e=g.show().data().tasknr;setTimeout(function(){e===
g.show().data().tasknr&&$("#fbDispo_loading").hide()},950)}else g.show().data().tasknr++};
Fb.AjaxTourRequest=function(a,g){Fb.DispoLoading(1);var e=!1,c=!1;g||(g={});a||(a={});g=$.extend({},{defaultError:"",onsuccess:null,onerror:null},g);a=$.extend({},{url:"./",data:{},type:"GET",dataType:"json",async:!1,success:function(b,d,f){e=!1;if("confirm"in b&&b.confirm&&(e=confirm(b.confirm))){"confirmUrl"in b&&b.confirmUrl&&(a.url=b.confirmUrl);a.data="confirmData"in b&&b.confirmData?$.extend({},a.data,b.confirmData):$.extend({},a.data,{confirm:1});return}if(Fb.AjaxSuccessCheck(b,d,f,{defaultError:g.defaultError})){if(c=
!0,g.onsuccess&&"function"===typeof g.onsuccess){console.log("#213 responseOpts.onsuccess",g.onsuccess.toString());try{g.onsuccess.apply(null,[b,d,f])}catch(h){console.log(h)}}}else if(g.onerror&&"function"===typeof g.onerror){console.log("#213 responseOpts.onsuccess",g.onerror.toString());try{g.onerror.apply(null,[f,d])}catch(k){console.log(k)}}},error:function(a,d,f){console.log("#231 AjaxTourRequest jquery.fbDispoCalendar error.js return",c,d,f);Fb.AjaxErrorShow(a,d,f,g.defaultError);if(g.onerror)try{g.onerror.apply(null,
[a,d])}catch(h){console.log(h)}},complete:function(a,d){if(g.oncomplete)try{g.oncomplete.apply(null,[a,d])}catch(f){console.log(f)}}},a);do console.log("#243 jquery.fbDispoCalendar.js return ",c),Fb.DispoLoading(1),$.ajax(a);while(e);Fb.DispoLoading(0);return c};Fb.AppBaseUrl="string"==typeof APP_BASE_URL?APP_BASE_URL:"/";
Fb.AjaxSuccessCheck=function(a,g,e,c){return"object"==typeof a&&("error"in a&&a.error||"err"in a&&a.err||"success"in a&&!a.success||"type"in a&&("error"===a.type||!1===a.type))?("error"in a&&a.error?alert(a.error):"err"in a&&a.err?alert(a.err):"object"==typeof c&&"defaultError"in c?alert(c.defaultError):alert("Ups, sorry, interner Fehler!"),!1):!0};
Fb.AjaxErrorShow=function(a,g,e,c){var b;try{b=a.responseText?$.parseJSON(a.responseText):a.responseText}catch(d){b=a.responseText}"object"==typeof b?"error"in b&&alert(b.error):alert(c+"\n"+g+" "+e+"\n"+("string"==typeof b?b:""))};
Fb.RouteToolTip=function(a,g,e,c){c=c?c:"url";e||(e="above");try{var b=$("#FbToolTip"),d=$(a);0==b.length&&(b=$("<div/>").attr({id:"FbToolTip","class":"defaultTheme"}).css({position:"absolute",zIndex:99}).append($("<p/>").attr("id","FbToolTipContent").addClass("aToolTipContent")).appendTo("body"));b.hide().css({height:"auto",left:d.offset().left});b.css("top","above"==e?d.offset().top-b.outerHeight()-5:d.offset().top+d.outerHeight());b.data("MouseTarget")==a?b.show():(b.data("MouseTarget",a).bind("mouseover",
function(){d.data("MouseIsOver",!0)}).show().draggable(),"url"==c?b.find("#FbToolTipContent").text("loading ...").load(g,function(){$(this).append($("<a id='aToolTipCloseBtn' href='#' alt='close'>close</a>").click(function(a){a.preventDefault();b.data("MouseTarget",null);b.hide();return!1}));b.css({height:b.height(),top:"above"==e?d.offset().top-b.outerHeight()-5:d.offset().top+d.outerHeight()})}):"html"==c?b.find("#FbToolTipContent").html(g):"selector"==c&&b.find("#FbToolTipContent").html("").append($(g).clone()),
b.bind("mouseleave",function(){Fb.RouteToolTipHide(a)}),$(a).bind("mouseleave",function(){Fb.RouteToolTipHide(a)}))}catch(f){alert("#96 Error Showing ToolTip: "+f)}};Fb.RouteToolTipHide=function(a){var g=$(a);$("#FbToolTip").length&&(g.length?(g.data("MouseIsOver",!1),setTimeout(function(){$("#FbToolTip").length&&($(a).data("MouseIsOver")||$("#FbToolTip").hide())},500)):$("#FbToolTip").hide())};
Fb.DispoCheckConcurrency=function(a,g){var e=null,c=Fb.AppBaseUrl+"/touren/concurrency/check";a||(a={});g||(g=5);a.maxage=g;$.ajax({type:"GET",dataType:"json",async:!1,data:a,url:c,success:function(a){e=a}});return e};Fb.DispoListConcurrency=function(a,g){var e=null,c=Fb.AppBaseUrl+"/touren/concurrency/list";a||(a={});g||(g=5);a.maxage=g;$.ajax({type:"GET",dataType:"json",async:!1,data:a,url:c,success:function(a){e=a}});return e};
Fb.ReloadTimelineResources=function(a){$(a).fbDispoTimelineDropzone("getRoutes").each(function(){$(this).is(".fbDispoRoute")?$(this).fbDispoRoute("reloadResources"):$(this).is(".fbDispoRouteDefaults")&&$(this).fbDispoRouteDefaults("reloadResources")})};Fb.ReloadTimelineResourcesByRoute=function(a){Fb.ReloadTimelineResources($(a).fbDispoRoute("getTimeline"))};Fb.ReloadTimelineResourcesByRouteDefaults=function(a){Fb.ReloadTimelineResources($(a).fbDispoRouteDefaults("getTimeline"))};
Fb.RenderResourceDelAction=function(a,g,e){$(a).find(g).fbIcon({icon:"trash",css:{background:"none",border:0}}).css({marginRight:"3px"}).click(function(){var a={id:$(this).attr("rsrcid"),resourceType:$(this).attr("rsrctype"),name:$(this).parent().find("span.rsrc-title").text()},b=$("div#fbDispoRoute_"+e);b.length&&(!1!==b.fbDispoRoute("_trigger",b[0],"removeResource",a)?($(this).closest("li").length?$(this).closest("li").remove():$(this).remove(),b.fbDispoRoute("reloadResources")):alert("#192 Fb.RenderResourceDelAction; Error: CanNot Remove Resource"))})};
Fb.DispoCalendarEvents={};
(function(a){var g={create:"createDispoCalendar",complete:"completeDispoCalendar",changeDate:"changeDateDispoCalendar",clickVorgangsEmpehlungen:"clickVorgangsEmpehlungenDispoCalendar"},e=1,c=/^\d{4,4}-(0[1-9]|1[0-2])-([0-2][0-9]|3[0-2])$/,b={data:null,date:null,url:"",resourcesBaseUrlTpl:"",routeBaseUrlTpl:"",searchUrl:null,isBrowsable:!0,isAddable:!0,isHidable:!0,isRefreshable:!0,isPrintable:!0,isSortable:!0,isSearchable:!0,isContextSearchable:!0,triggerChildEvents:!1,onCreate:null,onComplete:null,
onChangeDate:null,onClickVorgangsEmpfehlungen:null,onCreatePortlet:null,onUpdatePortletTitle:null,onRemovePortlet:null,onPrintPortlet:null,onSortPortlet:null,onFoldPortlet:null,onUnfoldPortlet:null,onDropTimeline:null,onMoveTimeline:null,onSortTimeline:null,onCreateTimeline:null,onRemoveTimeline:null,onMoveTimeline:null,onDropRoute:null,onSelectRoute:null,onMoveRoute:null,onResizeRoute:null,onRemoveRoute:null,onChangeRouteData:null,onHoverRouteDefaults:null,onLeaveRouteDefaults:null,onCreateRouteDefaults:null,
onSelectRouteDefaults:null,onDropResourceDefaults:null,onMoveResourceDefaults:null,onRemoveResourceDefaults:null,onHoverRouteDetails:null,onLeaveRouteDetails:null,onLoadRoute:function(){alert("fbDispoCalendar.onLoadRoute Default-Dummie-Handler")},onHoverRoute:null,onLeaveRoute:null,onClickRoute:null,onShowRouteDetails:null,onHideRouteDetails:null,onShowRouteDefaultsDetails:null,onHideRouteDefaultsDetails:null,onAddResource:null,onDropResource:null,onMoveResource:null,onRemoveResource:null},d={clear:function(){a("div.DispoCalendarPortlets",
this).html("")},addPortlets:function(a){for(var b=0;b<a.length;++b)d.addPortlet.apply(this,[a[b]])},addPortlet:function(b){b||(b={});b.date=d._getDateString(d.getDate.apply(this));b.lager_id=d.getLager.apply(this);var c=a("<div />").prependTo(a("div.DispoCalendarPortlets",this));c.fbDispoPortlet({date:b.date,lager_id:b.lager_id,data:b,_parent:a(this),_parentJqFunction:"fbDispoCalendar"});a(".selector").sortable("refreshPositions");a("div.DispoCalendarPortlets",this).sortable("refresh");return c},
load:function(b){if("object"==typeof b)for(var c=0;c<b.length;++c)d.addPortlet.apply(this,["load",b[c]]);else{var k=this,j=a(this).data("fbDispoCalendar"),e="#493 start request calendarDayData "+(new Date).toLocaleString()+"\n";try{Fb.DispoLoading(1),a.getJSON(j.url,{date:j.date,lager_id:j.data.lager_id},function(a){e+="#495 start render calendarDayData "+(new Date).toLocaleString()+"\n";d.clear.apply(k);d.addPortlets.apply(k,[a.data]);d._trigger.apply(k,[k,"changeDate",j.date]);e+="#499 finished building calendarDayData "+
(new Date).toLocaleString()+"\n";Fb.DispoLoading(0)})}catch(g){Fb.DispoLoading(0)}}},loadDate:function(a){d.setDate.apply(this,[a])&&d.load.apply(this)},loadPrevDay:function(){var a=d.getDate.apply(this);a.setDate(a.getDate()-1);d.setDate.apply(this,[a]);d.load.apply(this)},loadNextDay:function(){var a=d.getDate.apply(this);a.setDate(a.getDate()+1);d.setDate.apply(this,[a]);d.load.apply(this)},getDate:function(){var b=a(this).data("fbDispoCalendar").date;return b?(b=b.split("-"),"0"==b[1].charAt(0)&&
(b[1]=b[1].substr(1)),"0"==b[2].charAt(0)&&(b[2]=b[2].substr(1)),new Date(b[0],b[1]-1,b[2])):new Date},setDate:function(b){var h=a(this).data("fbDispoCalendar").ID;if("object"==typeof b&&String(b.constructor).match(/\bDate\b/))a(this).data("fbDispoCalendar").date=d._getDateString(b);else if("string"==typeof b&&b.match(c))a(this).data("fbDispoCalendar").date=b;else return alert("Unzulaessiges Datum: "+typeof b+" "+b+". Erwartet Datumsobjekt oder String JJJJ-MM-TT"),!1;b=d.getDate.apply(this);var k=
a.datepicker._defaults.dayNamesShort[b.getDay()],k=k+(" "+d._getLocalString(a(this).data("fbDispoCalendar").date)),k=k+(" / "+a.datepicker.iso8601Week(b)+". KW");a("button#DispoDate"+h+" label",this).html(k);a("input#DispoDateTxt"+h+"",this).val(a(this).data("fbDispoCalendar").date);return!0},setLager:function(b){d.setData.apply(this,["lager_id",b]);a("#DispoLager").val()!=b&&a("#DispoLager").val(b)},getLager:function(){return d.getData.apply(this,["lager_id"])},_getDateString:function(a){var b=a.getMonth()+
1,d=a.getDate();10>b&&(b="0"+b.toString());10>d&&(d="0"+d.toString());return a.getFullYear()+"-"+b+"-"+d},_getLocalString:function(a){return"string"==typeof a?a.split("-").reverse().join("."):"undefined"},_trigger:function(b,c){var k=a(this).data("fbDispoCalendar"),j=a.makeArray(arguments).slice(1),e=d._getOwnEventHandlerName(c);if(e&&(e in k&&"function"==typeof k[e])&&!1===k[e].apply(b,a.makeArray(arguments).slice(2)))return!1;j[0]=d._getEventTriggerName(c);return(b==this||k.triggerChildEvents)&&
!1===a(this).trigger.apply(a(this),j)?!1:!0},_getEventTriggerName:function(a){a in g&&(a=g[a]);return a},_getOwnEventHandlerName:function(a){a="on"+a.charAt(0).toUpperCase()+a.substr(1);return a in b?a:""},_init:function(){var b=this,c=a(this),k=++e,j=a(this).data("fbDispoCalendar");j.ID=k;c.addClass("DispoCalendar fbDispoCalendar");c.append(a("<span class='DispoDateDisplay' />"));var g=a("<div class='DispoCalendarPager' />").attr("id","fbDispoCalendarPager"+k);c.append(g);var l=j.isBrowsable,n=j.isRefreshable,
t=j.isAddable,p=j.isContextSearchable,q=j.isSearchable,u=j.isSortable,r=j.isPrintable,s=j.isHidable;g.append(a("<div style='float:left;margin-left:0px'>    <span id='calendar-btn-browse"+k+"'>    <button class='collapse'>&nbsp;</button>"+(l?"<button class='browse-prev'>&nbsp;</button>":"")+"<input id='DispoDateTxt"+k+"' type='text' style='width:1px;display:none;'><button id='DispoDate"+k+"' ><label>Date</label></button>"+(l?"<button class='browse-next'>&nbsp;</button>":"")+(t?"<button id='addPortlet"+
k+"'>Neue Tour anlegen</button>":"")+(n?"<button class='browse-refresh' title='Ansicht aktualisieren'>&nbsp;</button>":"")+(r?"<button class='DispoPrint' title='Tagesdruckansicht'>&nbsp;</button>":"")+(p?"<button class='DispoEmpfehlungen' title='Passende Vorgaenge in Auswahlliste anzeigen'>&nbsp;</button>":"")+(q?"<button class='DispoSearch' title='Disponierte Vorgaenge suchen'>&nbsp;</button>":"")+(s?"<button class='DispoCalRemove' title='Diesen Tag ausblenden'>&nbsp;</button>":"")+"   </span></div>")).append("<br style='clear:both;' />");
c.append(a("<div class='DispoCalendarPortlets' />"));a("button, input:submit, a",g).button();a("button#addPortlet"+k,g).button({icons:{primary:"ui-icon-circle-plus"},text:!0});a("span#calendar-btn-view"+k+"",g).buttonset();a("span#calendar-btn-browse"+k,g).buttonset();a("button.collapse",g).button({icons:{primary:"ui-icon-minus"},text:!0});n&&a("button.browse-refresh",g).button({icons:{primary:"ui-icon-refresh"},text:!0});l&&a("button.browse-prev",g).button({icons:{primary:"ui-icon-circle-triangle-w"},
text:!0});l&&a("button.browse-next",g).button({icons:{primary:"ui-icon-circle-triangle-e"},text:!0});p&&a("button.DispoEmpfehlungen",g).button({icons:{primary:"ui-icon-note"},text:!0});q&&a("button.DispoSearch",g).button({icons:{primary:"ui-icon-search"},text:!0});r&&a("button.DispoPrint",g).button({icons:{primary:"ui-icon-print"},text:!0});s&&a("button.DispoCalRemove",g).button({icons:{primary:"ui-icon-close"},text:!0});a("button#DispoDate"+k,g).button("option","secondary","ui-icon-triangle-1-s");
a("button.collapse",this).click(function(){var c=a(this).closest("div.DispoCalendar").find("div.DispoCalendarPortlets").slideToggle();a(this).find(".ui-icon:first").toggleClass("ui-icon-minus").toggleClass("ui-icon-plus");d._trigger.apply(b,[b,c.is(":visible")?"fold":"unfold"])});u&&a("div.DispoCalendarPortlets",this).sortable({cursor:"move",handle:".sortable.handle",stop:function(c,h){d._trigger.apply(b,[b,"sortPortlet"].concat(a.makeArray(arguments)))}});l&&a("input#DispoDateTxt"+k,g).datepicker({dateFormat:"yy-mm-dd",
changeMonth:!0,showWeek:!0,firstDay:1,onSelect:function(a){d.setDate.apply(b,[a]);d.load.apply(b)}});a("select#DispoLager").bind("change",function(){d.setData.apply(b,["lager_id",a(this).val()]);d.load.apply(b)});t&&a("button#addPortlet"+k,b).click(function(){d.addPortlet.apply(b)});l&&a("button.browse-prev",b).click(function(){d.loadPrevDay.apply(b)});l&&a("button.browse-next",b).click(function(){d.loadNextDay.apply(b)});n&&a("button.browse-refresh",b).click(function(){d.load.apply(b)});s&&a("button.DispoCalRemove",
b).click(function(){a(b).remove()});l&&a("button#DispoDate"+k,b).click(function(){a("input#DispoDateTxt"+k,b).datepicker("show")});p&&a("button.DispoEmpfehlungen",g).click(function(){var c=a(b).data("fbDispoCalendar");d._trigger.apply(b,[b,"clickVorgangsEmpfehlungen",c.date])});r&&j.searchUrl&&a("button.DispoPrint",g).click(function(){var a=d._getDateString(d.getDate.apply(b)),c=d.getLager.apply(b);a&&c&&(a=Fb.AppBaseUrl+"/touren/page/printportletsday/date/"+a+"/lager_id/"+c,"undefined"!==typeof winPrint&&
(null!==winPrint&&winPrint.close&&!winPrint.closed)&&winPrint.close(),winPrint=window.open(a,"winPrint","width=800px,height=800,menubar=yes,resizable=yes,scrollbars=yes"),winPrint.focus())});q&&j.searchUrl?a("button.DispoSearch",g).click(function(){a("#DispoSearchBox").length||a('<div id="DispoSearchBox"/>').appendTo("body");var c=d.getDate.apply(b),h=a.datepicker.iso8601Week(c),e=d.getLager.apply(b),c=j.searchUrl+(-1==j.searchUrl.indexOf("?")?"?":"")+"&kw="+c.getFullYear()+"-"+h+"&lager_id="+e+"&ajax=1";
a("#DispoSearchBox").dialog({width:0.8*a("body").width()}).load(c)}):a("button.DispoSearch",g).hide();d.setLager.apply(this,[a("#DispoLager").val()]);d.setDate.apply(this,[a(this).data("fbDispoCalendar").date]);d.load.apply(this);d._trigger.apply(b,[b,"create"])},getDataKey:function(){return"fbDispoCalendar"},getData:function(){var b=a(this).data("fbDispoCalendar");return!b||!b.data?null:arguments.length?arguments[0]in b.data?b.data[arguments[0]]:null:b.data},getObjectData:function(){var b=a(this).data("fbDispoCalendar");
return!b||!b.data?null:arguments.length?arguments[0]in b?b[arguments[0]]:null:a(this).data("fbDispoCalendar")},setData:function(){a(this).data("fbDispoCalendar")||a(this).data("fbDispoCalendar",{});a(this).data("fbDispoCalendar").data||(a(this).data("fbDispoCalendar").data={});1==arguments.length?a(this).data("fbDispoCalendar").data=arguments[0]:2<=arguments.length&&(a(this).data("fbDispoCalendar").data[arguments[0]]=arguments[1])}};a.fn.fbDispoCalendar=function(c){var h=arguments,e=arguments.length,
j=new Date,g=j.getMonth()+1;10>g&&(g="0"+g);var l=j.getDate();10>l&&(l="0"+l);b.date=j.getFullYear()+"-"+g+"-"+l;if("string"==typeof c&&this.length)switch(c){case "options":if(1==e)return a(this[0]).data("fbDispoCalendar");break;case "option":if(2==e)return j=a(this[0]).data("fbDispoCalendar"),"undefined"!=typeof j[h[1]]?j[h[1]]:null;break;default:if("function"==typeof d[c]&&("_trigger"==c||"get"==c.substr(0,3)))return d[c].apply(this[0],1<e?a.makeArray(h).slice(1):null)}return this.each(function(){var j=
!1,g={};a(this).data("fbDispoCalendar")||(g=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.calendar?a.extend({},b,Fb.DispoCalendarSettings.calendar):b,c?"object"==typeof c?a(this).data("fbDispoCalendar",a.extend({},g,c)):a(this).data("fbDispoCalendar",a.extend({},g)):a(this).data("fbDispoCalendar",a.extend({},g)),j=!0);g=a(this).data("fbDispoCalendar");if("string"==typeof c)switch(c){case "options":1<e&&(g=a.extend({},g,h[1]),a(this).data("fbDispoCalendar",g));break;case "option":2<e&&(g[h[1]]=
h[2],a(this).data("fbDispoCalendar",g));break;default:"function"==typeof d[c]&&d[c].apply(this,1<e?a.makeArray(h).slice(1):null)}j&&d._init.apply(this);return this})}})(jQuery);(function(a){var g=0,e={create:"createPortlet",remove:"removePortlet",fold:"foldPortlet",unfold:"unfoldPortlet",print:"printPortlet",updateTitle:"updatePortletTitle"},c={data:{},date:null,_parent:null,_parentJqFunction:null,isEditable:!0,isSortable:!0,isRemovable:!0,isPrintable:!0,isAddable:!0,isDroppable:!0,onCreate:null,onRemove:null,onPrint:null,onCreateTimeline:null,onRemoveTimeline:null,onSortTimeline:null,onDropTimeline:null,onFold:null,onUnfold:null},b={_init:function(){var d=this,c=a(d),h=
c.data("fbDispoPortlet");null===h.data&&(h.data={});g++;c.addClass("fbDispoPortlet portlet-content num-"+g).wrap('<div class="portlet ui-widget-header ui-corner-all" />').before('<div class="portlet-header ui-corner-all"><span class="ui-icon-set"/><span class="portlet-header-title">Routen-Schienen</span></div>');c.closest("div.portlet").find("div.portlet-header").addClass("ui-corner-all").end();var e=h.isEditable,j=a("div.portlet-header span.ui-icon-set",c.closest("div.portlet"));j.append("<span class='ui-icon collapse ui-icon-triangle-1-s'></span>");
e&&h.isSortable&&j.append("<span class='ui-icon sortable ui-icon-arrow-4 handle'></span>");e&&h.isAddable&&j.append("<span class='ui-icon addTrack ui-icon-plus'></span>");e&&h.isRemovable&&j.append("<span class='ui-icon rmPortlet ui-icon-trash'></span>");h.isPrintable&&j.append("<span class='ui-icon prPortlet ui-icon-print'></span>");c=a("div.portlet-content",c.closest("div.portlet"));c.css("paddingLeft","15px");e&&(h.isSortable&&c.sortable({cursor:"move",handle:".DropZone-Sort",connectWith:".portlet-content",
stop:function(a,c){var f=c.item.parent().get(0);d==c.item.parent().get(0)?b._trigger.apply(d,[d,"sortTimeline",a,c]):b._trigger.apply(f,[f,"moveTimeline",a,c,c.item.parent()])}}),h.isDroppable&&c.droppable({accept:".DropZone-Route",drop:function(c,f){f.draggable.appendTo(a(this)).css({position:"relative",top:0,left:0,width:"100%"});Fb.DndHelpers.droppable.drop.apply(this,arguments);b._trigger.apply(d,[d,"dropTimeline",c,f])}}),h.isAddable&&j.find("span.addTrack").click(function(){b.addTimeline.apply(d)}),
h.isRemovable&&j.find("span.rmPortlet").click(function(){b.destroy.apply(d)}),h.isPrintable&&j.find("span.prPortlet").click(function(){b._trigger.apply(d,[d,"print"])}));j.find("span.collapse").click(function(){var c="string"===typeof a(this).attr("class")?a(this).attr("class"):"";a(this).toggleClass("ui-icon-triangle-1-e").toggleClass("ui-icon-triangle-1-s");a(this).parents("div.portlet:first").find("div.portlet-content:first").slideToggle();b._trigger.apply(d,[d,c.match(/\bui-icon-triangle-1-e\b/)?
"fold":"unfold"])});b._trigger.apply(d,[d,"create"]);a(this).data("fbDispoPortlet");"timelines"in a(this).data("fbDispoPortlet").data?(b.addTimelines.apply(d,[a(this).data("fbDispoPortlet").data.timelines]),delete a(this).data("fbDispoPortlet").data.timelines):b.addTimeline.apply(d)},destroy:function(){if(!1===b._trigger.apply(this,[this,"remove"]))return!1;a(this).parent().is(".portlet")?a(this).parent().remove():a(this).remove()},addTimelines:function(a){for(var c in a)b.addTimeline.apply(this,
[a[c]])},addTimeline:function(b){var c=a(this).data("fbDispoPortlet"),h=a(this);if("undefined"==typeof b||null===b)b={};b.portlet_id=c.data.id;b.date=c.date;var e=a("<div />");h.append(e);e.fbDispoTimelineDropzone({date:c.date,data:b,_parent:h,_parentJqFunction:"fbDispoPortlet"})},getDataKey:function(){return"fbDispoPortlet"},getData:function(){var b=a(this).data("fbDispoPortlet");return"undefined"===typeof b||"object"!==typeof b||!("data"in b)?null:arguments.length?arguments[0]in b.data?b.data[arguments[0]]:
null:b.data},getTitle:function(){return a("span.portlet-header-title",a(this).closest("div.portlet")).html()},setData:function(){1==arguments.length?a(this).data("fbDispoPortlet").data=arguments[0]:2<=arguments.length&&(a(this).data("fbDispoPortlet").data[arguments[0]]=arguments[1])},setTitle:function(d){var c=this;a("span.portlet-header-title",a(this).closest("div.portlet")).html(d).unbind("click").bind("click",function(){var d=a(this).find("span.p-title"),e=d.text(),j=prompt("Titel bearbeiten",
e);"string"==typeof j&&j!==e&&(!1!==b._trigger.apply(c,[c,"updateTitle",j])?d.text(j):alert("trying update title returns false!"))})},clear:function(){a(".DropZone.DropZone-Route",this).remove();b._trigger.apply(this,array(this,"clearDispoPortlet"))},load:function(d){a(this).data("fbDispoPortlet").data=d.data;b.clear.apply(this);d.options&&a.fn.fbDispoPortlet.apply(this,["options",d.options]);if(d.timelines){for(var c=0;c<d.timelines.length;++c)b.addTimeline.apply(this,["load",d.timelines[c]]);b._trigger.apply(this,
array(this,"loadDispoPortlet"))}},_trigger:function(d,c){var h=a(this).data("fbDispoPortlet"),e=b._getEventTriggerName(c),j=b._getOwnEventHandlerName(c),g=a.makeArray(arguments).slice(1),l=null;if(j&&(j in h&&"function"==typeof h[j])&&!1===h[j].apply(d,g.slice(1)))return!1;g[0]=e;return d==this&&!1===a(this).trigger.apply(a(this),g)||h._parent&&h._parentJqFunction&&(g.unshift(d),g.unshift("_trigger"),l=h._parent[h._parentJqFunction].apply(h._parent,g),!1===l)?!1:!0},_getEventTriggerName:function(a){a in
e&&(a=e[a]);return a},_getOwnEventHandlerName:function(a){a="on"+a.charAt(0).toUpperCase()+a.substr(1);return a in c?a:""}};a.fn.fbDispoPortlet=function(d){var f=arguments,h=arguments.length;if("string"==typeof d&&this.length)switch(d){case "options":if(1==h)return a(this[0]).data("fbDispoPortlet");break;case "option":if(2==h){var e=a(this[0]).data("fbDispoPortlet");return"undefined"!=typeof e[f[1]]?e[f[1]]:null}break;default:if("function"==typeof b[d]&&("_trigger"==d||"get"==d.substr(0,3)))return b[d].apply(this[0],
a.makeArray(f).slice(1))}return this.each(function(){var e=!1,g={};a(this).data("fbDispoPortlet")||(g=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.portlet?a.extend({},c,Fb.DispoCalendarSettings.portlet):c,d?"object"==typeof d?a(this).data("fbDispoPortlet",a.extend({},g,d)):a(this).data("fbDispoPortlet",a.extend({},g)):a(this).data("fbDispoPortlet",a.extend({},g)),e=!0);g=a(this).data("fbDispoPortlet");if("string"==typeof d)switch(d){case "options":1<h&&(g=a.extend({},g,f[1]),a(this).data("fbDispoPortlet",
g));break;case "option":2<h&&(g[f[1]]=f[2],a(this).data("fbDispoPortlet",g));break;default:"function"==typeof b[d]&&b[d].apply(this,a.makeArray(f).slice(1))}e&&b._init.apply(this)})}})(jQuery);(function(a){var g={create:"createResource",drop:"dropResource",move:"moveResource",remove:"removeResource"},e={data:{},resourceType:"Rsrc",isDraggable:!0,isRemovable:!0,onCreate:null,onRemove:null,_parent:null,_parentJqFunction:null,draggableOptions:null},c={_init:function(){var b=a(this),d=b.data("fbDispoResource");"function"==typeof d.data.ondrop&&(d.data.ondrop(),delete d.data.ondrop);b.addClass("fbDispoResource Drag-Rsrc RsrcType-"+("resourceType"in d.data?d.data.resourceType:d.resourceType));
d.isDraggable&&(d.draggableOptions=a.extend({},Fb.DragRsrcTemplateSettings),b.is(".is-default-resource")&&(d.draggableOptions={helper:function(){var b=a(this).clone().appendTo("body").css("zIndex",3E3);b.data("fbDispoResource",a(this).data("fbDispoResource"));b.data("dragdata",a(this).data("fbDispoResource").data);b.data("dragdata").sourceElement=this;return b},appendTo:"body",scroll:!0,scrollSensitivity:50,start:function(){}}),b.draggable(a.extend({},d.draggableOptions,{appendTo:"body"})));d&&"function"==
typeof d.onCreate&&d.onCreate.apply(this)},destroy:function(){var b=a(this).data("fbDispoResource").data;!1!==c._trigger.apply(this,[this,"remove",b])&&(b=a(this).parent("li"),b.length?b.remove():a(this).remove())},doAnything:function(){a(this).data("fbDispoResource")},getDroppableOptions:function(){return a(this).droppable.call(arguments)},getDataKey:function(){return"fbDispoResource"},getData:function(){var b=a(this).data("fbDispoResource");return arguments.length?arguments[0]in b.data?b.data[arguments[0]]:
null:b&&b.data?b.data:null},setData:function(){1==arguments.length?a(this).data("fbDispoResource").data=arguments[0]:2<=arguments.length&&(a(this).data("fbDispoResource").data[arguments[0]]=arguments[1])},reInitData:function(){var b=a(this).data("fbDispoResource");if(b._parent&&b._parentJqFunction){var d=b._parent;b.data.route_id=d[b._parentJqFunction].apply(d,["getData","id"])}},load:function(b){a(this).data("fbDispoResource").data=b.data;b.options&&a.fn.fbDispoResource.apply(this,["options",b.options])},
_moved:function(b,d){var f=d&&d.draggable?d.draggable:null,h=f&&f.data("fbDispoResource")&&f.data("fbDispoResource")._parent?f.data("fbDispoResource")._parent:null;c.reInitData.apply(this);if(!1===c._trigger.apply(this,[this,"move",h,b,d]))return alert("#151 fbDispoResource triggered event move returns false"),!1;if(d&&d.helper&&a(d.helper).length)return a(d.helper).remove(),!0;if((f=a(this).data("fbDispoResource"))&&f._parent&&f._parentJqFunction){var e=f._parent,h=f._parentJqFunction;f.data.route_id=
e[h].apply(e,["getData","id"]);if((f=d&&d.draggable?d.draggable:null)&&f.data("fbDispoResource")&&f.data("fbDispoResource")._parent)d.draggable.data("fbDispoResource")._parent[h]("getData","id")}},_dropped:function(){c.reInitData.apply(this);!1===c._trigger.apply(this,[this,"drop"])&&a(this).closest("li").remove()},_trigger:function(b,d){var f=a(this).data("fbDispoResource"),e=c._getEventTriggerName(d),g=c._getOwnEventHandlerName(d),j=a.makeArray(arguments).slice(1);g&&(g in f&&"function"==typeof f[g])&&
f[g].apply(b,j.slice(1));j[0]=e;b==this&&a(this).trigger.apply(a(this),j);f._parent&&f._parentJqFunction&&(j.unshift(b),j.unshift("_trigger"),f._parent[f._parentJqFunction].apply(f._parent,j))},_getEventTriggerName:function(a){a in g&&(a=g[a]);return a},_getOwnEventHandlerName:function(a){a="on"+a.charAt(0).toUpperCase()+a.substr(1);return a in e?a:""}};a.fn.fbDispoResource=function(b){var d=arguments,f=arguments.length;if("string"==typeof b&&this.length)switch(b){case "options":if(1==f)return a(this[0]).data("fbDispoResource");
break;case "option":if(2==f){var h=a(this[0]).data("fbDispoResource");return"undefined"!=typeof h[d[1]]?h[d[1]]:null}break;default:if("function"==typeof c[b]&&"get"==b.substr(0,3))return c[b].apply(this[0],1<f?a.makeArray(d).slice(1):null)}return this.each(function(){var h=!1,g={};a(this).data("fbDispoResource")||(g=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.resource?a.extend({},e,Fb.DispoCalendarSettings.resource):e,b?"object"==typeof b?a(this).data("fbDispoResource",a.extend({},g,b)):a(this).data("fbDispoResource",
a.extend({},g)):a(this).data("fbDispoResource",a.extend({},g)),h=!0);g=a(this).data("fbDispoResource");if("string"==typeof b)switch(b){case "options":1<f&&(g=a.extend({},g,d[1]),a(this).data("fbDispoResource",g));break;case "option":2<f&&(g[d[1]]=d[2],a(this).data("fbDispoResource",g));break;default:"function"==typeof c[b]&&c[b].apply(this,1<f?a.makeArray(d).slice(1):null)}h&&c._init.apply(this)})}})(jQuery);(function(a){var g={create:"createRoute",add:"addRoute",remove:"removeRoute",drop:"dropRoute",move:"moveRoute",resize:"resizeRoute",select:"selectRoute",changeData:"changeRouteData",hoverDetails:"hoverRouteDetails",showDetails:"showRouteDetails",hideDetails:"hideRouteDetails"},e={data:null,dataUrl:"",rsrcUrl:"",isEditable:!0,isDroppable:!0,isDraggable:!0,isResizable:!0,isRemovable:!0,timeStart:0,timeDuration:0,test:0,_parent:null,_parentJqFunction:null,onAdd:function(){alert("fbDispoRoute.onAdd Default-Dummie-Handler")},
onRemove:null,onSelect:null,onDrop:null,onMove:null,onResize:null,onShowDetails:null,onhideDetails:null,onDropResource:null,onMoveResource:function(){alert("fbDispoRoute.onMoveResource Default-Dummie-Handler")},route:null,draggableOptions:Fb.DragRouteInstanceSettings,droppableOptions:Fb.DropRsrcOnRouteSettings,resizableOptions:Fb.RouteResizableSettings},c={_init:function(){var b=a(this),d=b.data("fbDispoRoute");null===d.data&&(d.data={});!b.attr("id")&&"id"in d.data&&b.attr("id","fbDispoRoute_"+d.data.id);
(!b.attr("class")||!b.attr("class").match(/\bDrag-Route\b/))&&b.addClass("Drag-Route");b.removeClass("fbDispoRoute").addClass("fbDispoRoute");d.isDraggable&&b.draggable(d.draggableOptions);d.isDraggable&&b.droppable(d.droppableOptions);d.isDraggable&&b.resizable(d.resizableOptions);b.addClass("ui-corner-tr ui-corner-bottom").append(a("<div class='resourcesStat' />")).append(a('<ul class="resources" />'));b.data("dragdata")&&a.extend(d.data,b.data("dragdata"));d.isDraggable&&(c._mkRouteDroppableOnClick.apply(this),
b.bind("drop",function(){}));c.reInitData.apply(this);c.initHandler.apply(this);c.setTimeSlot.apply(this);c._trigger.apply(this,[this,"create"]);if(!a(this).data("fbDispoRoute"))throw"#95 fbDispoRoute._init: Falsches Objekt! Erwartet: fbDispoRoute; Erhalten:"+a(this).attr("class");a(this).data("fbDispoRoute").data.resources&&(c.addResources.apply(this,[a(this).data("fbDispoRoute").data.resources]),delete a(this).data("fbDispoRoute").data.resources);c._trigger.apply(this,[this,"changeData"])},initHandler:function(){var b=
this,d=a(this),f=d.data("fbDispoRoute");null===f.data&&(f.data={});var e={position:"absolute",display:"block",right:0,top:0,width:"15px",height:"15px",background:"#fff"},g=!f.data.DirektLieferInfo&&!f.data.LieferterminHinweisText?"ui-icon-info":"ui-icon-alert";d.append(a("<div/>").css(e).addClass("ui-corner-all").append(a("<span/>").addClass("ui-icon "+g)).hover(function(){var d=this;a(this).addClass("ui-state-hover").data("MouseIsOver",!0);setTimeout(function(){a(d).data("MouseIsOver")&&c._trigger.apply(b,
[b,"hoverDetails",d])},650)},function(){a(this).removeClass("ui-state-hover").data("MouseIsOver",!1)}).click(function(){Fb.showRouteDetails(b)}));d.hover(function(){d.addClass("ui-state-hover").data("MouseIsOver",!0);setTimeout(function(){d.data("MouseIsOver")&&c._trigger.apply(b,[b,"hoverRoute",b])},650)},function(){d.removeClass("ui-state-hover").data("MouseIsOver",!1);c._trigger.apply(b,[b,"leaveRoute",b])}).bind("click",function(){var d=a.makeArray(arguments);d.unshift(b,"clickRoute",b);c._trigger.apply(b,
d)}).bind("dblclick",function(){Fb.showRouteDetails(b)});d.bind("mouseleave",function(){c._trigger.apply(b,[b,"leaveRouteDetails",b])});f.isEditable&&f.isRemovable&&d.append(a("<div/>").css(e).css({top:"17px"}).addClass("ui-corner-all").append(a("<span/>").addClass("ui-icon ui-icon-trash")).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).click(function(){c.destroy.apply(b)}));1==f.data.avisiert&&d.append(a("<div/>").text("A").attr("title","Avisiert: "+
(1==f.data.avisiert?"Ja":"Nein")).css(e).css({top:"34px",textAlign:"center",fontSize:"10px"}).addClass("ui-corner-all ui-state-hover"));d.bind("showDetails",function(a,b){c._trigger.apply(this,[this,"showDetails",b])});d.bind("hideDetails",function(){c._trigger.apply(this,[this,"hideDetails"])});f.isEditable&&(a(this).bind("resource-dropped",c.addDroppedResource),a(this).bind("resource-moved",c.addDroppedResource))},addDroppedResource:function(b,d,f){var e=a(d).fbDispoResource("options"),e={_parent:a(this),
_parentJqFunction:"fbDispoRoute",_parentFrom:e&&"_parent"in e?e._parent:null,data:f.helper.data("dragdata")};d!==f.draggable?(d.fbDispoResource(e),d.fbDispoResource("_dropped",b,f)):(d.fbDispoResource("options",e),d.fbDispoResource("_moved",b,f));c.sortResources.apply(this);c.refreshResourcesStat.apply(this)},sortResources:function(){return 0},setResourcesUrl:function(b){a(this).data("fbDispoRoute").rsrcUrl=b},getResourcesUrl:function(){var b=a(this).data("fbDispoRoute");if(b.rsrcUrl)return b.rsrcUrl;
var d=a(this).closest("div.fbDispoCalendar").fbDispoCalendar("getObjectData","resourcesUrlTpl");return d.match(/{#ROUTEID}/)?d.replace(/{#ROUTEID}/,b.data.id):d+b.data.id},initResourceUrl:function(){var b=a(this).data("fbDispoRoute");b.rsrcUrl||(b.rsrcUrl=c.getResourcesUrl.apply(this));return b.rsrcUrl},getDataUrl:function(){var b=a(this).data("fbDispoRoute");if(b.rsrcUrl)return b.rsrcUrl;var d=a(this).closest("div.fbDispoCalendar").fbDispoCalendar("getObjectData","routeUrlTpl");return d.match(/{#ROUTEID}/)?
d.replace(/{#ROUTEID}/,b.data.id):d+b.data.id},reloadResources:function(){var b=a(this).data("fbDispoRoute");b.rsrcUrl||c.initResourceUrl.apply(this);var d=null;b.rsrcUrl?a.ajax({type:"GET",dataType:"json",async:!1,data:{id:b.data.id},url:b.rsrcUrl,success:function(a){d=a.data},error:function(a,b,d){alert("#240 Reload-Resource-Error: a:"+a+"; b:"+b+"; c:"+d)}}):alert("#247 fbDispoRoute.reloadResourcesFromUrl Error missing rsrcUrl!");c.reloadResourcesByData.apply(this,[d])},reloadResourcesByData:function(b){var d=
a(this);a("ul.resources li",d).remove();b&&("object"==typeof b&&b.length)&&c.addResources.apply(this,[b]);c.refreshResourcesStat.apply(this)},refreshResourcesStat:function(){a(".resourcesStat",a(this)).html("");var b=[];a("ul.resources .fbDispoResource",a(this)).each(function(){var d=("string"===typeof a(this).attr("class")?a(this).attr("class"):"").match(/\bRsrcType-([^ ]*)/),d=d?d[1]:"Rsrc";d in b?++b[d]:b[d]=1});for(var d in b)a(".resourcesStat",a(this)).append(a("<span rel='"+d+"' style='margin-right:5px;'>"+
d+" "+b[d]+"</span> &nbsp;"))},addResources:function(a){for(var d in a)c.addResource.apply(this,[a[d]]);c._trigger.apply(this,[this,"loadResources"]);c.refreshResourcesStat.apply(this)},addResource:function(b){var d=a(this);b||(b={});var c=a("<div />").text(b.name);a("ul.resources:first",d).append(a("<li/>").append(c));if(!c||!c.length)return alert("Unbekannter Systemfehler: Eine Ressource konnte nicht zur Tour hinzugefuegt werden!"),!1;a.fn.fbDispoResource.apply(c,[{data:b,_parent:a(this),_parentJqFunction:"fbDispoRoute"}])},
getPortlet:function(){return a(this).closest("div.fbDispoPortlet")},getTimeline:function(){return a(this).closest("div.fbDispoTimelineDropzone")},getResources:function(){return a("ul.resources li .Drag-Rsrc",a(this))},getRoutes:function(){var b=a(this).data("fbDispoRoute");return b&&b._parent?a("div.fbDispoRoute,div.fbDispoRouteDefaults",b._parent):a()},setTimeSlot:function(b){var d=a(this),c=d.data("fbDispoRoute");d.data("route")||d.data("route",{});var e=d.data("route");b&&b.from&&(c.data.ZeitVon=
b.from);b&&b.to&&(c.data.ZeitBis=b.to);b=a(c._parent).fbDispoTimelineDropzone("getTimelineLineal");var g=a(b).data("fbDispoTimelineLineal").settings;e.start=a.timeToMinutes(c.data.ZeitVon);e.end=a.timeToMinutes(c.data.ZeitBis);e.duration=e.end-e.start;e.duration<g._stepWidthM&&(e.duration=g._stepWidthM);this.style.position="absolute";this.style.top=a(b).height();this.style.left=100*(e.start-g._startM)/g._totalM+"%";this.style.width=100*e.duration/g._totalM+"%";this.style.height=d.parent().height()-
a(b).height()-22+"px"},_moved:function(){if(!1===c._trigger.apply(this,[this,"move"])){try{var b=a(this).data("fbDispoRoute"),d=a(this).data("draggable");d&&(d._src&&d._src.parent&&b&&b._parent)&&d._src.parent.get(0)!=b._parent.get(0)&&(a(this).appendTo(d._src.parent),b._parent=d._src.parent)}catch(f){alert(f)}c.setTimeSlot.apply(this);return!1}},_resized:function(){var b=a(this),d=b.data("route");if(!d)return!1;b=b.data("fbDispoRoute");b.timeStart=d.start;b.timeEnd=d.end;b.timeDuration=d.duration;
if(!1===c._trigger.apply(this,[this,"resize"]))return c.setTimeSlot.apply(this),!1},_dropped:function(){c.reInitData.apply(this);if(!1===c._trigger.apply(this,[this,"drop"]))return!1},reInitData:function(){var b=a(this).data("fbDispoRoute");null===b.data&&(b.data={});if(b._parent&&b._parentJqFunction){var d=b._parent,c=b._parentJqFunction;b.data.timeline_id=d[c].apply(d,["getData","id"]);b.date=d[c].apply(d,["option","date"]);b.data.DatumVon=d[c].apply(d,["option","date"]);b.data.DatumBis=d[c].apply(d,
["option","date"])}},draggable:function(){a(this).draggable.call(arguments)},droppable:function(){a(this).droppable.call(arguments)},resizable:function(){a(this).resizable.call(arguments)},getDraggableOptions:function(){return a(this).draggable.call(arguments)},getDroppableOptions:function(){return a(this).droppable.call(arguments)},getResizableOptions:function(){return a(this).resizable.call(arguments)},destroy:function(){!0===c._trigger.apply(this,[this,"remove"])&&(a(this).removeData("fbDispoRoute"),
a(this).remove())},_mkDroppable:function(){if("string"!==typeof a(this).attr("class")||!a(this).attr("class").match(/\bDragRoute-Focus\b/))a("div.Drag-Route").removeClass("DragRoute-Focus"),a(this).addClass("DragRoute-Focus"),a("div.Drag-Route:not(.DragRoute-Focus)").droppable("option","accept","none"),a("div.Drag-Route.DragRoute-Focus").droppable("option","accept",".Drag-Rsrc"),Fb.Dnd.droppable_route=a(this),c._trigger.apply(this,[this,"select"].concat(a.makeArray(arguments)))},_mkRouteDroppableOnClick:function(){a(this).bind("click",
c._mkDroppable)},getDataKey:function(){return"fbDispoRoute"},getData:function(){if("object"!=typeof a(this).data("fbDispoRoute"))return null;var b=a(this).data("fbDispoRoute");null==b.data&&(b.data={});return arguments.length?arguments[0]in b.data?b.data[arguments[0]]:null:b.data},setData:function(){var b=a(this).data("fbDispoRoute");if(null===b.data||"undefined"==typeof b.data)b.data={};1==arguments.length?b.data=arguments[0]:2<=arguments.length&&(b.data[arguments[0]]=arguments[1]);c._trigger.apply(this,
[this,"changeData"])},setTitle:function(b){a(this).find("span.title").html(b)},clear:function(){a(".Drag-Route",this).remove()},load:function(b){a(this).data("fbDispoRoute").data=b.data;c.clear.apply(this);b.options&&a.fn.fbDispoRoute.apply(this,["options",b.options]);if(b.resources)for(var d=0;d<b.resources.length;++d)c.addResource.apply(this,["load",b.resources[d]])},_trigger:function(b,d){var f=a(this).data("fbDispoRoute"),e=c._getEventTriggerName(d),g=c._getOwnEventHandlerName(d),j=a.makeArray(arguments).slice(1);
if(c["_"+g]&&!1===c["_"+g].apply(this,arguments)||g&&(g in f&&"function"==typeof f[g])&&!1===f[g].apply(b,j.slice(1)))return!1;j[0]=e;return b==this&&!1===a(this).trigger.apply(a(this),j)||f._parent&&f._parentJqFunction&&(j.unshift(b),j.unshift("_trigger"),!1===f._parent[f._parentJqFunction].apply(f._parent,j))?!1:!0},_getEventTriggerName:function(a){a in g&&(a=g[a]);return a},_getOwnEventHandlerName:function(a){a="on"+a.charAt(0).toUpperCase()+a.substr(1);return a in e?a:""},_onDropResource:function(b,
d,c){b=a(this).data("fbDispoRoute");d=a(this);a(c).fbDispoResource({data:{route_id:b.data.id},_parent:d,_parentJqFunction:"fbDispoRoute"})},_onMoveResource:function(b,d,c,e,g){b=a(this).data("fbDispoRoute");d=a(this);a(g).fbDispoResource({data:{route_id:b.data.id},_parent:d,_parentJqFunction:"fbDispoRoute"})}};a.fn.fbDispoRoute=function(b){var d=arguments,f=arguments.length;if("string"==typeof b&&this.length)switch(b){case "options":if(1==f)return a(this[0]).data("fbDispoRoute");break;case "option":if(2==
f){var g=a(this[0]).data("fbDispoRoute");return"object"==typeof g&&"undefined"!=typeof g[d[1]]?g[d[1]]:null}break;default:if("function"==typeof c[b]&&("_trigger"==b||"get"==b.substr(0,3)))return!a(this[0]).data("fbDispoRoute")?null:c[b].apply(this[0],1<f?a.makeArray(d).slice(1):[])}return this.each(function(){var g=!1,h={};a(this).data("fbDispoRoute")||(h=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.route?a.extend({},e,Fb.DispoCalendarSettings.route):e,b?"object"==typeof b?a(this).data("fbDispoRoute",
a.extend({},h,b)):a(this).data("fbDispoRoute",a.extend({},h)):a(this).data("fbDispoRoute",a.extend({},h)),g=!0);h=a(this).data("fbDispoRoute");if("string"==typeof b)switch(b){case "options":1<f&&(h=a.extend({},h,d[1]),a(this).data("fbDispoRoute",h));break;case "option":2<f&&(h[d[1]]=d[2],a(this).data("fbDispoRoute",h));break;default:"function"==typeof c[b]&&c[b].apply(this,1<f?a.makeArray(d).slice(1):null)}g&&c._init.apply(this)})};a.fn.fbDispoRoute.getMethods=function(){return c};a.fn.fbDispoRoute.getDefaults=
function(){return e};a.fn.fbDispoRoute.getRouteById=function(b){return a("#fbDispoRoute_"+b)}})(jQuery);(function(a){var g={create:"createRouteDefaults",add:"addRouteDefaults",remove:"removeRouteDefaults",drop:"dropRouteDefaults",move:"moveRouteDefaults",resize:"resizeRouteDefaults",select:"selectRouteDefaults",hover:"hoverRouteDefaults",leave:"leaveRouteDefaults",hoverDetails:"hoverRouteDetails",showDetails:"showRouteDefaultsDetails",hideDetails:"hideRouteDefaultsDetails",dropResource:"dropResourceDefaults",moveResource:"moveResourceDefaults",removeResource:"removeResourceDefaults"},e={data:null,dataUrl:"",
timeStart:0,timeDuration:0,test:0,_parent:null,_parentJqFunction:null,isDroppable:!0,onAdd:null,onRemove:null,onSelect:null,onDrop:null,onMove:null,onResize:null,onHover:null,onLeave:null,onShowDetails:null,onhideDetails:null,onDropResource:null,onMoveResource:null,draggableOptions:Fb.DragRouteInstanceSettings,droppableOptions:Fb.DropRsrcOnRouteSettings},c={_init:function(){var b=a(this),d=b.data("fbDispoRouteDefaults");null===d.data&&(d.data={});!b.attr("id")&&"id"in d.data&&b.attr("id","fbDispoRouteDefaults_"+
d.data.id);d._parent||(d._parent=b.closest("div.fbDispoTimelineDropzone"),d._parentJqFunction="fbDispoTimelineDropzone");b.addClass("DropZoneDefaults Drag-Route fbDispoRouteDefaults").css({position:"absolute",left:0,bottom:0,width:"100%",height:19,zIndex:3E3,display:"block",borderLeft:0,borderRight:0,borderBottom:0,backgroundImage:"none",backgroundColor:"#fff"}).addClass("ui-state-default").droppable(a.extend({},Fb.DropRsrcOnRouteSettings,{accept:Fb.DropRsrcOnRouteSettings.accept+",.is-default-resource"})).bind("RsrcDropped",
function(){alert("Resource dropped on Resource-Defaults!")}).append(a("<div class='resourcesStat' />").css({display:"inline"})).append(a("<ul class='resources' />").css({display:"inline"}));b.data("dragdata")&&a.extend(d.data,b.data("dragdata"));d.isDroppable&&(c._mkRouteDroppableOnClick.apply(this),b.bind("drop",function(){}));c.reInitData.apply(this);c.initHandler.apply(this);c._trigger.apply(this,[this,"create"]);a(this).data("fbDispoRouteDefaults").data.resources&&(c.addResources.apply(this,[a(this).data("fbDispoRouteDefaults").data.resources]),
delete a(this).data("fbDispoRouteDefaults").data.resources);a(this).show()},initHandler:function(){var b=this,d=a(this);d.hover(function(){d.data("MouseIsOver",!0)},function(){d.data("MouseIsOver",!1);c._trigger.apply(b,[b,"leave",b])}).bind("dblclick",function(){Fb.showRouteDetails(d,{pages:{Resources:"Ressourcen",Options:"Einstellungen"}})});d.bind("mouseleave",function(){c._trigger.apply(b,[b,"leave",b])});d.css({paddingLeft:20}).append(a("<div/>").css({position:"absolute",display:"block",left:0,
top:0,width:"15px",height:"15px",background:"#fff"}).addClass("ui-corner-all").append(a("<span/>").addClass("ui-icon ui-icon-info")).hover(function(){a(this).addClass("ui-state-hover");d.data("MouseIsOver",!0);setTimeout(function(){d.data("MouseIsOver")&&c._trigger.apply(b,[b,"hover",b])},1E3)},function(){a(this).removeClass("ui-state-hover")}).click(function(){Fb.showRouteDetails(d,{pages:{Resources:"Ressourcen",Options:"Einstellungen"}})}));d.bind("showDetails",function(a,b){c._trigger.apply(this,
[this,"showDetails",b])});d.bind("hideDetails",function(){c._trigger.apply(this,[this,"hideDetails"])});a(this).bind("resource-dropped",c.addDroppedResource);a(this).bind("resource-moved",c.addDroppedResource)},resfresh:function(b){var d=a(this);c.setData.apply(this,[b]);b=d.data("fbDispoRouteDefaults");c.reInitData.apply(this);c.initHandler.apply(this);a("ul.resources li").remove();b.data.resources&&(c.addResources.apply(this,[b.data.resources]),delete b.data.resources);c._trigger.apply(this,[this,
"reload"])},sortResources:function(){},getResourcesUrl:function(){var b=a(this).data("fbDispoRouteDefaults");if(b.rsrcUrl)return b.rsrcUrl;var d=a(this).closest("div.fbDispoCalendar").fbDispoCalendar("getObjectData","resourcesUrlTpl");return d.match(/{#ROUTEID}/)?d.replace(/{#ROUTEID}/,b.data.id):d+b.data.id},initResourceUrl:function(){var b=a(this).data("fbDispoRouteDefaults");b.rsrcUrl||(b.rsrcUrl=c.getResourcesUrl.apply(this));return b.rsrcUrl},getDataUrl:function(){var b=a(this).data("fbDispoRouteDefaults");
if(b.rsrcUrl)return b.rsrcUrl;var d=a(this).closest("div.fbDispoCalendar").fbDispoCalendar("getObjectData","routeUrlTpl");return d.match(/{#ROUTEID}/)?d.replace(/{#ROUTEID}/,b.data.id):d+b.data.id},reloadResources:function(){var b=a(this).data("fbDispoRouteDefaults");b.rsrcUrl||c.initResourceUrl.apply(this);var d=null;b.rsrcUrl?a.ajax({type:"GET",dataType:"json",async:!1,data:{id:b.data.id},url:b.rsrcUrl,success:function(a){d=a.data},error:function(a,b,d){alert("#240 Reload-Resource-Error: a:"+a+
"; b:"+b+"; c:"+d)}}):alert("#206 fbDispoRouteDefaults.reloadResourcesFromUrl Error missing rsrcUrl!");c.reloadResourcesByData.apply(this,[d])},reloadResourcesByData:function(b){var d=a(this);a("ul.resources li",d).remove();b&&("object"==typeof b&&b.length)&&c.addResources.apply(this,[b]);c.refreshResourcesStat.apply(this)},refreshResourcesStat:function(){a(".resourcesStat",a(this)).html("");var b=[],d=[];a("ul.resources .fbDispoResource",a(this)).each(function(){var c=("string"===typeof a(this).attr("class")?
a(this).attr("class"):"").match(/\bRsrcType-([^ ]*)/),c=c?c[1]:"Rsrc";c in b?++b[c]:b[c]=1;d[d.length]=a(this).text()});for(var c in b)a(".resourcesStat",a(this)).append(a("<span rel='"+c+"' style='margin-right:5px;'>"+c+" "+b[c]+"</span> &nbsp;"))},addDroppedResource:function(b,d,f){var e=a(d).fbDispoResource("options"),e={_parent:a(this),_parentJqFunction:"fbDispoRouteDefaults",_parentFrom:e&&"_parent"in e?e._parent:null,data:f.helper.data("dragdata")};a(d).data("dragdata",e.data);d==f.draggable||
d.is(".is-default-resource")?(d.fbDispoResource("options",e),d.fbDispoResource("_moved",b,f)):(d.fbDispoResource(e),d.fbDispoResource("_dropped",b,f));if(!this||!a(this).length)return!1;c.sortResources.apply(this);c.refreshResourcesStat.apply(this)},addResources:function(a){for(var d in a)c.addResource.apply(this,[a[d]]);c._trigger.apply(this,[this,"loadResources"]);c.sortResources.apply(this);c.refreshResourcesStat.apply(this)},addResource:function(b){var d=a(this);b||(b={name:"??"});var c=a("<div />").text(b.name);
if(!c||!c.length)return alert("Unbekannter Systemfehler. Ressource konnte nicht initialisiert werden!"),!1;a("ul.resources:first",d).append(a("<li/>").css({display:"inline",marginLeft:5}).append(c));c.addClass("is-default-resource");a.fn.fbDispoResource.apply(c,[{data:b,_parent:a(this),_parentJqFunction:"fbDispoRouteDefaults"}]);c.data("dragdata",b);c.removeClass("Drag-Rsrc")},getTimeline:function(){return a(this).closest("div.fbDispoTimelineDropzone")},getResources:function(){return a("ul.resources li .Drag-Rsrc",
a(this))},getRoutes:function(){var b=a(this).data("fbDispoRouteDefaults");return b&&b._parent?a("div.fbDispoRoute",b._parent).add(this):a()},setTimeSlot:function(b){var d=a(this),c=d.data("fbDispoRouteDefaults"),e=d.data("route");b&&b.from&&(c.data.ZeitVon=b.from);b&&b.to&&(c.data.ZeitBis=b.to);b=a(c._parent).fbDispoTimelineDropzone("getTimelineLineal");var g=a(b).data("fbDispoTimelineLineal").settings;e.start=a.timeToMinutes(c.data.ZeitVon);e.end=a.timeToMinutes(c.data.ZeitBis);e.duration=e.end-
e.start;e.duration<g._stepWidthM&&(e.duration=g._stepWidthM);this.style.position="absolute";this.style.top=a(b).height();this.style.left=100*(e.start-g._startM)/g._totalM+"%";this.style.width=100*e.duration/g._totalM+"%";this.style.height=d.parent().height()-a(b).height()-8},_moved:function(){c.reInitData.apply(this);c._trigger.apply(this,[this,"move"])},_resized:function(){var b=a(this),d=b.data("route"),b=b.data("fbDispoRouteDefaults");b.timeStart=d.start;b.timeEnd=d.end;b.timeDuration=d.duration;
c._trigger.apply(this,[this,"resize"])},_dropped:function(){c.reInitData.apply(this);c._trigger.apply(this,[this,"drop"])},reInitData:function(){var b=a(this).data("fbDispoRouteDefaults");null===b.data&&(b.data={});if(b._parent&&b._parentJqFunction){var d=b._parent,c=b._parentJqFunction;b.data.timeline_id=d[c].apply(d,["getData","id"]);b.date=d[c].apply(d,["option","date"]);b.data.DatumVon=d[c].apply(d,["option","date"]);b.data.DatumBis=d[c].apply(d,["option","date"]);d=a(b._parent).fbDispoTimelineDropzone("getTimelineLineal");
d=a(d).data("fbDispoTimelineLineal").settings;b.data.ZeitVon=d.start;b.data.ZeitBis=d.end}},draggable:function(){a(this).draggable.call(arguments)},droppable:function(){a(this).droppable.call(arguments)},resizable:function(){a(this).resizable.call(arguments)},getDraggableOptions:function(){return a(this).draggable.call(arguments)},getDroppableOptions:function(){return a(this).droppable.call(arguments)},getResizableOptions:function(){return a(this).resizable.call(arguments)},destroy:function(){c._trigger.apply(this,
[this,"remove"]);a(this).removeData("fbDispoRouteDefaults");a(this).remove()},_mkDroppable:function(){if("string"!==typeof a(this).attr("class")||!a(this).attr("class").match(/\bDragRoute-Focus\b/))a("div.Drag-Route").removeClass("DragRoute-Focus"),a(this).addClass("DragRoute-Focus"),a("div.Drag-Route:not(.DragRoute-Focus)").droppable("option","accept",".is-default-resource"),a("div.Drag-Route.DragRoute-Focus").droppable("option","accept",".Drag-Rsrc,.is-default-resource"),Fb.Dnd.droppable_route=
a(this),c._trigger.apply(this,[this,"select"].concat(a.makeArray(arguments)))},_mkRouteDroppableOnClick:function(){a(this).bind("click",c._mkDroppable)},getDataKey:function(){return"fbDispoRouteDefaults"},getData:function(){if("object"!==typeof a(this).data("fbDispoRouteDefaults"))return null;var b=a(this).data("fbDispoRouteDefaults");"data"in b||(b.data={});return arguments.length?"object"===typeof b.data&&arguments[0]in b.data?b.data[arguments[0]]:null:b.data},setData:function(){var b=a(this).data("fbDispoRouteDefaults");
if(null===b.data||"undefined"==typeof b.data)b.data={};1==arguments.length?b.data=arguments[0]:2<=arguments.length&&(b.data[arguments[0]]=arguments[1])},clear:function(){a(".Drag-Route",this).remove()},load:function(b){a(this).data("fbDispoRouteDefaults").data=b.data;c.clear.apply(this);b.options&&a.fn.fbDispoRouteDefaults.apply(this,["options",b.options]);if(b.resources)for(var d=0;d<b.resources.length;++d)c.addResource.apply(this,["load",b.resources[d]])},_trigger:function(b,d){var f=a(this).data("fbDispoRouteDefaults"),
e=c._getEventTriggerName(d),g=c._getOwnEventHandlerName(d),j=a.makeArray(arguments).slice(1);c["_"+g]&&c["_"+g].apply(this,arguments);if(g&&(g in f&&"function"==typeof f[g])&&!1===f[g].apply(b,j.slice(1)))return!1;j[0]=e;return f._parent&&f._parentJqFunction&&(j.unshift(b),j.unshift("_trigger"),!1===f._parent[f._parentJqFunction].apply(f._parent,j))?!1:!0},_getEventTriggerName:function(a){a in g&&(a=g[a]);return a},_getOwnEventHandlerName:function(a){a="on"+a.charAt(0).toUpperCase()+a.substr(1);return a in
e?a:""},_onDropResource:function(b,d,c){b=a(this).data("fbDispoRouteDefaults");d=a(this);a(c).fbDispoResource({data:{route_id:b.data.id},_parent:d,_parentJqFunction:"fbDispoRouteDefaults"})},_onMoveResource:function(b,d,c,e,g){b=a(this).data("fbDispoRouteDefaults");d=a(this);a(g).fbDispoResource({data:{route_id:b.data.id},_parent:d,_parentJqFunction:"fbDispoRouteDefaults"})}};a.fn.fbDispoRouteDefaults=function(b){var d=arguments,f=arguments.length;if("string"==typeof b&&this.length)switch(b){case "options":if(1==
f)return a(this[0]).data("fbDispoRouteDefaults");break;case "option":if(2==f){var g=a(this[0]).data("fbDispoRouteDefaults");return"object"==typeof g&&"undefined"!=typeof g[d[1]]?g[d[1]]:null}break;default:if("function"==typeof c[b]&&"get"==b.substr(0,3))return!a(this[0]).data("fbDispoRouteDefaults")?null:c[b].apply(this[0],1<f?a.makeArray(d).slice(1):[])}return this.each(function(){var g=!1,h={};a(this).data("fbDispoRouteDefaults")||(h=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.routeDefaults?
a.extend({},e,Fb.DispoCalendarSettings.routeDefaults):e,b?"object"==typeof b?a(this).data("fbDispoRouteDefaults",a.extend({},h,b)):a(this).data("fbDispoRouteDefaults",a.extend({},h)):a(this).data("fbDispoRouteDefaults",a.extend({},h)),g=!0);h=a(this).data("fbDispoRouteDefaults");if("string"==typeof b)switch(b){case "options":1<f&&(h=a.extend({},h,d[1]),a(this).data("fbDispoRouteDefaults",h));break;case "option":2<f&&(h[d[1]]=d[2],a(this).data("fbDispoRouteDefaults",h));break;default:"function"==typeof c[b]&&
c[b].apply(this,1<f?a.makeArray(d).slice(1):null)}g&&c._init.apply(this)})}})(jQuery);(function(a){a.fn.fbDispoRouteDroppableOnClick=function(){var g=function(){a("div.Drag-Route").removeClass("DragRoute-Focus");a(this).addClass("DragRoute-Focus");a("div.Drag-Route:not(.DragRoute-Focus)").droppable("option","accept","none");a("div.Drag-Route.DragRoute-Focus").droppable("option","accept",".Drag-Rsrc");Fb.Dnd.droppable_route=a(this)};return this.each(function(){a(this).data("fbDispoMkRouteDroppableOnClick")||a(this).data("fbDispoMkRouteDroppableOnClick",{init:!1});var e=a(this).data("fbDispoMkRouteDroppableOnClick");
e.init||(a(this).bind("click",g),e.init=!0)})}})(jQuery);(function(a){var g={create:"createTimeline",remove:"removeTimeline",drop:"dropRoute",move:"moveTimeline"},e={data:null,_parent:null,_parentJqFunction:null,isSortable:!0,isMovable:!0,isRemovable:!0,isDroppable:!0,onCreate:null,onRemove:null,onLoadRoute:null,onDrop:null,onMove:null,onSort:null},c={_init:function(){var b=a(this),d=b.data("fbDispoTimelineDropzone");b.addClass("DropZone DropZone-Route Drop-Timeline fbDispoTimelineDropzone").append(a('<div class="Timeline"/>')).find("div.Timeline").fbDispoTimelineLineal(b.data("fbDispoTimelineDropzone").data).end().fbDispoTimelineDropzoneHandles({sortable:d.isSortable,
movable:d.isMovable,removable:d.isRemovable}).bind("drop",function(){});d.isDroppable&&b.droppable(Fb.DropRouteSettings);c._trigger.apply(this,[this,"create"]);a(this).data("fbDispoTimelineDropzone");a(this).data("fbDispoTimelineDropzone").data.touren&&(c.addRoutes.apply(this,[a(this).data("fbDispoTimelineDropzone").data.touren]),delete a(this).data("fbDispoTimelineDropzone").data.touren);a("div.fbDispoRouteDefaults",this).show()},getTimelineLineal:function(){return a("div.Timeline:first",this)},
getTimelineSettings:function(){return c.getTimelineLineal.apply(this).fbDispoTimelineLineal("getSettings")},getRoutes:function(){return a("div.fbDispoRoute,div.fbDispoRouteDefaults",this)},addRoutes:function(a){for(var d in a)c.addRoute.apply(this,[a[d]])},addRoute:function(b){b||(b={});var d=a("<div />");d.append(a("<span/>").addClass("title").text(b.name));a(this).append(d);var f={data:b,_parent:a(this),_parentJqFunction:"fbDispoTimelineDropzone"};!("IsDefault"in b)||1!=parseInt(b.IsDefault)?d.fbDispoRoute.apply(d,
[f]):d.fbDispoRouteDefaults.apply(d,[f]);c._trigger.apply(this,[d,"loadRoute"])},_moved:function(){alert("#127 fbDispoTimelineDropzone._moved!");c._trigger.apply(this,[this,"move"])},_dropped:function(){c._trigger.apply(this,[this,"drop"])},destroy:function(){!1!==c._trigger.apply(this,[this,"remove"])&&a(this).remove()},getDataKey:function(){return"fbDispoTimelineDropzone"},getData:function(){var b=a(this).data("fbDispoTimelineDropzone");return"object"!==typeof b||!("data"in b)||"object"!==typeof b.data?
null:arguments.length?arguments[0]in b.data?b.data[arguments[0]]:null:b.data},setData:function(){1==arguments.length?a(this).data("fbDispoTimelineDropzone").data=arguments[0]:2<=arguments.length&&(a(this).data("fbDispoTimelineDropzone").data[arguments[0]]=arguments[1])},clear:function(){a(".Drag-Route",this).remove()},load:function(b){var d=a(this).data("fbDispoTimelineDropzone");d.data=b.data;c.clear.apply(this);b.options&&a.fn.fbDispoTimelineDropzone.apply(this,["options",b.options]);if(d.routes)for(d=
0;d<b.routes.length;++d)c.addRoute.apply(this,["load",b.routes[d]])},_trigger:function(b,d){var f=a(this).data("fbDispoTimelineDropzone"),e=c._getEventTriggerName(d),g=c._getOwnEventHandlerName(d),j=a.makeArray(arguments).slice(1);if(g&&(g in f&&"function"==typeof f[g])&&!1===f[g].apply(b,j.slice(1)))return!1;j[0]=e;return b==this&&!1===a(this).trigger.apply(a(this),j)||f._parent&&f._parentJqFunction&&(j.unshift(b),j.unshift("_trigger"),!1===f._parent[f._parentJqFunction].apply(f._parent,j))?!1:!0},
_getEventTriggerName:function(a){a in g&&(a=g[a]);return a},_getOwnEventHandlerName:function(a){a="on"+a.charAt(0).toUpperCase()+a.substr(1);return a in e?a:""}};a.fn.fbDispoTimelineDropzone=function(b){var d=arguments,f=arguments.length;if("string"==typeof b&&this.length)switch(b){case "options":if(1==f)return a(this[0]).data("fbDispoTimelineDropzone");break;case "option":if(2==f){var g=a(this[0]).data("fbDispoTimelineDropzone");return"undefined"!=typeof g[d[1]]?g[d[1]]:null}break;default:if("function"==
typeof c[b]&&("_trigger"==b||"get"==b.substr(0,3)))return c[b].apply(this[0],a.makeArray(d).slice(1))}return this.each(function(){var g=!1,h={};a(this).data("fbDispoTimelineDropzone")||(h=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.timelineDropzone?a.extend({},e,Fb.DispoCalendarSettings.timelineDropzone):e,b?"object"==typeof b?a(this).data("fbDispoTimelineDropzone",a.extend({},h,b)):a(this).data("fbDispoTimelineDropzone",a.extend({},h)):a(this).data("fbDispoTimelineDropzone",a.extend({},h)),
g=!0);h=a(this).data("fbDispoTimelineDropzone");if("string"==typeof b)switch(b){case "options":1<f&&(h=a.extend({},h,d[1]),a(this).data("fbDispoTimelineDropzone",h));break;case "option":2<f&&(h[d[1]]=d[2],a(this).data("fbDispoTimelineDropzone",h));break;default:"function"==typeof c[b]&&c[b].apply(this,1<f?a.makeArray(d).slice(1):null)}g&&c._init.apply(this)})}})(jQuery);(function(a){var g={sortable:!0,movable:!0,removable:!0},e={_init:function(){var c=this,b=a(this).data("fbDispoTimelineDropzoneHandles");a("div.DropZone-DragHandle,div.DropZone-Remove,div.DropZone-Sort,div.DropZone-General",a(this)).remove();var d=a('<div class="Timeline-HandleBox ui-state-default ui-corner-left"style="position:absolute;top:-1px;width:15px;left:-17px;height:60px;" />').css("height",a(this).height()).bind("mouseover",function(){a(this).addClass("ui-state-hover");a("div",this).show()}).bind("mouseout",
function(){a(this).removeClass("ui-state-hover");a("div",this).hide()});b.removable&&d.append(a("<div class='DropZone-Remove ui-icon-trash ui-state-disabled' title='Loeschen' style='display:none;'><span style='width:13px;background-position: -178px -98px;'class='ui-icon ui-icon-trash'></span></div>").css({position:"absolute",top:"19px",left:1,width:"13px",height:"15px",border:0}).click(function(){c.fbDispoTimelineDropzone("destroy")}).hover(function(){a(this).toggleClass("ui-state-default ui-corner-all").toggleClass("ui-state-disabled")}));
b.sortable&&d.append(a("<div class='DropZone-Sort ui-state-disabled' title='Sortieren' style='display:none;'><span style='width:13px;background-position: -130px -1;' class='ui-icon ui-icon-carat-2-n-s'></span></div>").css({position:"absolute",top:"36px",left:1,width:"13px",height:"15px",border:0}).hover(function(){a(this).toggleClass("ui-state-default ui-corner-all").toggleClass("ui-state-disabled")}));d.append(a("<div class='DropZone-General Drag-Route ui-state-disabled' title='Standard-Ressourcen' style='display:none;'><span style='width:13px;background-position: -163px -130;' class='ui-icon ui-icon-clipboard'></span></div>").css({position:"absolute",
top:"51px",left:1,width:"13px",height:"15px",border:0}).click(function(){var b=a("div.DropZoneDefaults",c);b.length||(b=a("<div/>"),c.append(b),b.fbDispoRouteDefaults());a("div.DragRoute-Focus").removeClass("DragRoute-Focus");b.toggleClass("DropZone-Focus");b.toggle("string"===typeof b.attr("class")&&b.attr("class").match(/\bDropZone-Focus\b/));"string"===typeof b.attr("class")&&b.attr("class").match(/\bDropZone-Focus\b/)&&b.trigger("click")}).hover(function(){a(this).toggleClass("ui-state-default ui-corner-all").toggleClass("ui-state-disabled")}));
a(this).append(d);b.movable&&a(this).draggable(a.extend({},Fb.MoveTimelineSettings,{handle:"div.DropZone-DragHandle"}))}};a.fn.fbDispoTimelineDropzoneHandles=function(c){var b=arguments,d=arguments.length;if("string"==typeof c&&this.length)switch(c){case "options":if(1==d)return a(this[0]).data("fbDispoTimelineDropzoneHandles");break;case "option":if(2==d)return d=a(this[0]).data("fbDispoTimelineDropzoneHandles"),"undefined"!=typeof d[b[1]]?d[b[1]]:null;break;default:if("function"==typeof e[c]&&"get"==
c.substr(0,3))return e[c].apply(this[0],1<d?a.makeArray(b).slice(1):null)}return this.each(function(){var b=a(this),d=!1,k={},k=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.timelineDropzoneHandles?a.extend({},g,Fb.DispoCalendarSettings.timelineDropzoneHandles):g;a(b).data("fbDispoTimelineDropzoneHandles")||(c?"object"==typeof c?a(this).data("fbDispoTimelineDropzoneHandles",a.extend({},k,c)):a(this).data("fbDispoTimelineDropzoneHandles",a.extend({},k)):a(this).data("fbDispoTimelineDropzoneHandles",
a.extend({},k)),d=!0);d&&e._init.apply(b)})}})(jQuery);(function(a){var g={timeline:null},e={timeline:"",gridClass:"",width:"1px",color:"#d2d2d2",style:"dashed",show:!0,top:0,zIndex:5E3,refreshIfExists:!1};a.fn.fbDispoTimelineGrid=function(c){if("string"==typeof c)switch(c){case "destroy":return this.each(function(){a(".tl-grid-step",a(this)).remove();a(this).removeData("fbDispoTimelineGrid")});case "hide":return this.each(function(){a(".tl-grid-step",a(this)).css("borderLeftWidth",0).hide()});case "show":return this.each(function(){a(".tl-grid-step",
a(this)).css("borderLeftWidth","1px").show()});case "toggle":return this.each(function(){a(".tl-grid-step",a(this)).toggle()});case "getGridRulers":if(!this.length)return[];var b=this[0].data("fbDispoTimelineGrid");return b&&b.gridRulers?b.gridRulers:[];case "refresh":this.each(function(){var b=a(this).data("fbDispoTimelineGrid");b&&"gridRulers"in b&&(b.gridRulers=null)})}return this.each(function(){var b=a(this);a(this).data("fbDispoTimelineGrid")||a(this).data("fbDispoTimelineGrid",{});var f=a(this).data("fbDispoTimelineGrid"),
h={},h=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.timelineGrid?a.extend({},e,Fb.DispoCalendarSettings.timelineGrid):e;f.settings||(f.settings=a.extend({},h));f.settings=a.extend({},f.settings,c);f.gridRulers||(f.gridRulers=null);if(!f.gridRulers||!f.gridRulers.length||f.refreshIfExists){var k=f.settings;f.refreshIfExists!=e.refreshIfExists&&(f.refreshIfExists=e.refreshIfExists);for(var j in g)if(!k[j]||!a(k[j],b).length){k[j]?alert("Invalid option for Timeline: Can not Found Element: $("+
k[j]+", $self); self.class:"+b.attr("class")):alert("Missing option for Timeline: "+j);return}var m=b.height(),h=a(k.timeline,b),h=a(".tl-step",h);b.find("div.tl-grid-step").remove();h.each(function(){b.append(a("<div/>").css({position:"absolute",height:m,top:k.top,left:a(this)[0].style.left,width:0,borderLeft:(k.show?"1px":"0px")+" "+k.style+" "+k.color,zIndex:k.zIndex,overflow:"hidden"}).addClass("tl-grid-step "+k.gridClass).data("gridStep",{time:a(this).data("timeStep").time}))});b.css("height",
a("div.tl-grid-step:first",b).height());f.gridRulers=a("div.tl-grid-step",b)}})}})(jQuery);(function(a){a.extend({timeToMinutes:function(a){a=(a+":0:0").split(":").slice(0,2);for(var e=0;e<a.length;e++){for(;"0"==a[e].substring(0,1);)a[e]=a[e].substring(1);a[e]=parseInt(a[e])||0}return 60*a[0]+a[1]},minutesToTime:function(a){var e=Math.floor(a/60);a%=60;23<e&&(e-=24);return(10>e?"0":"")+e+":"+(10>a?"0":"")+a}})})(jQuery);
(function(a){var g={start:"06:00",end:"20:00",stepWidth:"00:30",width:"100%",minWidth:"",addClass:"",stepClass:"",stepClassAlt:"",_total:"",_startM:0,_endM:0,_totalM:0,_stepWidthM:0,_stepWidthPct:0,onCreate:null,onRemove:null},e={timeToMinutes:function(a){a=(a+":0:0").split(":").slice(0,2);for(var b=0;b<a.length;b++){for(;"0"==a[b].substring(0,1);)a[b]=a[b].substring(1);a[b]=parseInt(a[b])||0}return 60*a[0]+a[1]},minutesToTime:function(a){var b=Math.floor(a/60);a%=60;23<b&&(b-=24);return(10>b?"0":
"")+b+":"+(10>a?"0":"")+a},getDataKey:function(){return"fbDispoTimelineLineal"},getSettings:function(){return a.extend({},a(this).data("fbDispoTimelineLineal").settings)}};a.fn.fbDispoTimelineLineal=function(c){var b=arguments;if("string"==typeof c&&this.length)switch(c){case "destroy":return this.each(function(){this.html("")});case "data":return this.first().data("fbDispoTimelineLineal");default:if("function"==typeof e[c]&&"get"==c.substr(0,3))return e[c].apply(this[0],a.makeArray(b).slice(1))}return this.each(function(){if("DIV"!==
a(this).get(0).tagName.toUpperCase())throw"Als Container f\ufffdr Timeline sind nur Div-Tags erlaubt. \ufffdbergeben wurde "+a(this).get(0).tagName;var b={},b=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.timelineLineal?a.extend({},g,Fb.DispoCalendarSettings.timelineLineal):g;a(this).data("fbDispoTimelineLineal")||(a(this).data("fbDispoTimelineLineal",{settings:a.extend({},b)}),a(this).addClass("fbDispoTimelineLineal"));b=a(this).data("fbDispoTimelineLineal");b.settings=a.extend({},b.settings,
c);b.steps=[];var f=b.settings,h=e.timeToMinutes(f.stepWidth),k=e.timeToMinutes(f.start),j=e.timeToMinutes(f.end);j<k&&(j+=1440);if(h){do b.steps.push(k),k+=h;while(k<j);f._startM=e.timeToMinutes(f.start);f._endM=j;f._totalM=f._endM-f._startM;f._total=e.minutesToTime(f._totalM);f._stepWidthM=e.timeToMinutes(f.stepWidth);f._stepWidthPct=100*f._stepWidthM/f._totalM;b.container=a("<table>").css({width:f.width,"min-width":f.minWidth}).append(a("<tr>"));f.addClass&&b.container.addClass(f.addClass);a(this).html("").append(b.container);
b.containerTr=a("tr:first",b.container);b.container=a("<div>").css({position:"relative",padding:0,border:0,overflow:"visible",height:"auto",width:f.width,"min-width":f.minWidth});f.addClass&&b.container.addClass(f.addClass);a(this).html("").append(b.container);b.containerTr=b.container;h=100*(Math.round(10*(b.container.width()/b.steps.length))/10)/b.container.width();k="";for(j=0;j<b.steps.length;++j)k=j*h+"%",b.containerTr.append(a("<div>").addClass("tl-step tl-step-"+(j%2?"odd":"even")).data("timeStep",
{time:b.steps[j],left:k}).css({position:"absolute",left:k,width:h+"%",overflow:"hidden",display:"block",margin:0,padding:0,border:0}).text(e.minutesToTime(b.steps[j])));b.steps.length&&b.containerTr.css({height:a("div.tl-step:first",b.containerTr).height()});f.stepClass&&a(f.stepClassAlt?"div:even":"div",b.containerTr).addClass(f.stepClass);f.stepClassAlt&&a("div:odd",b.containerTr).addClass(f.stepClassAlt)}else alert("Es wurde kein g\ufffdltiges Interval (stepWidth) f\ufffdr die Zeitleiste definiert!"),
alert("#128 fbDispoTimelineLineal this.each endTime:"+j+"; currentTime:"+k+" s.stepWidth:"+f.stepWidth+"; timeSlotWidth:"+h)})}})(jQuery);
