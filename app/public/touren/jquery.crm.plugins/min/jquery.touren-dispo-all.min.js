(function(a){var g={icon:"",display:"inline-block",css:null,clss:"ui-state-default ui-corner-all",hoverClass:"ui-state-hover",pos:"prepend",click:null,bind:null};a.fn.fbIcon=function(e){var d={};if("object"==typeof e)d=a.extend({},g,e),d.click&&(d.bind=a.extend({},d.bind,{click:d.click}));else{var b=arguments.length,d=a.extend({},g);"string"==typeof e&&(d.icon=e);2==b&&"object"==typeof arguments[1]&&(d=a.extend({},d,arguments[1]));3==b&&"object"==typeof arguments[2]&&(d=a.extend({},d,arguments[2]));
1<b&&"function"==typeof arguments[1]&&(d.bind=a.extend({},d.bind,{click:arguments[1]}))}d.display&&(d.css=a.extend({},d.css,{display:d.display}));return this.each(function(){var b=a(this),f=a("<span/>").css(d.css).addClass(d.clss).append(a("<span/>").addClass("ui-icon ui-icon-"+d.icon)).hover(function(){a(this).addClass(d.hoverClass)},function(){a(this).removeClass(d.hoverClass)}),h;for(h in d.bind)b.bind(h,d.bind[h]);"prepend"==d.pos?b.prepend(f):b.append(f)})}})(jQuery);
if("undefined"==typeof Fb)var Fb={};Fb.Dnd={overDroppable:null,overDropRulers:[],droppableBefore:null,draggable:null,draggable_data:null,draggable_width:null,droppable_route:null};Fb.DndHelpers={};
(function(a){Fb.DndHelpers.draggable={start:function(e,d){a(this).data("draggable")||a(this).data("draggable",{});var b=a(this).data("draggable");Fb.Dnd.draggable=a(this);Fb.Dnd.draggable_data=b;if(d.helper&&("string"!==typeof d.helper.attr("class")||!d.helper.attr("class").match(/\bIs-Template\b/))){var c=a(this)[0].style.left?parseInt(a(this).css("left")):a(this).position().left,f=a(this).position().top,h=a("<"+d.helper.get(0).tagName+"/>").css({position:d.helper.css("position"),display:"inline",
zIndex:d.helper.css("zIndex"),left:d.helper.css("left"),top:d.helper.css("top"),padding:0,margin:0,border:"1px dotted #d2d2d2"}).append(a("<div/>").css({paddin:0,margin:0,position:"relative",display:"inline-block",width:d.helper.width()-2,height:d.helper.height()-2}));b._src={changedParent:!0,revert:!1,placeholder:h,nextElm:this.nextSibling,position:a(this).css("position"),zIndex:a(this).css("zIndex"),parent:a(this).parent().first(),left:c,top:f,styleWidth:a(this)[0].style.width,styleLeft:a(this)[0].style.left,
styleTop:a(this)[0].style.top,pctWidth:a(this)[0].style.width.match(/%/)?a(this)[0].style.width:null,pctLeft:a(this)[0].style.left.match(/%/)?a(this)[0].style.left:null,pctTop:a(this)[0].style.top.match(/%/)?a(this)[0].style.top:null};b._dst={};(b._src.pctWidth||!b._src.styleWidth)&&a(this).css("width",a(this).width()+"px");c=d.helper.offset();b.offset.parent.top=0;b.offset.parent.left=0;b.offset.relative.top=0;b.offset.relative.left=0;b.positionAbs.top=c.top;b.positionAbs.left=c.left;h.insertBefore(d.helper);
d.helper.appendTo("body").css({position:"absolute",left:c.left,top:c.top,zIndex:2E3})}else b._src={zIndex:a(this).css("zIndex")};return!0},revert:function(e){e||a(this).fadeTo(200,1);if(e=e?!1:!0){var d=a(this).data("draggable")||{},b=d._src||{};b&&b.changedParent&&(b.revert=!0,d.originalPosition.left=b.parent.offset().left+b.left,d.originalPosition.top=b.parent.offset().top+b.top)}return e},stop:function(e,d){Fb.Dnd.draggable=null;Fb.Dnd.draggable_data=null;var b=(a(this).data("draggable")||{})._src||
{};b.revert&&(a(b.placeholder).length?a(b.placeholder).replaceWith(d.helper):a(b.nextElm).length?a(d.helper).insertBefore(b.nextElm):d.helper.appendTo(b.parent),d.helper.css({position:b.position,left:b.left,top:b.top}),b.pctLeft&&b.pctLeft.match(/%/)&&d.helper.css("left",b.pctLeft),b.pctTop&&b.pctTop.match(/%/)&&d.helper.css("top",b.pctTop),b.pctWidth&&b.pctWidth.match(/%/)?d.helper.css("width",b.pctWidth):d.helper.css("width",b.styleWidth),d.helper.css("left",b.styleLeft),d.helper.css("top",b.styleTop));
b.zIndex&&d.helper.css({zIndex:b.zIndex})}};Fb.DndHelpers.droppable={drop:function(e,d){var b=(d.helper.data("draggable")||d.draggable.data("draggable")||{})._src||{};b.zIndex&&d.helper.css({zIndex:b});b.placeholder&&a(b.placeholder).remove();d.helper!==d.draggable&&d.helper.removeClass("Is-Template").attr("id",d.draggable.attr("id")+Fb.DndHelpers._getNextID());return!1}};var g=0;Fb.DndHelpers._getNextID=function(){return++g};Fb.DropTrashBoxSettings={hoverClass:"ui-state-active",activeClass:"ShowDroppableZone",
accept:".Drag-Route,.Drag-Rsrc,.portlet",tolerance:"pointer",over:function(){},out:function(){},drop:function(e,d){var b=d.helper==d.draggable?d.helper:d.helper.clone().appendTo("body"),c=b.data("draggable");c&&(c._src&&c._src.placeholder&&c._src.placeholder)&&c._src.placeholder.remove();b.draggable("disable").hide(350,function(){a(this).remove()});return!0}};Fb.DragRsrcTemplateSettings={helper:"clone",welcome:"Juhuu!",appendTo:"body",zIndex:2500};Fb.DragRsrcInstanceSettings=a.extend({},Fb.DragRsrcTemplateSettings,
{helper:"none",appendTo:null},Fb.DndHelpers.draggable);Fb.RouteDataDefaults={start:0,duration:120,end:0};Fb.DragRouteTemplateSettings={create:function(){a(this).data("route")||a(this).data("route",a.extend({},Fb.RouteDataDefaults));var e=a(this).data("route"),d;for(d in Fb.RouteDataDefaults)"undefined"==typeof e[d]&&(e[d]=Fb.RouteDataDefaults[d])},helper:"clone",appendTo:"body",zIndex:2500,drag:function(e,d){"undefined"===typeof e.pageX&&("undefined"!==typeof window.event&&"undefined"!==typeof window.event.pageX)&&
(e.pageX=window.event.pageX);if(null==Fb.Dnd.draggable||!Fb.Dnd.draggable_data)Fb.Dnd.draggable=a(this),Fb.Dnd.draggable_data=a(this).data("draggable");Fb.Dnd.draggable_data._dst||(Fb.Dnd.draggable_data._dst={});try{if(Fb.Dnd.draggable_data.overDroppable&&Fb.Dnd.draggable_data.overDroppable.data("fbDispoTimelineGrid")){var b=Fb.Dnd.draggable_data.overDroppable;if(Fb.Dnd.droppableBefore!==b){var c=b.offset().left;Fb.Dnd.draggable_width=Fb.Dnd.draggable.width();Fb.Dnd.droppableRulers=b.data("fbDispoTimelineGrid").gridRulers.map(function(){return{left:c+
a(this).position().left,originLeft:a(this)[0].style.left,top:a(this).offset().top,gridRuler:a(this)}});Fb.Dnd.droppableBefore=b}for(var f=e.pageX-Fb.Dnd.draggable_data.offset.click.left,h=Fb.Dnd.droppableRulers,b=0;b+1<h.length&&h[b+1].left<f;)++b;b+1<h.length&&0.8*(f-h[b].left)>h[b+1].left-f&&++b;d.position.top=Fb.Dnd.droppableRulers[b].top;d.position.left=Fb.Dnd.droppableRulers[b].left;Fb.Dnd.draggable_data._dst.left=Fb.Dnd.droppableRulers[b].originLeft;Fb.Dnd.draggable_data._dst.gridRuler=Fb.Dnd.droppableRulers[b].gridRuler}}catch(k){}}};
a.extend(Fb.DragRouteTemplateSettings,Fb.DndHelpers.draggable);Fb.DragRouteInstanceSettings=a.extend({},Fb.DragRouteTemplateSettings,{helper:"none",appendTo:"body"});Fb.MoveTimelineSettings=a.extend({},Fb.DndHelpers.draggable,{start:function(e,d){Fb.DndHelpers.draggable.start.apply(this,arguments);a(this).fbDispoTimelineDropzone.apply(a(this),["_trigger",this,"startmove",e,d])},stop:function(e,d){Fb.DndHelpers.draggable.stop.apply(this,arguments);a(this).fbDispoTimelineDropzone.apply(a(this),["_trigger",
this,"move",e,d])}});Fb.DropRouteSettings={create:function(){a(this).fbDispoTimelineGrid({timeline:"div.Timeline",show:!1,top:a("div.Timeline:first",a(this)).height()});a(this).droppable("option","accept",".Drag-Route")},hoverClass:"ui-state-active",activeClass:"ShowDroppableZone",accept:".noDrag-Route",tolerance:"pointer",over:function(e,d){a(this).fbDispoTimelineGrid("show");d.draggable.data("draggable").overDroppable=a(this)},out:function(e,d){a(this).fbDispoTimelineGrid("hide");d.draggable.data("draggable").overDroppable=
null},drop:function(e,d){var b=a(this),c=a("div.Timeline:first",a(this)).height(),f=d.helper.data("draggable")||d.draggable.data("draggable")||{},h=d.helper.data("route")||d.draggable.data("route")||{};a(this).data("fbDispoTimelineGrid");var k=a("div.Timeline",a(this)).fbDispoTimelineLineal("data"),j=f&&f._dst&&f._dst.left?f._dst.left:null;a(this).fbDispoTimelineGrid({timeline:"div.Timeline",show:!0,refreshIfExists:!0,top:a("div.Timeline:first",a(this)).height()});Fb.DndHelpers.droppable.drop.apply(this,
arguments);f=d.helper===d.draggable?d.helper:d.helper.clone();d.helper.data("dragdata")&&f.data("dragdata",d.helper.data("dragdata"));var l=d.helper.offset().left-b.offset().left,g=d.helper.offset().top-b.offset().top;f.appendTo(b);f.css({position:"absolute",left:l,top:g}).animate({left:Math.max(5,l),top:c},function(){null!==j&&a(this).css("left",j)});h.start=Fb.Dnd.draggable_data._dst.gridRuler.data("gridStep").time;h.end=h.start+h.duration;b=f.fbDispoRoute("options");c={_parent:a(this),_parentJqFunction:"fbDispoTimelineDropzone",
_parentFrom:b&&"_parent"in b?b._parent:null,timeStart:h.start,timeDuration:h.duration,timeEnd:h.end};if(b){if(f.fbDispoRoute("options",c),!1===f.fbDispoRoute("_moved",e,d))return!1}else if(f.fbDispoRoute(c),!1===f.fbDispoRoute("_dropped",e,d))return!1;f.trigger("click");f[0].style.width=100*h.duration/k.settings._totalM+"%";d.draggable.data("draggable").overDroppable=null}};Fb.DropRsrcOnRouteSettings=a.extend({},Fb.DropRouteSettings,{create:null,drop:function(e,d){var b=a(this);Fb.DndHelpers.droppable.drop.apply(this,
arguments);var c=d.helper===d.draggable?d.helper:d.helper.clone();d.helper.offset();b.offset();d.helper.offset();b.offset();c.appendTo(a("ul.resources:first",b));"li"===c.get(0).tagName.toLowerCase()?c.appendTo(a("ul.resources:first",b)):a("ul.resources:first",b).append(a("<li/>").append(c));c.css({position:"relative",left:8,top:0});a(this).is(".fbDispoRouteDefaults");c.fbDispoResource("options");a(this);d.helper.data("dragdata");c!==d.draggable?a(this).trigger("resource-dropped",[c,d]):a(this).trigger("resource-moved",
[c,d])}});Fb.RouteResizableSettings={handles:"w,e",create:function(){},start:function(){var e=a(this),d=e.data("resizable"),b=d.options,c=e.parent("div.DropZone-Route:first"),f=c.data("fbDispoTimelineGrid").gridRulers;b.grid=[f.eq(1).position().left-f.eq(0).position().left,1];e.resizable("option","minWidth",b.grid);Fb.Dnd.droppableRulers=f.map(function(){return{left:a(this).position().left,originLeft:Math.floor(a(this)[0].style.left),top:a(this).offset().top,ruler:a(this),time:a(this).data("gridStep").time}});
d._src={parent:c,rulers:Fb.Dnd.droppableRulers,timelineData:a("div.Timeline",c).fbDispoTimelineLineal("data")}},resize:function(){},stop:function(){var e=a(this),d=e.data("resizable"),b=a("div.Timeline",d._src.parent).fbDispoTimelineLineal("data"),c=Fb.Dnd.droppableRulers;if(c&&c.length){for(var f=0,h=d.position.left,k=h+e.width(),j=Math.round(0.5*(c[1].left-c[0].left));f+1<c.length&&Math.floor(c[f+1].left)<=h;)++f;for(d=f+1<c.length&&c[f+1].left-h<h-c[f].left?++f:f;f+1<c.length&&Math.floor(c[f+1].left)<=
k+j;)++f;f=f+1<c.length&&c[f+1].left-h<h-c[f].left?++f:f;b=b.settings;h=e.data("route");h.start=c[d].time;h.end=c[f].time;h.duration=h.end-h.start;h.duration<b._stepWidthM&&(h.duration=b._stepWidthM);e[0].style.left=c[d].originLeft;e[0].style.width=100*h.duration/b._totalM+"%";e.fbDispoRoute("_resized")}}}})(jQuery);Fb||(Fb={});Fb.DispoCalendarSettings||(Fb.DispoCalendarSettings={});$.extend(Fb.DispoCalendarSettings,{calendar:{},portlet:{},timelineDropzone:{},timelineDropzoneHandles:{},timelineLineal:{start:"06:00",end:"20:00",stepWidth:"00:30"},timelineGrid:{},route:{allowedColors:"VIP Anker Fuell Projekt Reklamation Service Specials".split(" ")},routeDefaults:{askForApplyDefaults:!1,applyDefaults:!0},resource:{}});"undefined"==typeof Fb&&(Fb={});
(function(a){var g={pages:{Resources:"Ressourcen",Gruppierungen:"Gruppierungen",Details:"Daten",Timetable:"Zeitplan",Touren:"Touren",Bemerkungen:"Bemerkungen",Historie:"Historie",Abschluss:"Abschluss"},close:'<span class="ui-state-error" style="background:none;border:0;">Schliessen <span class="ui-icon ui-icon-closethick" style="height:13px;"></span></span>'};Fb.hideRouteDetails=function(e){var d=a(e);d.slideUp("normal",function(){d.length&&d.remove()})};Fb.showRouteDetails=function(e,d){var b=a(e),
c=b.closest("div.DropZone.DropZone-Route");if("undefined"==typeof d||null==d)d={};var f=a.extend({},g,d),h=!1;a("div.TourTabbedSheet").each(function(){a(this).data("BelongToTour")==b.get(0)&&(h=!0);Fb.hideRouteDetails(this)});if(h)a(e).fbDispoRoute("_trigger",e,"hideDetails");else{f.pages.close||(f.pages.close=f.close);var k=a("<div class='TourTabbedHead' style='padding-left:10px'>Tour-Basis-Daten</div>"),j=a("<ul>"),l=a("<div class='TourTabbedSheet tabs-flat' style='display:none;min-height:400px;'/>");
l.append(j);l.append(k);l.data("BelongToTour",b.get(0));var k="",m;for(m in f.pages)k="tabs-"+m,j.append(a("<li><a href='#"+k+"' id='Anchor-"+k+"'>"+f.pages[m]+"</a></li>")),l.append(a("<div id='"+k+"'><p></p></div>"));c.after(l.tabs({create:function(){a(this).tabs("select",0);a("li a:contains('Schliessen')",a(this)).bind("click",function(){Fb.showRouteDetails(e)})},show:function(){var b=a(this).tabs("option","selected");a.trim(a("li:eq("+b+")",this).text())}}));l.slideDown("normal");a(e).trigger("showDetails",
[l])}}})(jQuery);$(function(){"Fb"in window&&"DispoLoading"in window.Fb&&$(document).ajaxStart(window.Fb.DispoLoading.bind(window.Fb,1)).ajaxStop(window.Fb.DispoLoading.bind(window.Fb,0));$(document).ajaxComplete(function(){});$(document).ajaxSuccess(function(a,g,e,d){"object"===typeof e&&("async"in e&&!e.async)&&console.log("#11 Not Async!! jquery.fbDispoCalendar for url: ",{async:e.async,url:e.url});if(!("object"!==typeof d||!("type"in d)&&!("success"in d)&&!("msg"in d)&&!("error"in d))){if(!("type"in d)||"string"!==
typeof d.type)"boolean"===typeof d.type?d.type=d.type?"success":"error":"success"in d&&(d.type=d.success?"success":"error");d.success=d.success||"success"===d.type;d.msg=d.msg||"";d.error=d.error||"";d.data=d.data||"";a=d.error||d.msg||"";505<a.length&&(a=a.substr(0,500)+"...");d={heading:d.success?"OK":"Fehler",text:"<div class='nachricht'>"+a.split("\n").join("<br>")+"</div>",hideAfter:1E3*Math.min(2.5,Math.max(10,Math.ceil(a.length/30))),position:{top:10,left:10},icon:d.success?"info":"error"};
$.toast(d)}})});function flatObjToString(a,g){if("object"!==typeof a)return a;g||(g="");var e="",d;for(d in a)if("undefined"==typeof a.hasOwnProperty||a.hasOwnProperty(d)){e+=g+d+"("+typeof a[d]+") : ";try{typeof a[d].toString().match(/string|number|boolean/)?e+=a[d]+"\n":"object"==typeof a[d]&&(e+=g+a[d].constructor+("function"==typeof a[d].toString?"toString: "+a[d].toString():"")+"\n",e+=flatObjToString(a[d],g+"...")+"\n")}catch(b){e+=b+"\n"}}return e}function btos(a){return a?"true":"false"}
"undefined"==typeof Fb&&(Fb={});Fb.DispoCalendarSettings||(Fb.DispoCalendarSettings={});
Fb.DispoLoading=function(a){var g=$("#fbDispo_loading");$("#fbDispo_loading").length||(g=$("<div/>").attr({id:"fbDispo_loading","class":"fbDispoLoading ui-state-default ui-state-active"}).html("l&auml;dt ...").data("tasknr",0).click(function(){5!==$(this).css("top")&&"5px"!==$(this).css("top")?$(this).css({top:"5px",right:"25px"}):$(this).hide()}).appendTo("body"));if(arguments.length&&!a){var e=g.show().data().tasknr;setTimeout(function(){e===g.show().data().tasknr&&$("#fbDispo_loading").hide()},
950)}else g.show().data().tasknr++};
Fb.AjaxTourRequest=function(a,g){Fb.DispoLoading(1);var e=!1,d=!1;g||(g={});a||(a={});g=$.extend({},{defaultError:"",onsuccess:null,onerror:null},g);a=$.extend({},{url:"./",data:{},type:"GET",dataType:"json",async:!1,success:function(b,c,f){e=!1;if("confirm"in b&&b.confirm&&(e=confirm(b.confirm))){"confirmUrl"in b&&b.confirmUrl&&(a.url=b.confirmUrl);a.data="confirmData"in b&&b.confirmData?$.extend({},a.data,b.confirmData):$.extend({},a.data,{confirm:1});return}if(Fb.AjaxSuccessCheck(b,c,f,{defaultError:g.defaultError})){if(d=
!0,g.onsuccess&&"function"===typeof g.onsuccess)try{!1===g.onsuccess.apply(null,[b,c,f])&&(d=!1)}catch(h){console.log(h)}}else if(g.onerror&&"function"===typeof g.onerror)try{g.onerror.apply(null,[f,c])}catch(k){console.log(k)}},error:function(a,c,f){console.error("#231 AjaxTourRequest jquery.fbDispoCalendar error.js return",d,c,f);Fb.AjaxErrorShow(a,c,f,g.defaultError);if(g.onerror)try{g.onerror.apply(null,[a,c])}catch(h){console.log(h)}},complete:function(a,c){if(g.oncomplete)try{g.oncomplete.apply(null,
[a,c])}catch(f){console.log(f)}}},a);do Fb.DispoLoading(1),$.ajax(a);while(e);Fb.DispoLoading(0);return d};Fb.AppBaseUrl="string"==typeof APP_BASE_URL?APP_BASE_URL:"/";
Fb.AjaxSuccessCheck=function(a,g,e,d){return"object"==typeof a&&("error"in a&&a.error||"err"in a&&a.err||"success"in a&&!a.success||"type"in a&&("error"===a.type||!1===a.type))?("error"in a&&a.error?alert(a.error):"err"in a&&a.err?alert(a.err):"object"==typeof d&&"defaultError"in d?alert(d.defaultError):alert("Ups, sorry, interner Fehler!"),!1):!0};
Fb.AjaxErrorShow=function(a,g,e,d){var b;try{b=a.responseText?$.parseJSON(a.responseText):a.responseText}catch(c){b=a.responseText}"object"==typeof b?"error"in b&&alert(b.error):alert(d+"\n"+g+" "+e+"\n"+("string"==typeof b?b:""))};
Fb.RouteToolTip=function(a,g,e,d){d=d?d:"url";e||(e="above");try{var b=$("#FbToolTip"),c=$(a);0==b.length&&(b=$("<div/>").attr({id:"FbToolTip","class":"defaultTheme"}).css({position:"absolute",zIndex:99}).append($("<p/>").attr("id","FbToolTipContent").addClass("aToolTipContent")).appendTo("body"));b.hide().css({height:"auto",left:c.offset().left});b.css("top","above"==e?c.offset().top-b.outerHeight()-5:c.offset().top+c.outerHeight());b.data("MouseTarget")==a?b.show():(b.data("MouseTarget",a).bind("mouseover",
function(){c.data("MouseIsOver",!0)}).show().draggable(),"url"==d?b.find("#FbToolTipContent").text("loading ...").load(g,function(){$(this).append($("<a id='aToolTipCloseBtn' href='#' alt='close'>close</a>").click(function(a){a.preventDefault();b.data("MouseTarget",null);b.hide();return!1}));b.css({height:b.height(),top:"above"==e?c.offset().top-b.outerHeight()-5:c.offset().top+c.outerHeight()})}):"html"==d?b.find("#FbToolTipContent").html(g):"selector"==d&&b.find("#FbToolTipContent").html("").append($(g).clone()),
b.bind("mouseleave",function(){Fb.RouteToolTipHide(a)}),$(a).bind("mouseleave",function(){Fb.RouteToolTipHide(a)}))}catch(f){alert("#96 Error Showing ToolTip: "+f)}};Fb.RouteToolTipHide=function(a){var g=$(a);$("#FbToolTip").length&&(g.length?(g.data("MouseIsOver",!1),setTimeout(function(){$("#FbToolTip").length&&($(a).data("MouseIsOver")||$("#FbToolTip").hide())},500)):$("#FbToolTip").hide())};
Fb.DispoCheckConcurrency=function(a,g){var e=null,d=Fb.AppBaseUrl+"/touren/concurrency/check";a||(a={});g||(g=5);a.maxage=g;$.ajax({type:"GET",dataType:"json",async:!1,data:a,url:d,success:function(a){e=a}});return e};Fb.DispoListConcurrency=function(a,g){var e=null,d=Fb.AppBaseUrl+"/touren/concurrency/list";a||(a={});g||(g=5);a.maxage=g;$.ajax({type:"GET",dataType:"json",async:!1,data:a,url:d,success:function(a){e=a}});return e};
Fb.ReloadTimelineResources=function(a){$(a).fbDispoTimelineDropzone("getRoutes").each(function(){$(this).is(".fbDispoRoute")?$(this).fbDispoRoute("reloadResources"):$(this).is(".fbDispoRouteDefaults")&&$(this).fbDispoRouteDefaults("reloadResources")})};Fb.ReloadTimelineResourcesByRoute=function(a){Fb.ReloadTimelineResources($(a).fbDispoRoute("getTimeline"))};Fb.ReloadTimelineResourcesByRouteDefaults=function(a){Fb.ReloadTimelineResources($(a).fbDispoRouteDefaults("getTimeline"))};
Fb.RenderResourceDelAction=function(a,g,e){$(a).find(g).fbIcon({icon:"trash",css:{background:"none",border:0}}).css({marginRight:"3px"}).click(function(){var a={id:$(this).attr("rsrcid"),resourceType:$(this).attr("rsrctype"),name:$(this).parent().find("span.rsrc-title").text()},b=$("div#fbDispoRoute_"+e);b.length&&(!1!==b.fbDispoRoute("_trigger",b[0],"removeResource",a)?($(this).closest("li").length?$(this).closest("li").remove():$(this).remove(),b.fbDispoRoute("reloadResources")):alert("#192 Fb.RenderResourceDelAction; Error: CanNot Remove Resource"))})};
Fb.DispoCalendarEvents={};
(function(a){var g={create:"createDispoCalendar",complete:"completeDispoCalendar",changeDate:"changeDateDispoCalendar",clickVorgangsEmpehlungen:"clickVorgangsEmpehlungenDispoCalendar"},e=1,d=/^\d{4,4}-(0[1-9]|1[0-2])-([0-2][0-9]|3[0-2])$/,b={data:null,date:null,url:"",resourcesBaseUrlTpl:"",routeBaseUrlTpl:"",searchUrl:null,isBrowsable:!0,isAddable:!0,isHidable:!0,isRefreshable:!0,isPrintable:!0,isSortable:!0,isSearchable:!0,isContextSearchable:!0,triggerChildEvents:!1,onCreate:null,onComplete:null,
onChangeDate:null,onClickVorgangsEmpfehlungen:null,onCreatePortlet:null,onUpdatePortletTitle:null,onRemovePortlet:null,onPrintPortlet:null,onSortPortlet:null,onFoldPortlet:null,onUnfoldPortlet:null,onDropTimeline:null,onMoveTimeline:null,onSortTimeline:null,onCreateTimeline:null,onRemoveTimeline:null,onMoveTimeline:null,onDropRoute:null,onSelectRoute:null,onMoveRoute:null,onResizeRoute:null,onRemoveRoute:null,onChangeRouteData:null,onHoverRouteDefaults:null,onLeaveRouteDefaults:null,onCreateRouteDefaults:null,
onSelectRouteDefaults:null,onDropResourceDefaults:null,onMoveResourceDefaults:null,onRemoveResourceDefaults:null,onHoverRouteDetails:null,onLeaveRouteDetails:null,onLoadRoute:function(){alert("fbDispoCalendar.onLoadRoute Default-Dummie-Handler")},onHoverRoute:null,onLeaveRoute:null,onClickRoute:null,onShowRouteDetails:null,onHideRouteDetails:null,onShowRouteDefaultsDetails:null,onHideRouteDefaultsDetails:null,onAddResource:null,onDropResource:null,onMoveResource:null,onRemoveResource:null,onSetTourFarbklasse:null},
c={clear:function(){a("div.DispoCalendarPortlets",this).html("")},addPortlets:function(a){for(var b=0;b<a.length;++b)c.addPortlet.apply(this,[a[b]])},addPortlet:function(b){b||(b={});b.date=c._getDateString(c.getDate.apply(this));b.lager_id=c.getLager.apply(this);var d=a("<div />").prependTo(a("div.DispoCalendarPortlets",this));d.fbDispoPortlet({date:b.date,lager_id:b.lager_id,data:b,_parent:a(this),_parentJqFunction:"fbDispoCalendar"});a(".selector").sortable("refreshPositions");a("div.DispoCalendarPortlets",
this).sortable("refresh");return d},load:function(b){if("object"==typeof b)for(var d=0;d<b.length;++d)c.addPortlet.apply(this,["load",b[d]]);else{var k=this,j=a(this).data("fbDispoCalendar"),e="#493 start request calendarDayData "+(new Date).toLocaleString()+"\n";try{Fb.DispoLoading(1),a.getJSON(j.url,{date:j.date,lager_id:j.data.lager_id},function(a){e+="#495 start render calendarDayData "+(new Date).toLocaleString()+"\n";c.clear.apply(k);c.addPortlets.apply(k,[a.data]);c._trigger.apply(k,[k,"changeDate",
j.date]);e+="#499 finished building calendarDayData "+(new Date).toLocaleString()+"\n";Fb.DispoLoading(0)})}catch(g){Fb.DispoLoading(0)}}},loadDate:function(a){c.setDate.apply(this,[a])&&c.load.apply(this)},loadPrevDay:function(){var a=c.getDate.apply(this);a.setDate(a.getDate()-1);c.setDate.apply(this,[a]);c.load.apply(this)},loadNextDay:function(){var a=c.getDate.apply(this);a.setDate(a.getDate()+1);c.setDate.apply(this,[a]);c.load.apply(this)},getDate:function(){var b=a(this).data("fbDispoCalendar").date;
return b?(b=b.split("-"),"0"==b[1].charAt(0)&&(b[1]=b[1].substr(1)),"0"==b[2].charAt(0)&&(b[2]=b[2].substr(1)),new Date(b[0],b[1]-1,b[2])):new Date},setDate:function(b){var h=a(this).data("fbDispoCalendar").ID;if("object"==typeof b&&String(b.constructor).match(/\bDate\b/))a(this).data("fbDispoCalendar").date=c._getDateString(b);else if("string"==typeof b&&b.match(d))a(this).data("fbDispoCalendar").date=b;else return alert("Unzulaessiges Datum: "+typeof b+" "+b+". Erwartet Datumsobjekt oder String JJJJ-MM-TT"),
!1;b=c.getDate.apply(this);var k=a.datepicker._defaults.dayNamesShort[b.getDay()],k=k+(" "+c._getLocalString(a(this).data("fbDispoCalendar").date)),k=k+(" / "+a.datepicker.iso8601Week(b)+". KW");a("button#DispoDate"+h+" label",this).html(k);a("input#DispoDateTxt"+h+"",this).val(a(this).data("fbDispoCalendar").date);return!0},setLager:function(b){c.setData.apply(this,["lager_id",b]);a("#DispoLager").val()!=b&&a("#DispoLager").val(b)},getLager:function(){return c.getData.apply(this,["lager_id"])},_getDateString:function(a){var b=
a.getMonth()+1,c=a.getDate();10>b&&(b="0"+b.toString());10>c&&(c="0"+c.toString());return a.getFullYear()+"-"+b+"-"+c},_getLocalString:function(a){return"string"==typeof a?a.split("-").reverse().join("."):"undefined"},_trigger:function(b,d){var k=a(this).data("fbDispoCalendar"),j=a.makeArray(arguments).slice(1),e=c._getOwnEventHandlerName(d);if(e&&(e in k&&"function"==typeof k[e])&&!1===k[e].apply(b,a.makeArray(arguments).slice(2)))return!1;j[0]=c._getEventTriggerName(d);return(b==this||k.triggerChildEvents)&&
!1===a(this).trigger.apply(a(this),j)?!1:!0},_getEventTriggerName:function(a){a in g&&(a=g[a]);return a},_getOwnEventHandlerName:function(a){a="on"+a.charAt(0).toUpperCase()+a.substr(1);return a in b?a:""},_init:function(){var b=this,d=a(this),k=++e,j=a(this).data("fbDispoCalendar");j.ID=k;d.addClass("DispoCalendar fbDispoCalendar");d.append(a("<span class='DispoDateDisplay' />"));var g=a("<div class='DispoCalendarPager' />").attr("id","fbDispoCalendarPager"+k);d.append(g);var m=j.isBrowsable,n=j.isRefreshable,
t=j.isAddable,p=j.isContextSearchable,q=j.isSearchable,u=j.isSortable,r=j.isPrintable,s=j.isHidable;g.append(a("<div style='float:left;margin-left:0px'>    <span id='calendar-btn-browse"+k+"'>    <button class='collapse'>&nbsp;</button>"+(m?"<button class='browse-prev'>&nbsp;</button>":"")+"<input id='DispoDateTxt"+k+"' type='text' style='width:1px;display:none;'><button id='DispoDate"+k+"' ><label>Date</label></button>"+(m?"<button class='browse-next'>&nbsp;</button>":"")+(t?"<button id='addPortlet"+
k+"'>Neue Tour anlegen</button>":"")+(n?"<button class='browse-refresh' title='Ansicht aktualisieren'>&nbsp;</button>":"")+(r?"<button class='DispoPrint' title='Tagesdruckansicht'>&nbsp;</button>":"")+(p?"<button class='DispoEmpfehlungen' title='Passende Vorgaenge in Auswahlliste anzeigen'>&nbsp;</button>":"")+(q?"<button class='DispoSearch' title='Disponierte Vorgaenge suchen'>&nbsp;</button>":"")+(s?"<button class='DispoCalRemove' title='Diesen Tag ausblenden'>&nbsp;</button>":"")+"   </span></div>")).append("<br style='clear:both;' />");
d.append(a("<div class='DispoCalendarPortlets' />"));a("button, input:submit, a",g).button();a("button#addPortlet"+k,g).button({icons:{primary:"ui-icon-circle-plus"},text:!0});a("span#calendar-btn-view"+k+"",g).buttonset();a("span#calendar-btn-browse"+k,g).buttonset();a("button.collapse",g).button({icons:{primary:"ui-icon-minus"},text:!0});n&&a("button.browse-refresh",g).button({icons:{primary:"ui-icon-refresh"},text:!0});m&&a("button.browse-prev",g).button({icons:{primary:"ui-icon-circle-triangle-w"},
text:!0});m&&a("button.browse-next",g).button({icons:{primary:"ui-icon-circle-triangle-e"},text:!0});p&&a("button.DispoEmpfehlungen",g).button({icons:{primary:"ui-icon-note"},text:!0});q&&a("button.DispoSearch",g).button({icons:{primary:"ui-icon-search"},text:!0});r&&a("button.DispoPrint",g).button({icons:{primary:"ui-icon-print"},text:!0});s&&a("button.DispoCalRemove",g).button({icons:{primary:"ui-icon-close"},text:!0});a("button#DispoDate"+k,g).button("option","secondary","ui-icon-triangle-1-s");
a("button.collapse",this).click(function(){var d=a(this).closest("div.DispoCalendar").find("div.DispoCalendarPortlets").slideToggle();a(this).find(".ui-icon:first").toggleClass("ui-icon-minus").toggleClass("ui-icon-plus");c._trigger.apply(b,[b,d.is(":visible")?"fold":"unfold"])});u&&a("div.DispoCalendarPortlets",this).sortable({cursor:"move",handle:".sortable.handle",stop:function(d,h){c._trigger.apply(b,[b,"sortPortlet"].concat(a.makeArray(arguments)))}});m&&a("input#DispoDateTxt"+k,g).datepicker({dateFormat:"yy-mm-dd",
changeMonth:!0,showWeek:!0,firstDay:1,onSelect:function(a){c.setDate.apply(b,[a]);c.load.apply(b)}});a("select#DispoLager").bind("change",function(){c.setData.apply(b,["lager_id",a(this).val()]);c.load.apply(b)});t&&a("button#addPortlet"+k,b).click(function(){c.addPortlet.apply(b)});m&&a("button.browse-prev",b).click(function(){c.loadPrevDay.apply(b)});m&&a("button.browse-next",b).click(function(){c.loadNextDay.apply(b)});n&&a("button.browse-refresh",b).click(function(){c.load.apply(b)});s&&a("button.DispoCalRemove",
b).click(function(){a(b).remove()});m&&a("button#DispoDate"+k,b).click(function(){a("input#DispoDateTxt"+k,b).datepicker("show")});p&&a("button.DispoEmpfehlungen",g).click(function(){var d=a(b).data("fbDispoCalendar");c._trigger.apply(b,[b,"clickVorgangsEmpfehlungen",d.date])});r&&j.searchUrl&&a("button.DispoPrint",g).click(function(){var a=c._getDateString(c.getDate.apply(b)),d=c.getLager.apply(b);a&&d&&(a=Fb.AppBaseUrl+"/touren/page/printportletsday/date/"+a+"/lager_id/"+d,"undefined"!==typeof winPrint&&
(null!==winPrint&&winPrint.close&&!winPrint.closed)&&winPrint.close(),winPrint=window.open(a,"winPrint","width=800px,height=800,menubar=yes,resizable=yes,scrollbars=yes"),winPrint.focus())});q&&j.searchUrl?a("button.DispoSearch",g).click(function(){a("#DispoSearchBox").length||a('<div id="DispoSearchBox"/>').appendTo("body");var d=c.getDate.apply(b),h=a.datepicker.iso8601Week(d),e=c.getLager.apply(b),d=j.searchUrl+(-1==j.searchUrl.indexOf("?")?"?":"")+"&kw="+d.getFullYear()+"-"+h+"&lager_id="+e+"&ajax=1";
a("#DispoSearchBox").dialog({width:0.8*a("body").width()}).load(d)}):a("button.DispoSearch",g).hide();c.setLager.apply(this,[a("#DispoLager").val()]);c.setDate.apply(this,[a(this).data("fbDispoCalendar").date]);c.load.apply(this);c._trigger.apply(b,[b,"create"])},getDataKey:function(){return"fbDispoCalendar"},getData:function(){var b=a(this).data("fbDispoCalendar");return!b||!b.data?null:arguments.length?arguments[0]in b.data?b.data[arguments[0]]:null:b.data},getObjectData:function(){var b=a(this).data("fbDispoCalendar");
return!b||!b.data?null:arguments.length?arguments[0]in b?b[arguments[0]]:null:a(this).data("fbDispoCalendar")},setData:function(){a(this).data("fbDispoCalendar")||a(this).data("fbDispoCalendar",{});a(this).data("fbDispoCalendar").data||(a(this).data("fbDispoCalendar").data={});1==arguments.length?a(this).data("fbDispoCalendar").data=arguments[0]:2<=arguments.length&&(a(this).data("fbDispoCalendar").data[arguments[0]]=arguments[1])}};a.fn.fbDispoCalendar=function(d){var h=arguments,e=arguments.length,
j=new Date,g=j.getMonth()+1;10>g&&(g="0"+g);var m=j.getDate();10>m&&(m="0"+m);b.date=j.getFullYear()+"-"+g+"-"+m;if("string"==typeof d&&this.length)switch(d){case "options":if(1==e)return a(this[0]).data("fbDispoCalendar");break;case "option":if(2==e)return j=a(this[0]).data("fbDispoCalendar"),"undefined"!=typeof j[h[1]]?j[h[1]]:null;break;default:if("function"==typeof c[d]&&("_trigger"==d||"get"==d.substr(0,3)))return c[d].apply(this[0],1<e?a.makeArray(h).slice(1):null)}return this.each(function(){var j=
!1,g={};a(this).data("fbDispoCalendar")||(g=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.calendar?a.extend({},b,Fb.DispoCalendarSettings.calendar):b,d?"object"==typeof d?a(this).data("fbDispoCalendar",a.extend({},g,d)):a(this).data("fbDispoCalendar",a.extend({},g)):a(this).data("fbDispoCalendar",a.extend({},g)),j=!0);g=a(this).data("fbDispoCalendar");if("string"==typeof d)switch(d){case "options":1<e&&(g=a.extend({},g,h[1]),a(this).data("fbDispoCalendar",g));break;case "option":2<e&&(g[h[1]]=
h[2],a(this).data("fbDispoCalendar",g));break;default:"function"==typeof c[d]&&c[d].apply(this,1<e?a.makeArray(h).slice(1):null)}j&&c._init.apply(this);return this})}})(jQuery);(function(a){var g=0,e={create:"createPortlet",remove:"removePortlet",fold:"foldPortlet",unfold:"unfoldPortlet",print:"printPortlet",updateTitle:"updatePortletTitle"},d={data:{},date:null,_parent:null,_parentJqFunction:null,isEditable:!0,isSortable:!0,isRemovable:!0,isPrintable:!0,isAddable:!0,isDroppable:!0,onCreate:null,onRemove:null,onPrint:null,onCreateTimeline:null,onRemoveTimeline:null,onSortTimeline:null,onDropTimeline:null,onFold:null,onUnfold:null},b={_init:function(){var c=this,d=a(c),h=
d.data("fbDispoPortlet");null===h.data&&(h.data={});g++;d.addClass("fbDispoPortlet portlet-content num-"+g).wrap('<div class="portlet ui-widget-header ui-corner-all" />').before('<div class="portlet-header ui-corner-all"><span class="ui-icon-set"/><span class="portlet-header-title">Routen-Schienen</span></div>');d.closest("div.portlet").find("div.portlet-header").addClass("ui-corner-all").end();var e=h.isEditable,j=h.isEditable||h.isPrintable,l=a("div.portlet-header span.ui-icon-set",d.closest("div.portlet"));
l.append("<span class='ui-icon collapse ui-icon-triangle-1-s'></span>");e&&h.isSortable&&l.append("<span class='ui-icon sortable ui-icon-arrow-4 handle'></span>");e&&h.isAddable&&l.append("<span class='ui-icon addTrack ui-icon-plus'></span>");e&&h.isRemovable&&l.append("<span class='ui-icon rmPortlet ui-icon-trash'></span>");j&&l.append("<span class='ui-icon prPortlet ui-icon-print'></span>");d=a("div.portlet-content",d.closest("div.portlet"));d;e&&(h.isSortable&&d.sortable({cursor:"move",handle:".DropZone-Sort",
connectWith:".portlet-content",stop:function(a,d){var f=d.item.parent().get(0);c==d.item.parent().get(0)?b._trigger.apply(c,[c,"sortTimeline",a,d]):b._trigger.apply(f,[f,"moveTimeline",a,d,d.item.parent()])}}),h.isDroppable&&d.droppable({accept:".DropZone-Route",drop:function(d,f){f.draggable.appendTo(a(this)).css({position:"relative",top:0,left:0,width:"100%"});Fb.DndHelpers.droppable.drop.apply(this,arguments);b._trigger.apply(c,[c,"dropTimeline",d,f])}}),h.isAddable&&l.find("span.addTrack").click(function(){b.addTimeline.apply(c)}),
h.isRemovable&&l.find("span.rmPortlet").click(function(){b.destroy.apply(c)}));j&&l.find("span.prPortlet").click(function(){b._trigger.apply(c,[c,"print"])});l.find("span.collapse").click(function(){var d="string"===typeof a(this).attr("class")?a(this).attr("class"):"";a(this).toggleClass("ui-icon-triangle-1-e").toggleClass("ui-icon-triangle-1-s");a(this).parents("div.portlet:first").find("div.portlet-content:first").slideToggle();b._trigger.apply(c,[c,d.match(/\bui-icon-triangle-1-e\b/)?"fold":"unfold"])});
b._trigger.apply(c,[c,"create"]);a(this).data("fbDispoPortlet");"timelines"in a(this).data("fbDispoPortlet").data?(b.addTimelines.apply(c,[a(this).data("fbDispoPortlet").data.timelines]),delete a(this).data("fbDispoPortlet").data.timelines):b.addTimeline.apply(c)},destroy:function(){if(!1===b._trigger.apply(this,[this,"remove"]))return!1;a(this).parent().is(".portlet")?a(this).parent().remove():a(this).remove()},addTimelines:function(a){for(var d in a)b.addTimeline.apply(this,[a[d]])},addTimeline:function(b){var d=
a(this).data("fbDispoPortlet"),h=a(this);if("undefined"==typeof b||null===b)b={};b.portlet_id=d.data.id;b.date=d.date;var e=a("<div />");h.append(e);e.fbDispoTimelineDropzone({date:d.date,data:b,_parent:h,_parentJqFunction:"fbDispoPortlet"})},getDataKey:function(){return"fbDispoPortlet"},getData:function(){var b=a(this).data("fbDispoPortlet");return"undefined"===typeof b||"object"!==typeof b||!("data"in b)?null:arguments.length?arguments[0]in b.data?b.data[arguments[0]]:null:b.data},getTitle:function(){return a("span.portlet-header-title",
a(this).closest("div.portlet")).html()},setData:function(){1==arguments.length?a(this).data("fbDispoPortlet").data=arguments[0]:2<=arguments.length&&(a(this).data("fbDispoPortlet").data[arguments[0]]=arguments[1])},setTitle:function(c){var d=this;a("span.portlet-header-title",a(this).closest("div.portlet")).html(c).unbind("click").bind("click",function(){var c=a(this).find("span.p-title"),e=c.text(),j=prompt("Titel bearbeiten",e);"string"==typeof j&&j!==e&&(!1!==b._trigger.apply(d,[d,"updateTitle",
j])?c.text(j):console.log("trying update title returns false!"))})},clear:function(){a(".DropZone.DropZone-Route",this).remove();b._trigger.apply(this,array(this,"clearDispoPortlet"))},load:function(c){a(this).data("fbDispoPortlet").data=c.data;b.clear.apply(this);c.options&&a.fn.fbDispoPortlet.apply(this,["options",c.options]);if(c.timelines){for(var d=0;d<c.timelines.length;++d)b.addTimeline.apply(this,["load",c.timelines[d]]);b._trigger.apply(this,array(this,"loadDispoPortlet"))}},_trigger:function(c,
d){var h=a(this).data("fbDispoPortlet"),e=b._getEventTriggerName(d),j=b._getOwnEventHandlerName(d),g=a.makeArray(arguments).slice(1),m=null;if(j&&(j in h&&"function"==typeof h[j])&&!1===h[j].apply(c,g.slice(1)))return!1;g[0]=e;return c==this&&!1===a(this).trigger.apply(a(this),g)||h._parent&&h._parentJqFunction&&(g.unshift(c),g.unshift("_trigger"),m=h._parent[h._parentJqFunction].apply(h._parent,g),!1===m)?!1:!0},_getEventTriggerName:function(a){a in e&&(a=e[a]);return a},_getOwnEventHandlerName:function(a){a=
"on"+a.charAt(0).toUpperCase()+a.substr(1);return a in d?a:""}};a.fn.fbDispoPortlet=function(c){var f=arguments,h=arguments.length;if("string"==typeof c&&this.length)switch(c){case "options":if(1==h)return a(this[0]).data("fbDispoPortlet");break;case "option":if(2==h){var e=a(this[0]).data("fbDispoPortlet");return"undefined"!=typeof e[f[1]]?e[f[1]]:null}break;default:if("function"==typeof b[c]&&("_trigger"==c||"get"==c.substr(0,3)))return b[c].apply(this[0],a.makeArray(f).slice(1))}return this.each(function(){var e=
!1,g={};a(this).data("fbDispoPortlet")||(g=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.portlet?a.extend({},d,Fb.DispoCalendarSettings.portlet):d,c?"object"==typeof c?a(this).data("fbDispoPortlet",a.extend({},g,c)):a(this).data("fbDispoPortlet",a.extend({},g)):a(this).data("fbDispoPortlet",a.extend({},g)),e=!0);var g=a(this).data("fbDispoPortlet"),k=g.data;if(k&&"object"===typeof k&&"settings"in k&&k.settings){for(var n in k.settings)g[n]=k.settings[n];delete k.settings}if("string"==typeof c)switch(c){case "options":1<
h&&(g=a.extend({},g,f[1]),a(this).data("fbDispoPortlet",g));break;case "option":2<h&&(g[f[1]]=f[2],a(this).data("fbDispoPortlet",g));break;default:"function"==typeof b[c]&&b[c].apply(this,a.makeArray(f).slice(1))}e&&b._init.apply(this)})}})(jQuery);(function(a){var g={create:"createResource",drop:"dropResource",move:"moveResource",remove:"removeResource"},e={data:{},resourceType:"Rsrc",isDraggable:!0,isRemovable:!0,onCreate:null,onRemove:null,_parent:null,_parentJqFunction:null,draggableOptions:null},d={_init:function(){var b=a(this),c=b.data("fbDispoResource");"function"==typeof c.data.ondrop&&(c.data.ondrop(),delete c.data.ondrop);var d="resourceType"in c.data?c.data.resourceType:c.resourceType||"",e="id"in c.data?c.data.id:c.id||"",g="fbDispoResource_"+
d+""+e;b.addClass("fbDispoResource Drag-Rsrc RsrcType-"+d);b.attr({id:g,"data-type":d,"data-id":e});c.isDraggable&&(c.draggableOptions=a.extend({},Fb.DragRsrcTemplateSettings),b.is(".is-default-resource")&&(c.draggableOptions={helper:function(){var b=a(this).clone().appendTo("body").css("zIndex",3E3);b.data("fbDispoResource",a(this).data("fbDispoResource"));b.data("dragdata",a(this).data("fbDispoResource").data);b.data("dragdata").sourceElement=this;return b},appendTo:"body",scroll:!0,scrollSensitivity:50,
start:function(){}}),b.draggable(a.extend({},c.draggableOptions,{appendTo:"body"})));c&&"function"==typeof c.onCreate&&c.onCreate.apply(this)},destroy:function(){var b=a(this).data("fbDispoResource").data;!1!==d._trigger.apply(this,[this,"remove",b])&&(b=a(this).parent("li"),b.length?b.remove():a(this).remove())},doAnything:function(){a(this).data("fbDispoResource")},getDroppableOptions:function(){return a(this).droppable.call(arguments)},getDataKey:function(){return"fbDispoResource"},getData:function(){var b=
a(this).data("fbDispoResource");return arguments.length?arguments[0]in b.data?b.data[arguments[0]]:null:b&&b.data?b.data:null},setData:function(){1==arguments.length?a(this).data("fbDispoResource").data=arguments[0]:2<=arguments.length&&(a(this).data("fbDispoResource").data[arguments[0]]=arguments[1])},reInitData:function(){var b=a(this).data("fbDispoResource");if(b._parent&&b._parentJqFunction){var c=b._parent;b.data.route_id=c[b._parentJqFunction].apply(c,["getData","id"])}},load:function(b){a(this).data("fbDispoResource").data=
b.data;b.options&&a.fn.fbDispoResource.apply(this,["options",b.options])},_moved:function(b,c){var f=c&&c.draggable?c.draggable:null,e=f&&f.data("fbDispoResource")&&f.data("fbDispoResource")._parent?f.data("fbDispoResource")._parent:null;d.reInitData.apply(this);if(!1===d._trigger.apply(this,[this,"move",e,b,c]))return alert("#151 fbDispoResource triggered event move returns false"),!1;if(c&&c.helper&&a(c.helper).length)return a(c.helper).remove(),!0;if((f=a(this).data("fbDispoResource"))&&f._parent&&
f._parentJqFunction){var g=f._parent,e=f._parentJqFunction;f.data.route_id=g[e].apply(g,["getData","id"]);if((f=c&&c.draggable?c.draggable:null)&&f.data("fbDispoResource")&&f.data("fbDispoResource")._parent)c.draggable.data("fbDispoResource")._parent[e]("getData","id")}},_dropped:function(){d.reInitData.apply(this);!1===d._trigger.apply(this,[this,"drop"])&&a(this).closest("li").remove()},_trigger:function(b,c){var f=a(this).data("fbDispoResource"),e=d._getEventTriggerName(c),g=d._getOwnEventHandlerName(c),
j=a.makeArray(arguments).slice(1);g&&(g in f&&"function"==typeof f[g])&&f[g].apply(b,j.slice(1));j[0]=e;b==this&&a(this).trigger.apply(a(this),j);f._parent&&f._parentJqFunction&&(j.unshift(b),j.unshift("_trigger"),f._parent[f._parentJqFunction].apply(f._parent,j))},_getEventTriggerName:function(a){a in g&&(a=g[a]);return a},_getOwnEventHandlerName:function(a){a="on"+a.charAt(0).toUpperCase()+a.substr(1);return a in e?a:""}};a.fn.fbDispoResource=function(b){var c=arguments,f=arguments.length;if("string"==
typeof b&&this.length)switch(b){case "options":if(1==f)return a(this[0]).data("fbDispoResource");break;case "option":if(2==f){var h=a(this[0]).data("fbDispoResource");return"undefined"!=typeof h[c[1]]?h[c[1]]:null}break;default:if("function"==typeof d[b]&&"get"==b.substr(0,3))return d[b].apply(this[0],1<f?a.makeArray(c).slice(1):null)}return this.each(function(){var h=!1,g={};a(this).data("fbDispoResource")||(g=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.resource?a.extend({},e,Fb.DispoCalendarSettings.resource):
e,b?"object"==typeof b?a(this).data("fbDispoResource",a.extend({},g,b)):a(this).data("fbDispoResource",a.extend({},g)):a(this).data("fbDispoResource",a.extend({},g)),h=!0);g=a(this).data("fbDispoResource");if("string"==typeof b)switch(b){case "options":1<f&&(g=a.extend({},g,c[1]),a(this).data("fbDispoResource",g));break;case "option":2<f&&(g[c[1]]=c[2],a(this).data("fbDispoResource",g));break;default:"function"==typeof d[b]&&d[b].apply(this,1<f?a.makeArray(c).slice(1):null)}h&&d._init.apply(this)})}})(jQuery);(function(a){var g={create:"createRoute",add:"addRoute",remove:"removeRoute",drop:"dropRoute",move:"moveRoute",resize:"resizeRoute",select:"selectRoute",setFarbklasse:"setTourFarbklasse",changeData:"changeRouteData",hoverDetails:"hoverRouteDetails",showDetails:"showRouteDetails",hideDetails:"hideRouteDetails"},e={data:null,dataUrl:"",rsrcUrl:"",isEditable:!0,isDroppable:!0,isDraggable:!0,isResizable:!0,isRemovable:!0,timeStart:0,timeDuration:0,test:0,_parent:null,_parentJqFunction:null,onAdd:null,
onRemove:null,onSelect:null,onDrop:null,onMove:null,onResize:null,onShowDetails:null,onhideDetails:null,onDropResource:null,onMoveResource:null,route:null,draggableOptions:Fb.DragRouteInstanceSettings,droppableOptions:Fb.DropRsrcOnRouteSettings,resizableOptions:Fb.RouteResizableSettings},d={_init:function(){var b=a(this),c=b.data("fbDispoRoute");null===c.data&&(c.data={});!b.attr("id")&&"id"in c.data&&b.attr("id","fbDispoRoute_"+c.data.id);(!b.attr("class")||!b.attr("class").match(/\bDrag-Route\b/))&&
b.addClass("Drag-Route");b.removeClass("fbDispoRoute").addClass("fbDispoRoute");c.isDraggable&&b.draggable(c.draggableOptions);c.isDroppable&&b.droppable(c.droppableOptions);c.isResizable&&b.resizable(c.resizableOptions);b.addClass("ui-corner-tr ui-corner-bottom").append(a("<div class='resourcesStat' />")).append(a('<ul class="resources" />'));b.data("dragdata")&&a.extend(c.data,b.data("dragdata"));c.isDraggable&&(d._mkRouteDroppableOnClick.apply(this),b.bind("drop",function(){}));d.reInitData.apply(this);
d.initHandler.apply(this);d.setTimeSlot.apply(this);a(this).data("fbDispoRoute").data.farbklasse&&d.renderFarbklasse.apply(this);d._trigger.apply(this,[this,"create"]);if(!a(this).data("fbDispoRoute"))throw"#95 fbDispoRoute._init: Falsches Objekt! Erwartet: fbDispoRoute; Erhalten:"+a(this).attr("class");a(this).data("fbDispoRoute").data.resources&&(d.addResources.apply(this,[a(this).data("fbDispoRoute").data.resources]),delete a(this).data("fbDispoRoute").data.resources);d._trigger.apply(this,[this,
"changeData"])},initHandler:function(){var b=this,c=a(this),f=c.data("fbDispoRoute");null===f.data&&(f.data={});var e={position:"absolute",display:"block",right:0,top:0,width:"15px",height:"15px",background:"#fff"},g=!f.data.DirektLieferInfo&&!f.data.LieferterminHinweisText?"ui-icon-info":"ui-icon-alert";c.append(a("<div/>").css(e).addClass("ui-corner-all").append(a("<span/>").addClass("ui-icon "+g)).hover(function(){var c=this;a(this).addClass("ui-state-hover").data("MouseIsOver",!0);setTimeout(function(){a(c).data("MouseIsOver")&&
d._trigger.apply(b,[b,"hoverDetails",c])},650)},function(){a(this).removeClass("ui-state-hover").data("MouseIsOver",!1)}).click(function(){Fb.showRouteDetails(b)}));c.hover(function(){c.addClass("ui-state-hover").data("MouseIsOver",!0);setTimeout(function(){c.data("MouseIsOver")&&d._trigger.apply(b,[b,"hoverRoute",b])},650)},function(){c.removeClass("ui-state-hover").data("MouseIsOver",!1);d._trigger.apply(b,[b,"leaveRoute",b])}).bind("click",function(){var c=a.makeArray(arguments);c.unshift(b,"clickRoute",
b);d._trigger.apply(b,c)}).bind("dblclick",function(){Fb.showRouteDetails(b)});c.bind("mouseleave",function(){d._trigger.apply(b,[b,"leaveRouteDetails",b])});f.isEditable&&f.isRemovable&&c.append(a("<div/>").css(e).css({top:"17px"}).addClass("ui-corner-all").append(a("<span/>").addClass("ui-icon ui-icon-trash")).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).click(function(){d.destroy.apply(b)}));1==f.data.avisiert&&c.append(a("<div/>").text("A").attr("title",
"Avisiert: "+(1==f.data.avisiert?"Ja":"Nein")).css(e).css({top:"34px",right:"15px",textAlign:"center",fontSize:"10px"}).addClass("ui-corner-all ui-state-hover"));c.bind("showDetails",function(a,b){d._trigger.apply(this,[this,"showDetails",b])});c.bind("hideDetails",function(){d._trigger.apply(this,[this,"hideDetails"])});f.isEditable&&(a(this).bind("resource-dropped",d.addDroppedResource),a(this).bind("resource-moved",d.addDroppedResource));var j=[];"allowedColors"in Fb.DispoCalendarSettings.route&&
Fb.DispoCalendarSettings.route.allowedColors.length&&(j=Fb.DispoCalendarSettings.route.allowedColors);j.length&&c.append(a("<div/>").css(e).css("top","34px").addClass("ui-corner-all").append(a("<span/>").addClass("ui-icon ui-icon-tag")).click(function(){var c=a(this),f=["schliessen",""].concat(j),e=function(c){"schliessen"!==c&&d.setFarbklasse.apply(b,[c]);a(this).parent().remove()},c=a("<div/>").css({border:"1px solid #aaa",zIndex:1,backgroundColor:"#fff",position:"absolute",top:c.offset().top+c.outerHeight(),
left:c.offset().left}).appendTo("body"),g;for(g in f){var h=f[g],k="Keine Farbe";"Gruen"==h?k="VIP":"Gelb"==h?k="Anker":"Blau"==h?k="F\u00fcll":"Weiss"==h?k="Projekt":"Rot"==h?k="Specials":h&&(k=h);k=a("<span/>").addClass("color-pick-item fk-"+h).attr("title",k).css("cursor","pointer");"schliessen"==h&&k.text("x").css({textAlign:"center",color:"#888",fontSize:"10px",lineHeight:"100%",display:"block","float":"left",margin:"1px 0 0 0"});k.click(e.bind(k,h)).appendTo(c)}}))},addDroppedResource:function(b,
c,f){var e=a(c).fbDispoResource("options"),e={_parent:a(this),_parentJqFunction:"fbDispoRoute",_parentFrom:e&&"_parent"in e?e._parent:null,data:f.helper.data("dragdata")};c!==f.draggable?(c.fbDispoResource(e),c.fbDispoResource("_dropped",b,f)):(c.fbDispoResource("options",e),c.fbDispoResource("_moved",b,f));d.sortResources.apply(this);d.refreshResourcesStat.apply(this)},sortResources:function(){return 0},setResourcesUrl:function(b){a(this).data("fbDispoRoute").rsrcUrl=b},getResourcesUrl:function(){var b=
a(this).data("fbDispoRoute");if(b.rsrcUrl)return b.rsrcUrl;var c=a(this).closest("div.fbDispoCalendar").fbDispoCalendar("getObjectData","resourcesUrlTpl");return c.match(/{#ROUTEID}/)?c.replace(/{#ROUTEID}/,b.data.id):c+b.data.id},initResourceUrl:function(){var b=a(this).data("fbDispoRoute");b.rsrcUrl||(b.rsrcUrl=d.getResourcesUrl.apply(this));return b.rsrcUrl},getDataUrl:function(){var b=a(this).data("fbDispoRoute");if(b.rsrcUrl)return b.rsrcUrl;var c=a(this).closest("div.fbDispoCalendar").fbDispoCalendar("getObjectData",
"routeUrlTpl");return c.match(/{#ROUTEID}/)?c.replace(/{#ROUTEID}/,b.data.id):c+b.data.id},reloadResources:function(){var b=a(this).data("fbDispoRoute");b.rsrcUrl||d.initResourceUrl.apply(this);var c=null;b.rsrcUrl?a.ajax({type:"GET",dataType:"json",async:!1,data:{id:b.data.id},url:b.rsrcUrl,success:function(a){c=a.data},error:function(a,b,c){alert("#240 Reload-Resource-Error: a:"+a+"; b:"+b+"; c:"+c)}}):alert("#247 fbDispoRoute.reloadResourcesFromUrl Error missing rsrcUrl!");d.reloadResourcesByData.apply(this,
[c])},reloadResourcesByData:function(b){var c=a(this);a("ul.resources li",c).remove();b&&("object"==typeof b&&b.length)&&d.addResources.apply(this,[b]);d.refreshResourcesStat.apply(this)},refreshResourcesStat:function(){a(".resourcesStat",a(this)).html("");var b=[];a("ul.resources .fbDispoResource",a(this)).each(function(){var c=("string"===typeof a(this).attr("class")?a(this).attr("class"):"").match(/\bRsrcType-([^ ]*)/),c=c?c[1]:"Rsrc";c in b?++b[c]:b[c]=1});for(var c in b)a(".resourcesStat",a(this)).append(a("<span rel='"+
c+"' style='margin-right:5px;'>"+c+" "+b[c]+"</span> &nbsp;"))},addResources:function(a){for(var c in a)d.addResource.apply(this,[a[c]]);d._trigger.apply(this,[this,"loadResources"]);d.refreshResourcesStat.apply(this)},addResource:function(b){var c=a(this);b||(b={});var d=a("<div />").text(b.name);a("ul.resources:first",c).append(a("<li/>").append(d));if(!d||!d.length)return alert("Unbekannter Systemfehler: Eine Ressource konnte nicht zur Tour hinzugefuegt werden!"),!1;a.fn.fbDispoResource.apply(d,
[{data:b,_parent:a(this),_parentJqFunction:"fbDispoRoute"}])},getPortlet:function(){return a(this).closest("div.fbDispoPortlet")},getTimeline:function(){return a(this).closest("div.fbDispoTimelineDropzone")},getResources:function(){return a("ul.resources li .Drag-Rsrc",a(this))},getRoutes:function(){var b=a(this).data("fbDispoRoute");return b&&b._parent?a("div.fbDispoRoute,div.fbDispoRouteDefaults",b._parent):a()},setFarbklasse:function(b){a(this).data("fbDispoRoute").data.farbklasse=b;d._trigger.apply(this,
[this,"setFarbklasse",b])&&d.renderFarbklasse.apply(this)},renderFarbklasse:function(){for(var b=a(this).data("fbDispoRoute"),c=this.className.split(" "),d=[],e=0;e<c.length;e++){var g=c[e];"fk-"!==g.substr(0,3)&&d.push(g)}b.data.farbklasse&&d.push("fk-"+b.data.farbklasse);this.className=d.join(" ")},setTimeSlot:function(b){var c=a(this),d=c.data("fbDispoRoute");c.data("route")||c.data("route",{});c=c.data("route");b&&b.from&&(d.data.ZeitVon=b.from);b&&b.to&&(d.data.ZeitBis=b.to);b=a(d._parent).fbDispoTimelineDropzone("getTimelineLineal");
b=a(b).data("fbDispoTimelineLineal").settings;c.start=a.timeToMinutes(d.data.ZeitVon);c.end=a.timeToMinutes(d.data.ZeitBis);c.duration=c.end-c.start;c.duration<b._stepWidthM&&(c.duration=b._stepWidthM);this.style.left=100*(c.start-b._startM)/b._totalM+"%";this.style.width=100*c.duration/b._totalM+"%"},_moved:function(){if(!1===d._trigger.apply(this,[this,"move"])){try{var b=a(this).data("fbDispoRoute"),c=a(this).data("draggable");c&&(c._src&&c._src.parent&&b&&b._parent)&&c._src.parent.get(0)!=b._parent.get(0)&&
(a(this).appendTo(c._src.parent),b._parent=c._src.parent)}catch(f){alert(f)}d.setTimeSlot.apply(this);return!1}},_resized:function(){var b=a(this),c=b.data("route");if(!c)return!1;b=b.data("fbDispoRoute");b.timeStart=c.start;b.timeEnd=c.end;b.timeDuration=c.duration;if(!1===d._trigger.apply(this,[this,"resize"]))return d.setTimeSlot.apply(this),!1},_dropped:function(){d.reInitData.apply(this);if(!1===d._trigger.apply(this,[this,"drop"]))return!1},reInitData:function(){var b=a(this).data("fbDispoRoute");
null===b.data&&(b.data={});if(b._parent&&b._parentJqFunction){var c=b._parent,d=b._parentJqFunction;b.data.timeline_id=c[d].apply(c,["getData","id"]);b.date=c[d].apply(c,["option","date"]);b.data.DatumVon=c[d].apply(c,["option","date"]);b.data.DatumBis=c[d].apply(c,["option","date"])}},draggable:function(){a(this).draggable.call(arguments)},droppable:function(){a(this).droppable.call(arguments)},resizable:function(){a(this).resizable.call(arguments)},getDraggableOptions:function(){return a(this).draggable.call(arguments)},
getDroppableOptions:function(){return a(this).droppable.call(arguments)},getResizableOptions:function(){return a(this).resizable.call(arguments)},destroy:function(){!0===d._trigger.apply(this,[this,"remove"])&&(a(this).removeData("fbDispoRoute"),a(this).remove())},_mkDroppable:function(){if("string"!==typeof a(this).attr("class")||!a(this).attr("class").match(/\bDragRoute-Focus\b/))a("div.Drag-Route").removeClass("DragRoute-Focus"),a(this).addClass("DragRoute-Focus"),a("div.Drag-Route:not(.DragRoute-Focus)").droppable("option",
"accept","none"),a("div.Drag-Route.DragRoute-Focus").droppable("option","accept",".Drag-Rsrc"),Fb.Dnd.droppable_route=a(this),d._trigger.apply(this,[this,"select"].concat(a.makeArray(arguments)))},_mkRouteDroppableOnClick:function(){a(this).bind("click",d._mkDroppable)},getDataKey:function(){return"fbDispoRoute"},getData:function(){if("object"!=typeof a(this).data("fbDispoRoute"))return null;var b=a(this).data("fbDispoRoute");null==b.data&&(b.data={});return arguments.length?arguments[0]in b.data?
b.data[arguments[0]]:null:b.data},setData:function(){var b=a(this).data("fbDispoRoute");if(null===b.data||"undefined"==typeof b.data)b.data={};1==arguments.length?b.data=arguments[0]:2<=arguments.length&&(b.data[arguments[0]]=arguments[1]);d._trigger.apply(this,[this,"changeData"])},setTitle:function(b){a(this).find("span.title").html(b)},clear:function(){a(".Drag-Route",this).remove()},load:function(b){a(this).data("fbDispoRoute").data=b.data;d.clear.apply(this);b.options&&a.fn.fbDispoRoute.apply(this,
["options",b.options]);if(b.resources)for(var c=0;c<b.resources.length;++c)d.addResource.apply(this,["load",b.resources[c]])},_trigger:function(b,c){var f=a(this).data("fbDispoRoute"),e=d._getEventTriggerName(c),g=d._getOwnEventHandlerName(c),j=a.makeArray(arguments).slice(1);if(d["_"+g]&&!1===d["_"+g].apply(this,arguments)||g&&(g in f&&"function"==typeof f[g])&&!1===f[g].apply(b,j.slice(1)))return!1;j[0]=e;return b==this&&!1===a(this).trigger.apply(a(this),j)||f._parent&&f._parentJqFunction&&(j.unshift(b),
j.unshift("_trigger"),!1===f._parent[f._parentJqFunction].apply(f._parent,j))?!1:!0},_getEventTriggerName:function(a){a in g&&(a=g[a]);return a},_getOwnEventHandlerName:function(a){a="on"+a.charAt(0).toUpperCase()+a.substr(1);return a in e?a:""},_onDropResource:function(b,c,d){b=a(this).data("fbDispoRoute");c=a(this);a(d).fbDispoResource({data:{route_id:b.data.id},_parent:c,_parentJqFunction:"fbDispoRoute"})},_onMoveResource:function(b,c,d,e,g){b=a(this).data("fbDispoRoute");c=a(this);a(g).fbDispoResource({data:{route_id:b.data.id},
_parent:c,_parentJqFunction:"fbDispoRoute"})}};a.fn.fbDispoRoute=function(b){var c=arguments,f=arguments.length;if("string"==typeof b&&this.length)switch(b){case "options":if(1==f)return a(this[0]).data("fbDispoRoute");break;case "option":if(2==f){var g=a(this[0]).data("fbDispoRoute");return"object"==typeof g&&"undefined"!=typeof g[c[1]]?g[c[1]]:null}break;default:if("function"==typeof d[b]&&("_trigger"==b||"get"==b.substr(0,3)))return!a(this[0]).data("fbDispoRoute")?null:d[b].apply(this[0],1<f?a.makeArray(c).slice(1):
[])}return this.each(function(){var g=!1,h={};a(this).data("fbDispoRoute")||(h=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.route?a.extend({},e,Fb.DispoCalendarSettings.route):e,a.extend({},a(this).data("fbDispoRoute")),b?"object"==typeof b?a(this).data("fbDispoRoute",a.extend({},h,b)):a(this).data("fbDispoRoute",a.extend({},h)):a(this).data("fbDispoRoute",a.extend({},h)),a.extend({},a(this).data("fbDispoRoute")),g=!0);var h=a(this).data("fbDispoRoute"),l=h.data;if(l&&"object"===typeof l&&"settings"in
l&&l.settings)for(var m in l.settings);if("string"==typeof b)switch(b){case "options":1<f&&(h=a.extend({},h,c[1]),a(this).data("fbDispoRoute",h));break;case "option":2<f&&(h[c[1]]=c[2],a(this).data("fbDispoRoute",h));break;default:"function"==typeof d[b]&&d[b].apply(this,1<f?a.makeArray(c).slice(1):null)}g&&d._init.apply(this)})};a.fn.fbDispoRoute.getMethods=function(){return d};a.fn.fbDispoRoute.getDefaults=function(){return e};a.fn.fbDispoRoute.getRouteById=function(b){return a("#fbDispoRoute_"+
b)}})(jQuery);(function(a){var g={create:"createRouteDefaults",add:"addRouteDefaults",remove:"removeRouteDefaults",drop:"dropRouteDefaults",move:"moveRouteDefaults",resize:"resizeRouteDefaults",select:"selectRouteDefaults",hover:"hoverRouteDefaults",leave:"leaveRouteDefaults",hoverDetails:"hoverRouteDetails",showDetails:"showRouteDefaultsDetails",hideDetails:"hideRouteDefaultsDetails",dropResource:"dropResourceDefaults",moveResource:"moveResourceDefaults",removeResource:"removeResourceDefaults"},e={data:null,dataUrl:"",
timeStart:0,timeDuration:0,test:0,_parent:null,_parentJqFunction:null,isDroppable:!0,onAdd:null,onRemove:null,onSelect:null,onDrop:null,onMove:null,onResize:null,onHover:null,onLeave:null,onShowDetails:null,onhideDetails:null,onDropResource:null,onMoveResource:null,draggableOptions:Fb.DragRouteInstanceSettings,droppableOptions:Fb.DropRsrcOnRouteSettings},d={_init:function(){var b=a(this),c=b.data("fbDispoRouteDefaults");null===c.data&&(c.data={});!b.attr("id")&&"id"in c.data&&b.attr("id","fbDispoRouteDefaults_"+
c.data.id);c._parent||(c._parent=b.closest("div.fbDispoTimelineDropzone"),c._parentJqFunction="fbDispoTimelineDropzone");b.addClass("DropZoneDefaults Drag-Route fbDispoRouteDefaults").addClass("ui-state-default").droppable(a.extend({},Fb.DropRsrcOnRouteSettings,{accept:Fb.DropRsrcOnRouteSettings.accept+",.is-default-resource"})).bind("RsrcDropped",function(){alert("Resource dropped on Resource-Defaults!")}).append(a("<div class='resourcesStat' />").css({display:"inline"})).append(a("<ul class='resources' />").css({display:"inline"}));
b.data("dragdata")&&a.extend(c.data,b.data("dragdata"));c.isDroppable&&(d._mkRouteDroppableOnClick.apply(this),b.bind("drop",function(){}));d.reInitData.apply(this);d.initHandler.apply(this);d._trigger.apply(this,[this,"create"]);a(this).data("fbDispoRouteDefaults").data.resources&&(d.addResources.apply(this,[a(this).data("fbDispoRouteDefaults").data.resources]),delete a(this).data("fbDispoRouteDefaults").data.resources);a(this).show()},initHandler:function(){var b=this,c=a(this);c.hover(function(){c.data("MouseIsOver",
!0)},function(){c.data("MouseIsOver",!1);d._trigger.apply(b,[b,"leave",b])}).bind("dblclick",function(){Fb.showRouteDetails(c,{pages:{Resources:"Ressourcen",Options:"Einstellungen",Historie:"Historie"}})});c.bind("mouseleave",function(){d._trigger.apply(b,[b,"leave",b])});c.append(a("<div/>").css({position:"absolute",display:"block",left:0,top:0,width:"15px",height:"15px",background:"#fff"}).addClass("ui-corner-all").append(a("<span/>").addClass("ui-icon ui-icon-info")).hover(function(){a(this).addClass("ui-state-hover");
c.data("MouseIsOver",!0);setTimeout(function(){c.data("MouseIsOver")&&d._trigger.apply(b,[b,"hover",b])},1E3)},function(){a(this).removeClass("ui-state-hover")}).click(function(){Fb.showRouteDetails(c,{pages:{Resources:"Ressourcen",Options:"Einstellungen",Historie:"Historie"}})}));c.bind("showDetails",function(a,b){d._trigger.apply(this,[this,"showDetails",b])});c.bind("hideDetails",function(){d._trigger.apply(this,[this,"hideDetails"])});a(this).bind("resource-dropped",d.addDroppedResource);a(this).bind("resource-moved",
d.addDroppedResource)},resfresh:function(b){var c=a(this);d.setData.apply(this,[b]);b=c.data("fbDispoRouteDefaults");d.reInitData.apply(this);d.initHandler.apply(this);a("ul.resources li").remove();b.data.resources&&(d.addResources.apply(this,[b.data.resources]),delete b.data.resources);d._trigger.apply(this,[this,"reload"])},sortResources:function(){},getResourcesUrl:function(){var b=a(this).data("fbDispoRouteDefaults");if(b.rsrcUrl)return b.rsrcUrl;var c=a(this).closest("div.fbDispoCalendar").fbDispoCalendar("getObjectData",
"resourcesUrlTpl");return c.match(/{#ROUTEID}/)?c.replace(/{#ROUTEID}/,b.data.id):c+b.data.id},initResourceUrl:function(){var b=a(this).data("fbDispoRouteDefaults");b.rsrcUrl||(b.rsrcUrl=d.getResourcesUrl.apply(this));return b.rsrcUrl},getDataUrl:function(){var b=a(this).data("fbDispoRouteDefaults");if(b.rsrcUrl)return b.rsrcUrl;var c=a(this).closest("div.fbDispoCalendar").fbDispoCalendar("getObjectData","routeUrlTpl");return c.match(/{#ROUTEID}/)?c.replace(/{#ROUTEID}/,b.data.id):c+b.data.id},reloadResources:function(){var b=
a(this).data("fbDispoRouteDefaults");b.rsrcUrl||d.initResourceUrl.apply(this);var c=null;b.rsrcUrl?a.ajax({type:"GET",dataType:"json",async:!1,data:{id:b.data.id},url:b.rsrcUrl,success:function(a){c=a.data},error:function(a,b,c){alert("#240 Reload-Resource-Error: a:"+a+"; b:"+b+"; c:"+c)}}):alert("#206 fbDispoRouteDefaults.reloadResourcesFromUrl Error missing rsrcUrl!");d.reloadResourcesByData.apply(this,[c])},reloadResourcesByData:function(b){var c=a(this);a("ul.resources li",c).remove();b&&("object"==
typeof b&&b.length)&&d.addResources.apply(this,[b]);d.refreshResourcesStat.apply(this)},refreshResourcesStat:function(){a(".resourcesStat",a(this)).html("");var b=[],c=[];a("ul.resources .fbDispoResource",a(this)).each(function(){var d=("string"===typeof a(this).attr("class")?a(this).attr("class"):"").match(/\bRsrcType-([^ ]*)/),d=d?d[1]:"Rsrc";d in b?++b[d]:b[d]=1;c[c.length]=a(this).text()});for(var d in b)a(".resourcesStat",a(this)).append(a("<span rel='"+d+"' style='margin-right:5px;'>"+d+" "+
b[d]+"</span> &nbsp;"))},addDroppedResource:function(b,c,f){var e=a(c).fbDispoResource("options"),e={_parent:a(this),_parentJqFunction:"fbDispoRouteDefaults",_parentFrom:e&&"_parent"in e?e._parent:null,data:f.helper.data("dragdata")};a(c).data("dragdata",e.data);c==f.draggable||c.is(".is-default-resource")?(c.fbDispoResource("options",e),c.fbDispoResource("_moved",b,f)):(c.fbDispoResource(e),c.fbDispoResource("_dropped",b,f));if(!this||!a(this).length)return!1;d.sortResources.apply(this);d.refreshResourcesStat.apply(this)},
addResources:function(a){for(var c in a)d.addResource.apply(this,[a[c]]);d._trigger.apply(this,[this,"loadResources"]);d.sortResources.apply(this);d.refreshResourcesStat.apply(this)},addResource:function(b){var c=a(this);b||(b={name:"??"});var d=a("<div />").text(b.name);if(!d||!d.length)return alert("Unbekannter Systemfehler. Ressource konnte nicht initialisiert werden!"),!1;a("ul.resources:first",c).append(a("<li/>").css({display:"inline",marginLeft:5}).append(d));d.addClass("is-default-resource");
a.fn.fbDispoResource.apply(d,[{data:b,_parent:a(this),_parentJqFunction:"fbDispoRouteDefaults"}]);d.data("dragdata",b);d.removeClass("Drag-Rsrc")},removeResourceById:function(){},getTimeline:function(){return a(this).closest("div.fbDispoTimelineDropzone")},getResources:function(){return a("ul.resources li .Drag-Rsrc",a(this))},getRoutes:function(){var b=a(this).data("fbDispoRouteDefaults");return b&&b._parent?a("div.fbDispoRoute",b._parent).add(this):a()},setTimeSlot:function(b){var c=a(this),d=c.data("fbDispoRouteDefaults"),
e=c.data("route");b&&b.from&&(d.data.ZeitVon=b.from);b&&b.to&&(d.data.ZeitBis=b.to);b=a(d._parent).fbDispoTimelineDropzone("getTimelineLineal");var g=a(b).data("fbDispoTimelineLineal").settings;e.start=a.timeToMinutes(d.data.ZeitVon);e.end=a.timeToMinutes(d.data.ZeitBis);e.duration=e.end-e.start;e.duration<g._stepWidthM&&(e.duration=g._stepWidthM);this.style.position="absolute";this.style.top=a(b).height();this.style.left=100*(e.start-g._startM)/g._totalM+"%";this.style.width=100*e.duration/g._totalM+
"%";this.style.height=c.parent().height()-a(b).height()-8},_moved:function(){d.reInitData.apply(this);d._trigger.apply(this,[this,"move"])},_resized:function(){var b=a(this),c=b.data("route"),b=b.data("fbDispoRouteDefaults");b.timeStart=c.start;b.timeEnd=c.end;b.timeDuration=c.duration;d._trigger.apply(this,[this,"resize"])},_dropped:function(){d.reInitData.apply(this);d._trigger.apply(this,[this,"drop"])},reInitData:function(){var b=a(this).data("fbDispoRouteDefaults");null===b.data&&(b.data={});
if(b._parent&&b._parentJqFunction){var c=b._parent,d=b._parentJqFunction;b.data.timeline_id=c[d].apply(c,["getData","id"]);b.date=c[d].apply(c,["option","date"]);b.data.DatumVon=c[d].apply(c,["option","date"]);b.data.DatumBis=c[d].apply(c,["option","date"]);c=a(b._parent).fbDispoTimelineDropzone("getTimelineLineal");c=a(c).data("fbDispoTimelineLineal").settings;b.data.ZeitVon=c.start;b.data.ZeitBis=c.end}},draggable:function(){a(this).draggable.call(arguments)},droppable:function(){a(this).droppable.call(arguments)},
resizable:function(){a(this).resizable.call(arguments)},getDraggableOptions:function(){return a(this).draggable.call(arguments)},getDroppableOptions:function(){return a(this).droppable.call(arguments)},getResizableOptions:function(){return a(this).resizable.call(arguments)},destroy:function(){d._trigger.apply(this,[this,"remove"]);a(this).removeData("fbDispoRouteDefaults");a(this).remove()},_mkDroppable:function(){if("string"!==typeof a(this).attr("class")||!a(this).attr("class").match(/\bDragRoute-Focus\b/))a("div.Drag-Route").removeClass("DragRoute-Focus"),
a(this).addClass("DragRoute-Focus"),a("div.Drag-Route:not(.DragRoute-Focus)").droppable("option","accept",".is-default-resource"),a("div.Drag-Route.DragRoute-Focus").droppable("option","accept",".Drag-Rsrc,.is-default-resource"),Fb.Dnd.droppable_route=a(this),d._trigger.apply(this,[this,"select"].concat(a.makeArray(arguments)))},_mkRouteDroppableOnClick:function(){a(this).bind("click",d._mkDroppable)},getDataKey:function(){return"fbDispoRouteDefaults"},getData:function(){if("object"!==typeof a(this).data("fbDispoRouteDefaults"))return null;
var b=a(this).data("fbDispoRouteDefaults");"data"in b||(b.data={});return arguments.length?"object"===typeof b.data&&arguments[0]in b.data?b.data[arguments[0]]:null:b.data},setData:function(){var b=a(this).data("fbDispoRouteDefaults");if(null===b.data||"undefined"==typeof b.data)b.data={};1==arguments.length?b.data=arguments[0]:2<=arguments.length&&(b.data[arguments[0]]=arguments[1])},clear:function(){a(".Drag-Route",this).remove()},load:function(b){a(this).data("fbDispoRouteDefaults").data=b.data;
d.clear.apply(this);b.options&&a.fn.fbDispoRouteDefaults.apply(this,["options",b.options]);if(b.resources)for(var c=0;c<b.resources.length;++c)d.addResource.apply(this,["load",b.resources[c]])},_trigger:function(b,c){var f=a(this).data("fbDispoRouteDefaults"),e=d._getEventTriggerName(c),g=d._getOwnEventHandlerName(c),j=a.makeArray(arguments).slice(1);d["_"+g]&&d["_"+g].apply(this,arguments);if(g&&(g in f&&"function"==typeof f[g])&&!1===f[g].apply(b,j.slice(1)))return!1;j[0]=e;return f._parent&&f._parentJqFunction&&
(j.unshift(b),j.unshift("_trigger"),!1===f._parent[f._parentJqFunction].apply(f._parent,j))?!1:!0},_getEventTriggerName:function(a){a in g&&(a=g[a]);return a},_getOwnEventHandlerName:function(a){a="on"+a.charAt(0).toUpperCase()+a.substr(1);return a in e?a:""},_onDropResource:function(b,c,d){b=a(this).data("fbDispoRouteDefaults");c=a(this);a(d).fbDispoResource({data:{route_id:b.data.id},_parent:c,_parentJqFunction:"fbDispoRouteDefaults"})},_onMoveResource:function(b,c,d,e,g){b=a(this).data("fbDispoRouteDefaults");
c=a(this);a(g).fbDispoResource({data:{route_id:b.data.id},_parent:c,_parentJqFunction:"fbDispoRouteDefaults"})}};a.fn.fbDispoRouteDefaults=function(b){var c=arguments,f=arguments.length;if("string"==typeof b&&this.length)switch(b){case "options":if(1==f)return a(this[0]).data("fbDispoRouteDefaults");break;case "option":if(2==f){var g=a(this[0]).data("fbDispoRouteDefaults");return"object"==typeof g&&"undefined"!=typeof g[c[1]]?g[c[1]]:null}break;default:if("function"==typeof d[b]&&"get"==b.substr(0,
3))return!a(this[0]).data("fbDispoRouteDefaults")?null:d[b].apply(this[0],1<f?a.makeArray(c).slice(1):[])}return this.each(function(){var g=!1,h={};a(this).data("fbDispoRouteDefaults")||(h=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.routeDefaults?a.extend({},e,Fb.DispoCalendarSettings.routeDefaults):e,b?"object"==typeof b?a(this).data("fbDispoRouteDefaults",a.extend({},h,b)):a(this).data("fbDispoRouteDefaults",a.extend({},h)):a(this).data("fbDispoRouteDefaults",a.extend({},h)),g=!0);h=a(this).data("fbDispoRouteDefaults");
if("string"==typeof b)switch(b){case "options":1<f&&(h=a.extend({},h,c[1]),a(this).data("fbDispoRouteDefaults",h));break;case "option":2<f&&(h[c[1]]=c[2],a(this).data("fbDispoRouteDefaults",h));break;default:"function"==typeof d[b]&&d[b].apply(this,1<f?a.makeArray(c).slice(1):null)}g&&d._init.apply(this)})}})(jQuery);(function(a){a.fn.fbDispoRouteDroppableOnClick=function(){var g=function(){a("div.Drag-Route").removeClass("DragRoute-Focus");a(this).addClass("DragRoute-Focus");a("div.Drag-Route:not(.DragRoute-Focus)").droppable("option","accept","none");a("div.Drag-Route.DragRoute-Focus").droppable("option","accept",".Drag-Rsrc");Fb.Dnd.droppable_route=a(this)};return this.each(function(){a(this).data("fbDispoMkRouteDroppableOnClick")||a(this).data("fbDispoMkRouteDroppableOnClick",{init:!1});var e=a(this).data("fbDispoMkRouteDroppableOnClick");
e.init||(a(this).bind("click",g),e.init=!0)})}})(jQuery);(function(a){var g={create:"createTimeline",remove:"removeTimeline",drop:"dropRoute",move:"moveTimeline"},e={data:null,_parent:null,_parentJqFunction:null,isSortable:!0,isMovable:!0,isRemovable:!0,isDroppable:!0,onCreate:null,onRemove:null,onLoadRoute:null,onDrop:null,onMove:null,onSort:null},d={_init:function(){var b=a(this),c=b.data("fbDispoTimelineDropzone");b.addClass("DropZone DropZone-Route Drop-Timeline fbDispoTimelineDropzone").append(a('<div class="Timeline"/>')).find("div.Timeline").fbDispoTimelineLineal(b.data("fbDispoTimelineDropzone").data).end().fbDispoTimelineDropzoneHandles({sortable:c.isSortable,
movable:c.isMovable,removable:c.isRemovable}).bind("drop",function(){});c.isDroppable&&b.droppable(Fb.DropRouteSettings);if(!1===d._trigger.apply(this,[this,"create"]))return console.log("#94 fbDispoTimelineDropzone _init self.remove "),b.remove(),!1;a(this).data("fbDispoTimelineDropzone");a(this).data("fbDispoTimelineDropzone").data.touren&&(d.addRoutes.apply(this,[a(this).data("fbDispoTimelineDropzone").data.touren]),delete a(this).data("fbDispoTimelineDropzone").data.touren);a("div.fbDispoRouteDefaults",
this).show()},getTimelineLineal:function(){return a("div.Timeline:first",this)},getTimelineSettings:function(){return d.getTimelineLineal.apply(this).fbDispoTimelineLineal("getSettings")},getRoutes:function(){return a("div.fbDispoRoute,div.fbDispoRouteDefaults",this)},addRoutes:function(a){for(var c in a)d.addRoute.apply(this,[a[c]])},addRoute:function(b){b||(b={});var c=a("<div />");c.append(a("<span/>").addClass("title").text(b.name));a(this).append(c);var f={data:b,_parent:a(this),_parentJqFunction:"fbDispoTimelineDropzone"};
!("IsDefault"in b)||1!=parseInt(b.IsDefault)?c.fbDispoRoute.apply(c,[f]):c.fbDispoRouteDefaults.apply(c,[f]);d._trigger.apply(this,[c,"loadRoute"])},_moved:function(){alert("#127 fbDispoTimelineDropzone._moved!");d._trigger.apply(this,[this,"move"])},_dropped:function(){d._trigger.apply(this,[this,"drop"])},destroy:function(){!1!==d._trigger.apply(this,[this,"remove"])&&a(this).remove()},getDataKey:function(){return"fbDispoTimelineDropzone"},getData:function(){var b=a(this).data("fbDispoTimelineDropzone");
return"object"!==typeof b||!("data"in b)||"object"!==typeof b.data?null:arguments.length?arguments[0]in b.data?b.data[arguments[0]]:null:b.data},setData:function(){1==arguments.length?a(this).data("fbDispoTimelineDropzone").data=arguments[0]:2<=arguments.length&&(a(this).data("fbDispoTimelineDropzone").data[arguments[0]]=arguments[1])},clear:function(){a(".Drag-Route",this).remove()},load:function(b){var c=a(this).data("fbDispoTimelineDropzone");c.data=b.data;d.clear.apply(this);b.options&&a.fn.fbDispoTimelineDropzone.apply(this,
["options",b.options]);if(c.routes)for(c=0;c<b.routes.length;++c)d.addRoute.apply(this,["load",b.routes[c]])},_trigger:function(b,c){var f=a(this).data("fbDispoTimelineDropzone"),e=d._getEventTriggerName(c),g=d._getOwnEventHandlerName(c),j=a.makeArray(arguments).slice(1);if(g&&(g in f&&"function"==typeof f[g])&&!1===f[g].apply(b,j.slice(1)))return!1;j[0]=e;return b==this&&!1===a(this).trigger.apply(a(this),j)||f._parent&&f._parentJqFunction&&(j.unshift(b),j.unshift("_trigger"),!1===f._parent[f._parentJqFunction].apply(f._parent,
j))?!1:!0},_getEventTriggerName:function(a){a in g&&(a=g[a]);return a},_getOwnEventHandlerName:function(a){a="on"+a.charAt(0).toUpperCase()+a.substr(1);return a in e?a:""}};a.fn.fbDispoTimelineDropzone=function(b){var c=arguments,f=arguments.length;if("string"==typeof b&&this.length)switch(b){case "options":if(1==f)return a(this[0]).data("fbDispoTimelineDropzone");break;case "option":if(2==f){var g=a(this[0]).data("fbDispoTimelineDropzone");return"undefined"!=typeof g[c[1]]?g[c[1]]:null}break;default:if("function"==
typeof d[b]&&("_trigger"==b||"get"==b.substr(0,3)))return d[b].apply(this[0],a.makeArray(c).slice(1))}return this.each(function(){var g=!1,h={};a(this).data("fbDispoTimelineDropzone")||(h=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.timelineDropzone?a.extend({},e,Fb.DispoCalendarSettings.timelineDropzone):e,b?"object"==typeof b?a(this).data("fbDispoTimelineDropzone",a.extend({},h,b)):a(this).data("fbDispoTimelineDropzone",a.extend({},h)):a(this).data("fbDispoTimelineDropzone",a.extend({},h)),
g=!0);var h=a(this).data("fbDispoTimelineDropzone"),l=h.data;if(l.settings){for(var m in l.settings)h[m]=l.settings[m];delete l.settings}if("string"==typeof b)switch(b){case "options":1<f&&(h=a.extend({},h,c[1]),a(this).data("fbDispoTimelineDropzone",h));break;case "option":2<f&&(h[c[1]]=c[2],a(this).data("fbDispoTimelineDropzone",h));break;default:"function"==typeof d[b]&&d[b].apply(this,1<f?a.makeArray(c).slice(1):null)}g&&d._init.apply(this)})}})(jQuery);(function(a){var g={sortable:!0,movable:!0,removable:!0},e={_init:function(){var d=this,b=a(this).data("fbDispoTimelineDropzoneHandles");a("div.DropZone-DragHandle,div.DropZone-Remove,div.DropZone-Sort,div.DropZone-General",a(this)).remove();var c=a('<div class="Timeline-HandleBox ui-state-default ui-corner-left"style="position:absolute;top:-1px;width:15px;left:-17px;height:60px;" />').css("height",a(this).height()).bind("mouseover",function(){a(this).addClass("ui-state-hover");a("div",this).show()}).bind("mouseout",
function(){a(this).removeClass("ui-state-hover");a("div",this).hide()});b.removable&&c.append(a("<div class='DropZone-Remove ui-icon-trash ui-state-disabled' title='Loeschen' style='display:none;'><span style='width:13px;background-position: -178px -98px;'class='ui-icon ui-icon-trash'></span></div>").css({position:"absolute",top:"19px",left:1,width:"13px",height:"15px",border:0}).click(function(){d.fbDispoTimelineDropzone("destroy")}).hover(function(){a(this).toggleClass("ui-state-default ui-corner-all").toggleClass("ui-state-disabled")}));
b.sortable&&c.append(a("<div class='DropZone-Sort ui-state-disabled' title='Sortieren' style='display:none;'><span style='width:13px;background-position: -130px -1;' class='ui-icon ui-icon-carat-2-n-s'></span></div>").css({position:"absolute",top:"36px",left:1,width:"13px",height:"15px",border:0}).hover(function(){a(this).toggleClass("ui-state-default ui-corner-all").toggleClass("ui-state-disabled")}));c.append(a("<div class='DropZone-General Drag-Route ui-state-disabled' title='Standard-Ressourcen' style='display:none;'><span style='width:13px;background-position: -163px -130;' class='ui-icon ui-icon-clipboard'></span></div>").css({position:"absolute",
top:"51px",left:1,width:"13px",height:"15px",border:0}).click(function(){var b=a("div.DropZoneDefaults",d);b.length||(b=a("<div/>"),d.append(b),b.fbDispoRouteDefaults());a("div.DragRoute-Focus").removeClass("DragRoute-Focus");b.toggleClass("DropZone-Focus");b.toggle("string"===typeof b.attr("class")&&b.attr("class").match(/\bDropZone-Focus\b/));"string"===typeof b.attr("class")&&b.attr("class").match(/\bDropZone-Focus\b/)&&b.trigger("click")}).hover(function(){a(this).toggleClass("ui-state-default ui-corner-all").toggleClass("ui-state-disabled")}));
a(this).append(c);b.movable&&a(this).draggable(a.extend({},Fb.MoveTimelineSettings,{handle:"div.DropZone-DragHandle"}))}};a.fn.fbDispoTimelineDropzoneHandles=function(d){var b=arguments,c=arguments.length;if("string"==typeof d&&this.length)switch(d){case "options":if(1==c)return a(this[0]).data("fbDispoTimelineDropzoneHandles");break;case "option":if(2==c)return c=a(this[0]).data("fbDispoTimelineDropzoneHandles"),"undefined"!=typeof c[b[1]]?c[b[1]]:null;break;default:if("function"==typeof e[d]&&"get"==
d.substr(0,3))return e[d].apply(this[0],1<c?a.makeArray(b).slice(1):null)}return this.each(function(){var b=a(this),c=!1,k={},k=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.timelineDropzoneHandles?a.extend({},g,Fb.DispoCalendarSettings.timelineDropzoneHandles):g;a(b).data("fbDispoTimelineDropzoneHandles")||(d?"object"==typeof d?a(this).data("fbDispoTimelineDropzoneHandles",a.extend({},k,d)):a(this).data("fbDispoTimelineDropzoneHandles",a.extend({},k)):a(this).data("fbDispoTimelineDropzoneHandles",
a.extend({},k)),c=!0);c&&e._init.apply(b)})}})(jQuery);(function(a){var g={timeline:null},e={timeline:"",gridClass:"",width:"1px",color:"#d2d2d2",style:"dashed",show:!0,top:0,zIndex:5E3,refreshIfExists:!1};a.fn.fbDispoTimelineGrid=function(d){if("string"==typeof d)switch(d){case "destroy":return this.each(function(){a(".tl-grid-step",a(this)).remove();a(this).removeData("fbDispoTimelineGrid")});case "hide":return this.each(function(){a(".tl-grid-step",a(this)).css("borderLeftWidth",0).hide()});case "show":return this.each(function(){a(".tl-grid-step",
a(this)).css("borderLeftWidth","1px").show()});case "toggle":return this.each(function(){a(".tl-grid-step",a(this)).toggle()});case "getGridRulers":if(!this.length)return[];var b=this[0].data("fbDispoTimelineGrid");return b&&b.gridRulers?b.gridRulers:[];case "refresh":this.each(function(){var b=a(this).data("fbDispoTimelineGrid");b&&"gridRulers"in b&&(b.gridRulers=null)})}return this.each(function(){var b=a(this);b.addClass("fbDispoTimelineGrid");a(this).data("fbDispoTimelineGrid")||a(this).data("fbDispoTimelineGrid",
{});var f=a(this).data("fbDispoTimelineGrid"),h={},h=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.timelineGrid?a.extend({},e,Fb.DispoCalendarSettings.timelineGrid):e;f.settings||(f.settings=a.extend({},h));f.settings=a.extend({},f.settings,d);f.gridRulers||(f.gridRulers=null);if(!f.gridRulers||!f.gridRulers.length||f.refreshIfExists){var k=f.settings;f.refreshIfExists!=e.refreshIfExists&&(f.refreshIfExists=e.refreshIfExists);for(var j in g)if(!k[j]||!a(k[j],b).length){k[j]?alert("Invalid option for Timeline: Can not Found Element: $("+
k[j]+", $self); self.class:"+b.attr("class")):alert("Missing option for Timeline: "+j);return}var l=b.height(),h=a(k.timeline,b),h=a(".tl-step",h);b.find("div.tl-grid-step").remove();h.each(function(){b.append(a("<div/>").css({position:"absolute",height:l,top:k.top,left:a(this)[0].style.left,width:0,borderLeft:(k.show?"1px":"0px")+" "+k.style+" "+k.color,zIndex:k.zIndex,overflow:"hidden"}).addClass("tl-grid-step "+k.gridClass).data("gridStep",{time:a(this).data("timeStep").time}))});f.gridRulers=
a("div.tl-grid-step",b)}})}})(jQuery);(function(a){a.extend({timeToMinutes:function(a){a=(a+":0:0").split(":").slice(0,2);for(var e=0;e<a.length;e++){for(;"0"==a[e].substring(0,1);)a[e]=a[e].substring(1);a[e]=parseInt(a[e])||0}return 60*a[0]+a[1]},minutesToTime:function(a){var e=Math.floor(a/60);a%=60;23<e&&(e-=24);return(10>e?"0":"")+e+":"+(10>a?"0":"")+a}})})(jQuery);
(function(a){var g={start:"06:00",end:"20:00",stepWidth:"00:30",width:"100%",minWidth:"",addClass:"",stepClass:"",stepClassAlt:"",_total:"",_startM:0,_endM:0,_totalM:0,_stepWidthM:0,_stepWidthPct:0,onCreate:null,onRemove:null},e={timeToMinutes:function(a){a=(a+":0:0").split(":").slice(0,2);for(var b=0;b<a.length;b++){for(;"0"==a[b].substring(0,1);)a[b]=a[b].substring(1);a[b]=parseInt(a[b])||0}return 60*a[0]+a[1]},minutesToTime:function(a){var b=Math.floor(a/60);a%=60;23<b&&(b-=24);return(10>b?"0":
"")+b+":"+(10>a?"0":"")+a},getDataKey:function(){return"fbDispoTimelineLineal"},getSettings:function(){return a.extend({},a(this).data("fbDispoTimelineLineal").settings)}};a.fn.fbDispoTimelineLineal=function(d){var b=arguments;if("string"==typeof d&&this.length)switch(d){case "destroy":return this.each(function(){this.html("")});case "data":return this.first().data("fbDispoTimelineLineal");default:if("function"==typeof e[d]&&"get"==d.substr(0,3))return e[d].apply(this[0],a.makeArray(b).slice(1))}return this.each(function(){if("DIV"!==
a(this).get(0).tagName.toUpperCase())throw"Als Container f\ufffdr Timeline sind nur Div-Tags erlaubt. \ufffdbergeben wurde "+a(this).get(0).tagName;var b={},b=Fb.DispoCalendarSettings&&Fb.DispoCalendarSettings.timelineLineal?a.extend({},g,Fb.DispoCalendarSettings.timelineLineal):g;a(this).data("fbDispoTimelineLineal")||(a(this).data("fbDispoTimelineLineal",{settings:a.extend({},b)}),a(this).addClass("fbDispoTimelineLineal"));b=a(this).data("fbDispoTimelineLineal");b.settings=a.extend({},b.settings,
d);b.steps=[];var f=b.settings,h=e.timeToMinutes(f.stepWidth),k=e.timeToMinutes(f.start),j=e.timeToMinutes(f.end);j<k&&(j+=1440);if(h){do b.steps.push(k),k+=h;while(k<j);f._startM=e.timeToMinutes(f.start);f._endM=j;f._totalM=f._endM-f._startM;f._total=e.minutesToTime(f._totalM);f._stepWidthM=e.timeToMinutes(f.stepWidth);f._stepWidthPct=100*f._stepWidthM/f._totalM;b.container=a("<table>").css({width:f.width,"min-width":f.minWidth}).append(a("<tr>"));f.addClass&&b.container.addClass(f.addClass);a(this).html("").append(b.container);
b.containerTr=a("tr:first",b.container);b.container=a("<div>").css({position:"relative",padding:0,border:0,overflow:"visible",height:"auto",width:f.width,"min-width":f.minWidth});f.addClass&&b.container.addClass(f.addClass);a(this).html("").append(b.container);b.containerTr=b.container;h=100*(Math.round(10*(b.container.width()/b.steps.length))/10)/b.container.width();k="";for(j=0;j<b.steps.length;++j)k=j*h+"%",b.containerTr.append(a("<div>").addClass("tl-step tl-step-"+(j%2?"odd":"even")).data("timeStep",
{time:b.steps[j],left:k}).css({position:"absolute",left:k,width:h+"%",overflow:"hidden",display:"block",margin:0,padding:0,border:0}).text(e.minutesToTime(b.steps[j])));b.steps.length&&b.containerTr.css({height:a("div.tl-step:first",b.containerTr).height()});f.stepClass&&a(f.stepClassAlt?"div:even":"div",b.containerTr).addClass(f.stepClass);f.stepClassAlt&&a("div:odd",b.containerTr).addClass(f.stepClassAlt)}else alert("Es wurde kein g\ufffdltiges Interval (stepWidth) f\ufffdr die Zeitleiste definiert!"),
alert("#128 fbDispoTimelineLineal this.each endTime:"+j+"; currentTime:"+k+" s.stepWidth:"+f.stepWidth+"; timeSlotWidth:"+h)})}})(jQuery);
